<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="小室竜也">

<title>11&nbsp; 9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法 – Rによる統計解析実戦ガイド</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./10_一般化可能性理論.html" rel="next">
<link href="./8_ROC曲線_ツリーモデル.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5f5948b16bc3df4d260423ec79d744c2.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "一致なし",
    "search-matching-documents-text": "一致した文書",
    "search-copy-link-title": "検索へのリンクをコピー",
    "search-hide-matches-text": "追加の検索結果を非表示",
    "search-more-match-text": "追加の検索結果",
    "search-more-matches-text": "追加の検索結果",
    "search-clear-button-title": "消去",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "取消",
    "search-submit-button-title": "検索",
    "search-label": "サーチ"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="サイドバーを切り替える" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法.html">第IV部：多変量解析</a></li><li class="breadcrumb-item"><a href="./9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="サイドバーを切り替える" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="サーチ" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Rによる統計解析実戦ガイド</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="リーダーモードの切り替え">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="サーチ"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">はじめに</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Rの基本的な使い方.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Rの基本的な使い方</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">第I部：統計モデルの基礎</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="セクションを切り替え">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./統計モデルについての概略.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">統計モデルについての概略</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_T検定と効果量.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">T検定と効果量</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_ANOVAとカテゴリカル変数のコーディング.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">ANOVA・カテゴリカル変数のコーディング</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_MANOVA_判別分析.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">MANOVA・判別分析</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">第II部：回帰分析</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="セクションを切り替え">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_重回帰分析_simple_slope_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">重回帰分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_一般化線形モデル_一般化加法モデル.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">一般化線形モデル・一般化加法モデル</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_混合効果モデル_2値ロジスティック回帰.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">混合効果モデル：2値ロジスティック回帰分析</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">第III部：ベイズ統計と機械学習</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="セクションを切り替え">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7_ベイズ推定.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">ベイズ推定</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8_ROC曲線_ツリーモデル.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">ROC曲線・ツリーモデル</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">第IV部：多変量解析</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="セクションを切り替え">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_一般化可能性理論.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">一般化可能性理論</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_項目応答理論とラッシュモデル.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">項目応答理論とラッシュモデル</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_拡張ラッシュモデル.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">T検定と効果量</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./参考文献_おすすめの書籍.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">参考文献・おすすめの書籍</span></span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#はじめに" id="toc-はじめに" class="nav-link active" data-scroll-target="#はじめに"><span class="header-section-number">12</span> はじめに</a></li>
  <li><a href="#探索的因子分析efa" id="toc-探索的因子分析efa" class="nav-link" data-scroll-target="#探索的因子分析efa"><span class="header-section-number">13</span> 探索的因子分析（EFA）</a>
  <ul class="collapse">
  <li><a href="#コンセプトと手順" id="toc-コンセプトと手順" class="nav-link" data-scroll-target="#コンセプトと手順"><span class="header-section-number">13.1</span> コンセプトと手順</a>
  <ul class="collapse">
  <li><a href="#データ例シミュレーション" id="toc-データ例シミュレーション" class="nav-link" data-scroll-target="#データ例シミュレーション"><span class="header-section-number">13.1.1</span> データ例（シミュレーション）</a></li>
  <li><a href="#因子数の決定ガットマン基準スクリープロット平行分析" id="toc-因子数の決定ガットマン基準スクリープロット平行分析" class="nav-link" data-scroll-target="#因子数の決定ガットマン基準スクリープロット平行分析"><span class="header-section-number">13.1.2</span> 因子数の決定（ガットマン基準・スクリープロット・平行分析）</a></li>
  <li><a href="#因子負荷の推定と回転" id="toc-因子負荷の推定と回転" class="nav-link" data-scroll-target="#因子負荷の推定と回転"><span class="header-section-number">13.1.3</span> 因子負荷の推定と回転</a></li>
  <li><a href="#信頼性α係数ω係数" id="toc-信頼性α係数ω係数" class="nav-link" data-scroll-target="#信頼性α係数ω係数"><span class="header-section-number">13.1.4</span> 信頼性（α係数・ω係数）</a></li>
  <li><a href="#可視化" id="toc-可視化" class="nav-link" data-scroll-target="#可視化"><span class="header-section-number">13.1.5</span> 可視化</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#確認的因子分析cfa" id="toc-確認的因子分析cfa" class="nav-link" data-scroll-target="#確認的因子分析cfa"><span class="header-section-number">14</span> 確認的因子分析（CFA）</a>
  <ul class="collapse">
  <li><a href="#lavaan-の記法とデータ" id="toc-lavaan-の記法とデータ" class="nav-link" data-scroll-target="#lavaan-の記法とデータ"><span class="header-section-number">14.1</span> lavaan の記法とデータ</a></li>
  <li><a href="#モデル定義と推定" id="toc-モデル定義と推定" class="nav-link" data-scroll-target="#モデル定義と推定"><span class="header-section-number">14.2</span> モデル定義と推定</a>
  <ul class="collapse">
  <li><a href="#可視化と含意共分散" id="toc-可視化と含意共分散" class="nav-link" data-scroll-target="#可視化と含意共分散"><span class="header-section-number">14.2.1</span> 可視化と含意共分散</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#主成分分析pca" id="toc-主成分分析pca" class="nav-link" data-scroll-target="#主成分分析pca"><span class="header-section-number">15</span> 主成分分析（PCA）</a></li>
  <li><a href="#コレスポンデンス分析camca" id="toc-コレスポンデンス分析camca" class="nav-link" data-scroll-target="#コレスポンデンス分析camca"><span class="header-section-number">16</span> コレスポンデンス分析（CA/MCA）</a>
  <ul class="collapse">
  <li><a href="#ca対応分析の例" id="toc-ca対応分析の例" class="nav-link" data-scroll-target="#ca対応分析の例"><span class="header-section-number">16.1</span> CA（対応分析）の例</a></li>
  <li><a href="#mca多重対応分析の例" id="toc-mca多重対応分析の例" class="nav-link" data-scroll-target="#mca多重対応分析の例"><span class="header-section-number">16.2</span> MCA（多重対応分析）の例</a></li>
  <li><a href="#tidyverseスタイルでの可視化" id="toc-tidyverseスタイルでの可視化" class="nav-link" data-scroll-target="#tidyverseスタイルでの可視化"><span class="header-section-number">16.3</span> tidyverseスタイルでの可視化</a></li>
  </ul></li>
  <li><a href="#多次元尺度法mds" id="toc-多次元尺度法mds" class="nav-link" data-scroll-target="#多次元尺度法mds"><span class="header-section-number">17</span> 多次元尺度法（MDS）</a></li>
  <li><a href="#参考" id="toc-参考" class="nav-link" data-scroll-target="#参考"><span class="header-section-number">18</span> 参考</a></li>
  <li><a href="#セッション情報" id="toc-セッション情報" class="nav-link" data-scroll-target="#セッション情報"><span class="header-section-number">19</span> セッション情報</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法.html">第IV部：多変量解析</a></li><li class="breadcrumb-item"><a href="./9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> コード</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">すべてのコードを表示</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">すべてのコードを非表示</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">ソースコードを表示</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">作者</div>
    <div class="quarto-title-meta-contents">
             <p>小室竜也 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">公開</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2025年8月17日</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<style>
/* journalテーマ用のアカデミックなカスタムスタイル */
body {
  font-family: 'Noto Serif JP', 'Times New Roman', serif;
  color: #2c3e50;
  line-height: 1.8;
}

/* タイトルブロックをジャーナル風に */
.quarto-title-banner {
  background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);
  border-bottom: 4px double #495057;
  padding: 2.5em 2em;
  text-align: center;
}

.quarto-title-banner .title {
  color: #212529 !important;
  font-size: 2.2em !important;
  font-weight: 700;
  letter-spacing: 0.02em;
  text-transform: uppercase;
  font-family: 'Noto Sans JP', sans-serif;
}

/* 見出しのアカデミックスタイル */
h1 {
  font-size: 1.8em;
  font-weight: 700;
  color: #1a1a1a;
  border-bottom: 2px solid #212529;
  padding-bottom: 0.5em;
  margin-top: 2em;
  margin-bottom: 1em;
  text-transform: uppercase;
  letter-spacing: 0.03em;
}

h2 {
  font-size: 1.4em;
  font-weight: 600;
  color: #343a40;
  margin-top: 1.5em;
  margin-bottom: 0.8em;
}

h2:before {
  content: "§";
  margin-right: 0.5em;
  color: #6c757d;
  font-weight: 400;
}

h3 {
  font-size: 1.2em;
  font-weight: 600;
  color: #495057;
  font-style: italic;
  margin-top: 1.2em;
  margin-bottom: 0.6em;
}

/* テーブルを学術論文風に */
table {
  margin: 2em auto;
  border-collapse: collapse;
  font-size: 0.95em;
  width: 90%;
  border-top: 2px solid #212529;
  border-bottom: 2px solid #212529;
}

thead {
  background: #f8f9fa;
  border-bottom: 1px solid #212529;
}

/* コードブロックをシンプルに */
pre {
  background: #f8f9fa !important;
  border: 1px solid #dee2e6;
  border-radius: 0;
  padding: 1em;
  font-size: 0.9em;
}

/* 数式を強調 */
.math {
  color: #212529;
  font-size: 1.05em;
  font-style: italic;
}
</style>
<section id="はじめに" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> はじめに</h1>
<p>本ドキュメントは、<strong>探索的因子分析 (EFA)</strong>、<strong>確認的因子分析 (CFA)</strong>、<strong>主成分分析 (PCA)</strong>、<strong>コレスポンデンス分析 (CA/MCA)</strong>、および<strong>多次元尺度法 (MDS)</strong> を、R による実行例とともに体系的にまとめた実践ガイドです。教育・心理領域のアンケートデータやテストデータを対象に、モデルの考え方、実装、そして解釈の要点を一貫した流れで示します。</p>
<p>依存パッケージは適宜 <code>install.packages()</code> で導入してください。</p>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  tidyverse,        <span class="co"># Data manipulation and visualization</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  psych,            <span class="co"># EFA and reliability analysis</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  GPArotation,      <span class="co"># Factor rotations</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  sjPlot,           <span class="co"># EFA table formatting</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  lavaan,           <span class="co"># CFA/SEM</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  semPlot,          <span class="co"># Path diagrams</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  lavaanPlot,       <span class="co"># Alternative path diagrams</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  FactoMineR,       <span class="co"># PCA, CA, MCA</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  factoextra,       <span class="co"># Visualization support</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  smacof,           <span class="co"># Non-metric MDS</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  gt,               <span class="co"># Table formatting</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  scales,           <span class="co"># Axis labeling</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  broom             <span class="co"># Model output tidying</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="探索的因子分析efa" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> 探索的因子分析（EFA）</h1>
<section id="コンセプトと手順" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="コンセプトと手順"><span class="header-section-number">13.1</span> コンセプトと手順</h2>
<ul>
<li><strong>独自性</strong> = 特殊分散 + 誤差分散、<strong>共通性</strong> = 1 − 独自性（= 因子負荷の二乗和）</li>
<li>目的は、相関行列を<strong>因子</strong>に分解し、<strong>共通分散</strong>の説明を最大化すること</li>
<li>一般的な手順: <strong>(1) 因子数の決定</strong> → <strong>(2) 因子負荷の推定</strong> → <strong>(3) 回転</strong> → <strong>(4) 解釈</strong></li>
</ul>
<p>EFAは観測変数間の相関を「共通因子 + 独自性」に分解するモデルです。推定の目的は、相関行列のうち<strong>共通分散</strong>をできるだけ少ない因子で説明することにあります。因子数は「過少（情報の取りこぼし）」と「過多（過適合）」のトレードオフで、スクリープロット・平行分析・情報量基準（BICなど）を<strong>総合判断</strong>するのが実務的です。回転は<strong>解釈可能性の向上</strong>が目的で、斜交回転（因子間相関を許容）をデフォルトとし、理論的に独立と考える場合のみ直交回転を検討します。</p>
<section id="データ例シミュレーション" class="level3" data-number="13.1.1">
<h3 data-number="13.1.1" class="anchored" data-anchor-id="データ例シミュレーション"><span class="header-section-number">13.1.1</span> データ例（シミュレーション）</h3>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameters for data generation</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n_respondents <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>n_items <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>n_factors <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random factor loadings and scores</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n_items <span class="sc">*</span> n_factors), <span class="at">nrow =</span> n_items, <span class="at">ncol =</span> n_factors)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>factor_scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n_respondents <span class="sc">*</span> n_factors), <span class="at">nrow =</span> n_respondents, <span class="at">ncol =</span> n_factors)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to Likert scale (1-6)</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>raw <span class="ot">&lt;-</span> factor_scores <span class="sc">%*%</span> <span class="fu">t</span>(loadings)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>rng01 <span class="ot">&lt;-</span> <span class="fu">apply</span>(raw, <span class="dv">1</span>, <span class="cf">function</span>(x) (x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)))</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>data_scaled <span class="ot">&lt;-</span> <span class="fu">t</span>(rng01) <span class="sc">*</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>round_likert <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">pmin</span>(<span class="fu">pmax</span>(<span class="fu">round</span>(x), <span class="dv">1</span>), <span class="dv">6</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>survey <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">apply</span>(data_scaled, <span class="dv">2</span>, round_likert))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(survey) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"V"</span>, <span class="fu">seq_len</span>(<span class="fu">ncol</span>(survey)))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="因子数の決定ガットマン基準スクリープロット平行分析" class="level3" data-number="13.1.2">
<h3 data-number="13.1.2" class="anchored" data-anchor-id="因子数の決定ガットマン基準スクリープロット平行分析"><span class="header-section-number">13.1.2</span> 因子数の決定（ガットマン基準・スクリープロット・平行分析）</h3>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate eigenvalues (Guttman criterion: λ &gt; 1)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cor</span>(survey))<span class="sc">$</span>values</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display eigenvalues in gt table</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(eig),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Eigenvalue =</span> eig,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Proportion =</span> eig <span class="sc">/</span> <span class="fu">sum</span>(eig),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cumulative =</span> <span class="fu">cumsum</span>(eig <span class="sc">/</span> <span class="fu">sum</span>(eig))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span>  <span class="co"># Show first 10 components</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Eigenvalues from Correlation Matrix"</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Components with eigenvalue &gt; 1 should be retained (Kaiser criterion)"</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Eigenvalue, Proportion, Cumulative),</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Component =</span> <span class="st">"Component"</span>,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Eigenvalue =</span> <span class="st">"Eigenvalue"</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Proportion =</span> <span class="st">"Proportion"</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cumulative =</span> <span class="st">"Cumulative"</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6ffe6"</span>),</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Eigenvalue,</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Eigenvalue <span class="sc">&gt;</span> <span class="dv">1</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Components with eigenvalue &gt; 1 are highlighted"</span>,</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> Eigenvalue)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="sdlkxkjsgu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#sdlkxkjsgu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sdlkxkjsgu thead, #sdlkxkjsgu tbody, #sdlkxkjsgu tfoot, #sdlkxkjsgu tr, #sdlkxkjsgu td, #sdlkxkjsgu th {
  border-style: none;
}

#sdlkxkjsgu p {
  margin: 0;
  padding: 0;
}

#sdlkxkjsgu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sdlkxkjsgu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sdlkxkjsgu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sdlkxkjsgu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sdlkxkjsgu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sdlkxkjsgu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sdlkxkjsgu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sdlkxkjsgu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sdlkxkjsgu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sdlkxkjsgu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sdlkxkjsgu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sdlkxkjsgu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sdlkxkjsgu .gt_spanner_row {
  border-bottom-style: hidden;
}

#sdlkxkjsgu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sdlkxkjsgu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sdlkxkjsgu .gt_from_md > :first-child {
  margin-top: 0;
}

#sdlkxkjsgu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sdlkxkjsgu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sdlkxkjsgu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sdlkxkjsgu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sdlkxkjsgu .gt_row_group_first td {
  border-top-width: 2px;
}

#sdlkxkjsgu .gt_row_group_first th {
  border-top-width: 2px;
}

#sdlkxkjsgu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sdlkxkjsgu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sdlkxkjsgu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sdlkxkjsgu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sdlkxkjsgu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sdlkxkjsgu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sdlkxkjsgu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sdlkxkjsgu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sdlkxkjsgu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sdlkxkjsgu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sdlkxkjsgu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sdlkxkjsgu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sdlkxkjsgu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sdlkxkjsgu .gt_left {
  text-align: left;
}

#sdlkxkjsgu .gt_center {
  text-align: center;
}

#sdlkxkjsgu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sdlkxkjsgu .gt_font_normal {
  font-weight: normal;
}

#sdlkxkjsgu .gt_font_bold {
  font-weight: bold;
}

#sdlkxkjsgu .gt_font_italic {
  font-style: italic;
}

#sdlkxkjsgu .gt_super {
  font-size: 65%;
}

#sdlkxkjsgu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sdlkxkjsgu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sdlkxkjsgu .gt_indent_1 {
  text-indent: 5px;
}

#sdlkxkjsgu .gt_indent_2 {
  text-indent: 10px;
}

#sdlkxkjsgu .gt_indent_3 {
  text-indent: 15px;
}

#sdlkxkjsgu .gt_indent_4 {
  text-indent: 20px;
}

#sdlkxkjsgu .gt_indent_5 {
  text-indent: 25px;
}

#sdlkxkjsgu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#sdlkxkjsgu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal">Eigenvalues from Correlation Matrix</th>
</tr>
<tr class="gt_heading even">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Components with eigenvalue &gt; 1 should be retained (Kaiser criterion)</th>
</tr>
<tr class="gt_col_headings header">
<th id="Component" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Component</th>
<th id="Eigenvalue" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Eigenvalue<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="Proportion" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Proportion</th>
<th id="Cumulative" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Cumulative</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Component">1</td>
<td class="gt_row gt_right" headers="Eigenvalue" style="background-color: #E6FFE6; font-weight: bold">5.074</td>
<td class="gt_row gt_right" headers="Proportion">0.338</td>
<td class="gt_row gt_right" headers="Cumulative">0.338</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Component">2</td>
<td class="gt_row gt_right" headers="Eigenvalue" style="background-color: #E6FFE6; font-weight: bold">4.397</td>
<td class="gt_row gt_right" headers="Proportion">0.293</td>
<td class="gt_row gt_right" headers="Cumulative">0.631</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Component">3</td>
<td class="gt_row gt_right" headers="Eigenvalue" style="background-color: #E6FFE6; font-weight: bold">3.363</td>
<td class="gt_row gt_right" headers="Proportion">0.224</td>
<td class="gt_row gt_right" headers="Cumulative">0.856</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Component">4</td>
<td class="gt_row gt_right" headers="Eigenvalue" style="background-color: #E6FFE6; font-weight: bold">1.491</td>
<td class="gt_row gt_right" headers="Proportion">0.099</td>
<td class="gt_row gt_right" headers="Cumulative">0.955</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Component">5</td>
<td class="gt_row gt_right" headers="Eigenvalue">0.209</td>
<td class="gt_row gt_right" headers="Proportion">0.014</td>
<td class="gt_row gt_right" headers="Cumulative">0.969</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Component">6</td>
<td class="gt_row gt_right" headers="Eigenvalue">0.123</td>
<td class="gt_row gt_right" headers="Proportion">0.008</td>
<td class="gt_row gt_right" headers="Cumulative">0.977</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Component">7</td>
<td class="gt_row gt_right" headers="Eigenvalue">0.078</td>
<td class="gt_row gt_right" headers="Proportion">0.005</td>
<td class="gt_row gt_right" headers="Cumulative">0.982</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Component">8</td>
<td class="gt_row gt_right" headers="Eigenvalue">0.061</td>
<td class="gt_row gt_right" headers="Proportion">0.004</td>
<td class="gt_row gt_right" headers="Cumulative">0.986</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Component">9</td>
<td class="gt_row gt_right" headers="Eigenvalue">0.054</td>
<td class="gt_row gt_right" headers="Proportion">0.004</td>
<td class="gt_row gt_right" headers="Cumulative">0.990</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Component">10</td>
<td class="gt_row gt_right" headers="Eigenvalue">0.040</td>
<td class="gt_row gt_right" headers="Proportion">0.003</td>
<td class="gt_row gt_right" headers="Cumulative">0.993</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Components with eigenvalue &gt; 1 are highlighted</td>
</tr>
</tfoot>

</table>

</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scree plot and parallel analysis</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">VSS.scree</span>(survey)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/determine-factors-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">fa.parallel</span>(survey, <span class="at">fm =</span> <span class="st">"ml"</span>, <span class="at">fa =</span> <span class="st">"pc"</span>, <span class="at">n.iter =</span> <span class="dv">100</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/determine-factors-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  NA  and the number of components =  4 </code></pre>
</div>
</div>
<section id="tidyverseで作るスクリープロット自作" class="level4">
<h4 class="anchored" data-anchor-id="tidyverseで作るスクリープロット自作">tidyverseで作るスクリープロット（自作）</h4>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scree plot data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>eig_vals <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cor</span>(survey))<span class="sc">$</span>values</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>scree_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Component =</span> <span class="fu">seq_along</span>(eig_vals), <span class="at">Eigenvalue =</span> eig_vals)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize with ggplot2</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(scree_tbl, <span class="fu">aes</span>(Component, Eigenvalue)) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scree_tbl<span class="sc">$</span>Component) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Scree Plot (tidyverse)"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Components with eigenvalue &gt; 1 (above red line) are candidates for retention"</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Eigenvalue"</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/scree-plot-tidyverse-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="因子負荷の推定と回転" class="level3" data-number="13.1.3">
<h3 data-number="13.1.3" class="anchored" data-anchor-id="因子負荷の推定と回転"><span class="header-section-number">13.1.3</span> 因子負荷の推定と回転</h3>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit EFA model with promax rotation</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fit_efa <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(survey, <span class="at">nfactors =</span> <span class="dv">4</span>, <span class="at">fm =</span> <span class="st">"ml"</span>, <span class="at">rotate =</span> <span class="st">"promax"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display summary</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_efa)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  ml
Call: psych::fa(r = survey, nfactors = 4, rotate = "promax", fm = "ml")
Standardized loadings (pattern matrix) based upon correlation matrix
      ML1   ML2   ML3   ML4   h2     u2 com
V1  -0.32 -0.04  0.95  0.09 0.98 0.0196 1.2
V2   0.07  0.99  0.39  0.00 0.98 0.0153 1.3
V3  -0.40  0.82 -0.02  0.36 0.97 0.0291 1.9
V4   0.29  0.95  0.32 -0.09 0.97 0.0262 1.4
V5   0.93 -0.30 -0.10 -0.02 0.99 0.0093 1.2
V6  -0.37 -0.70  0.42  0.43 0.98 0.0235 3.0
V7  -0.01  0.40  1.00  0.12 0.92 0.0827 1.3
V8   0.95  0.13 -0.18  0.02 0.96 0.0447 1.1
V9   0.55 -0.63  0.36  0.14 0.95 0.0499 2.7
V10  0.40 -0.51 -0.17  0.58 0.90 0.1026 3.0
V11  0.96  0.04 -0.17  0.01 0.97 0.0271 1.1
V12  0.15  0.01  0.17  0.87 0.69 0.3072 1.1
V13  0.89  0.30  0.15  0.23 0.86 0.1446 1.4
V14  0.28  0.60 -0.38  0.42 0.92 0.0796 3.1
V15 -0.35 -0.07 -0.54  0.59 0.99 0.0114 2.7

                       ML1  ML2  ML3  ML4
SS loadings           4.66 4.33 2.98 2.05
Proportion Var        0.31 0.29 0.20 0.14
Cumulative Var        0.31 0.60 0.80 0.94
Proportion Explained  0.33 0.31 0.21 0.15
Cumulative Proportion 0.33 0.64 0.85 1.00

 With factor correlations of 
      ML1   ML2   ML3   ML4
ML1  1.00 -0.06 -0.04  0.00
ML2 -0.06  1.00 -0.20 -0.07
ML3 -0.04 -0.20  1.00 -0.39
ML4  0.00 -0.07 -0.39  1.00

Mean item complexity =  1.8
Test of the hypothesis that 4 factors are sufficient.

df null model =  105  with the objective function =  29.81 with Chi Square =  14701.74
df of  the model are 51  and the objective function was  0.19 

The root mean square of the residuals (RMSR) is  0 
The df corrected root mean square of the residuals is  0 

The harmonic n.obs is  500 with the empirical chi square  0.64  with prob &lt;  1 
The total n.obs was  500  with Likelihood Chi Square =  90.87  with prob &lt;  5e-04 

Tucker Lewis Index of factoring reliability =  0.994
RMSEA index =  0.039  and the 90 % confidence intervals are  0.026 0.053
BIC =  -226.07
Fit based upon off diagonal values = 1
Measures of factor score adequacy             
                                                   ML1  ML2  ML3  ML4
Correlation of (regression) scores with factors   1.00 1.00 1.00 0.99
Multiple R square of scores with factors          0.99 0.99 0.99 0.98
Minimum correlation of possible factor scores     0.99 0.99 0.98 0.96</code></pre>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create formatted table with factor loadings</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_fa</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  survey, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">rotation =</span> <span class="st">"promax"</span>, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"ml"</span>, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">nmbr.fctr =</span> <span class="dv">4</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">fctr.load.tlrn =</span> <span class="fl">0.1</span>, </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">sort =</span> <span class="cn">TRUE</span>, </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Exploratory Factor Analysis Results"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.cronb =</span> <span class="cn">TRUE</span>, </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.comm =</span> <span class="cn">TRUE</span>, </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">encoding =</span> <span class="st">"UTF-8"</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Exploratory Factor Analysis Results</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="border-top: double black; padding: 0.2cm">&nbsp;</td>
<td data-quarto-table-cell-role="th" style="border-top: double black; padding: 0.2cm">Factor 1</td>
<td data-quarto-table-cell-role="th" style="border-top: double black; padding: 0.2cm">Factor 2</td>
<td data-quarto-table-cell-role="th" style="border-top: double black; padding: 0.2cm">Factor 3</td>
<td data-quarto-table-cell-role="th" style="border-top: double black; padding: 0.2cm">Factor 4</td>
<td data-quarto-table-cell-role="th" style="border-top: double black; padding: 0.2cm; font-style: italic; color: #666666">Communality</td>
</tr>
<tr class="even">
<td style="border-top: 1px solid black">V11</td>
<td style="text-align: center; padding: 0.2cm; border-top: 1px solid black;">0.96</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc; border-top: 1px solid black;">0.04</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc; border-top: 1px solid black;">-0.17</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc; border-top: 1px solid black;">0.01</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; color: #666666; border-top: 1px solid black;">0.98</td>
</tr>
<tr class="odd">
<td>V8</td>
<td style="text-align: center; padding: 0.2cm;">0.95</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.13</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">-0.18</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.02</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; color: #666666;">0.98</td>
</tr>
<tr class="even">
<td>V5</td>
<td style="text-align: center; padding: 0.2cm;">0.93</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">-0.30</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">-0.10</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">-0.02</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; color: #666666;">0.97</td>
</tr>
<tr class="odd">
<td>V13</td>
<td style="text-align: center; padding: 0.2cm;">0.89</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.30</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.15</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.23</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; color: #666666;">0.97</td>
</tr>
<tr class="even">
<td>V2</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.07</td>
<td style="text-align: center; padding: 0.2cm;">0.99</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.39</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">-0.00</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; color: #666666;">0.99</td>
</tr>
<tr class="odd">
<td>V4</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.29</td>
<td style="text-align: center; padding: 0.2cm;">0.95</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.32</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">-0.09</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; color: #666666;">0.98</td>
</tr>
<tr class="even">
<td>V3</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">-0.40</td>
<td style="text-align: center; padding: 0.2cm;">0.82</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">-0.02</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.36</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; color: #666666;">0.92</td>
</tr>
<tr class="odd">
<td>V6</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">-0.37</td>
<td style="text-align: center; padding: 0.2cm;">-0.70</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.42</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.43</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; color: #666666;">0.96</td>
</tr>
<tr class="even">
<td style="background-color: #eacccc">V9</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc; background-color: #eacccc;">0.55</td>
<td style="text-align: center; padding: 0.2cm; background-color: #eacccc;">-0.63</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc; background-color: #eacccc;">0.36</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc; background-color: #eacccc;">0.14</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; color: #666666; background-color: #eacccc;">0.95</td>
</tr>
<tr class="odd">
<td>V14</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.28</td>
<td style="text-align: center; padding: 0.2cm;">0.60</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">-0.38</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.42</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; color: #666666;">0.90</td>
</tr>
<tr class="even">
<td>V7</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">-0.01</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.40</td>
<td style="text-align: center; padding: 0.2cm;">1.00</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.12</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; color: #666666;">0.97</td>
</tr>
<tr class="odd">
<td>V1</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">-0.32</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">-0.04</td>
<td style="text-align: center; padding: 0.2cm;">0.95</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.09</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; color: #666666;">0.69</td>
</tr>
<tr class="even">
<td>V12</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.15</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.01</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc;">0.17</td>
<td style="text-align: center; padding: 0.2cm;">0.87</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; color: #666666;">0.86</td>
</tr>
<tr class="odd">
<td style="background-color: #eacccc">V15</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc; background-color: #eacccc;">-0.35</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc; background-color: #eacccc;">-0.07</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc; background-color: #eacccc;">-0.54</td>
<td style="text-align: center; padding: 0.2cm; background-color: #eacccc;">0.59</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; color: #666666; background-color: #eacccc;">0.92</td>
</tr>
<tr class="even">
<td style="background-color: #eacccc">V10</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc; background-color: #eacccc;">0.40</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc; background-color: #eacccc;">-0.51</td>
<td style="text-align: center; padding: 0.2cm; color: #cccccc; background-color: #eacccc;">-0.17</td>
<td style="text-align: center; padding: 0.2cm; background-color: #eacccc;">0.58</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; color: #666666; background-color: #eacccc;">0.99</td>
</tr>
<tr class="odd">
<td style="padding: 0.2cm; font-style: italic">Total Communalities</td>
<td colspan="4" style="text-align: center; padding: 0.2cm; font-style: italic;"></td>
<td style="text-align: center; padding: 0.2cm; font-style: italic;">14.03</td>
</tr>
<tr class="even">
<td style="padding: 0.2cm; font-style: italic; border-bottom: double">Cronbach's α</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; border-bottom: double;">0.69</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; border-bottom: double;">0.62</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; border-bottom: double;">0.18</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; border-bottom: double;">0.43</td>
<td style="text-align: center; padding: 0.2cm; font-style: italic; border-bottom: double;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>因子負荷の要約表（gt）</strong></p>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and tidy factor loadings</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>load_tbl <span class="ot">&lt;-</span> fit_efa<span class="sc">$</span>loadings <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unclass</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Item"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary with max loading per item, communality, and uniqueness</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>efa_summary <span class="ot">&lt;-</span> load_tbl <span class="sc">|&gt;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Item, <span class="at">names_to =</span> <span class="st">"Factor"</span>, <span class="at">values_to =</span> <span class="st">"Loading"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Item) <span class="sc">|&gt;</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Abs =</span> <span class="fu">abs</span>(Loading),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Communality =</span> <span class="fu">sum</span>(Loading<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># Sum of squared loadings across all factors</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> Abs, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Uniqueness =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pmin</span>(Communality, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Item, Factor, Loading, Communality, Uniqueness) <span class="sc">|&gt;</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Factor, <span class="fu">desc</span>(<span class="fu">abs</span>(Loading)))</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Display in gt table</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>efa_summary <span class="sc">|&gt;</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"EFA Summary Table"</span>,</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Maximum Loading, Communality, and Uniqueness per Item"</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Loading, Communality, Uniqueness),</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Item =</span> <span class="st">"Item"</span>,</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Factor =</span> <span class="st">"Primary Factor"</span>,</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Loading =</span> <span class="st">"Max Loading"</span>,</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">Communality =</span> <span class="st">"h²"</span>,</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">Uniqueness =</span> <span class="st">"u²"</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Factor Solution"</span>,</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Item, Factor, Loading)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Variance Components"</span>,</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Communality, Uniqueness)</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="sc">-</span>Item</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#f8f9fa"</span>),</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>)</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_spanners</span>()</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"h² = communality (proportion of variance explained by factors)"</span>,</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> Communality)</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"u² = uniqueness (1 - communality)"</span>,</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> Uniqueness)</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="qnukbmywtd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qnukbmywtd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qnukbmywtd thead, #qnukbmywtd tbody, #qnukbmywtd tfoot, #qnukbmywtd tr, #qnukbmywtd td, #qnukbmywtd th {
  border-style: none;
}

#qnukbmywtd p {
  margin: 0;
  padding: 0;
}

#qnukbmywtd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qnukbmywtd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qnukbmywtd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qnukbmywtd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qnukbmywtd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qnukbmywtd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qnukbmywtd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qnukbmywtd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qnukbmywtd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qnukbmywtd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qnukbmywtd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qnukbmywtd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qnukbmywtd .gt_spanner_row {
  border-bottom-style: hidden;
}

#qnukbmywtd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qnukbmywtd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qnukbmywtd .gt_from_md > :first-child {
  margin-top: 0;
}

#qnukbmywtd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qnukbmywtd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qnukbmywtd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qnukbmywtd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qnukbmywtd .gt_row_group_first td {
  border-top-width: 2px;
}

#qnukbmywtd .gt_row_group_first th {
  border-top-width: 2px;
}

#qnukbmywtd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qnukbmywtd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qnukbmywtd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qnukbmywtd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qnukbmywtd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qnukbmywtd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qnukbmywtd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qnukbmywtd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qnukbmywtd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qnukbmywtd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qnukbmywtd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qnukbmywtd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qnukbmywtd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qnukbmywtd .gt_left {
  text-align: left;
}

#qnukbmywtd .gt_center {
  text-align: center;
}

#qnukbmywtd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qnukbmywtd .gt_font_normal {
  font-weight: normal;
}

#qnukbmywtd .gt_font_bold {
  font-weight: bold;
}

#qnukbmywtd .gt_font_italic {
  font-style: italic;
}

#qnukbmywtd .gt_super {
  font-size: 65%;
}

#qnukbmywtd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qnukbmywtd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qnukbmywtd .gt_indent_1 {
  text-indent: 5px;
}

#qnukbmywtd .gt_indent_2 {
  text-indent: 10px;
}

#qnukbmywtd .gt_indent_3 {
  text-indent: 15px;
}

#qnukbmywtd .gt_indent_4 {
  text-indent: 20px;
}

#qnukbmywtd .gt_indent_5 {
  text-indent: 25px;
}

#qnukbmywtd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qnukbmywtd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal">EFA Summary Table</th>
</tr>
<tr class="gt_heading even">
<th colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Maximum Loading, Communality, and Uniqueness per Item</th>
</tr>
<tr class="gt_col_headings gt_spanner_row header">
<th colspan="3" id="Factor Solution" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" style="background-color: #F8F9FA; font-weight: bold" scope="colgroup"><div class="gt_column_spanner">
Factor Solution
</div></th>
<th colspan="2" id="Variance Components" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" style="background-color: #F8F9FA; font-weight: bold" scope="colgroup"><div class="gt_column_spanner">
Variance Components
</div></th>
</tr>
<tr class="gt_col_headings even">
<th id="Item" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Item</th>
<th id="Factor" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Primary Factor</th>
<th id="Loading" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Max Loading</th>
<th id="Communality" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">h²<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="Uniqueness" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">u²<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Item">V11</td>
<td class="gt_row gt_center" headers="Factor">ML1</td>
<td class="gt_row gt_center" headers="Loading">0.964</td>
<td class="gt_row gt_center" headers="Communality">0.962</td>
<td class="gt_row gt_center" headers="Uniqueness">0.038</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Item">V8</td>
<td class="gt_row gt_center" headers="Factor">ML1</td>
<td class="gt_row gt_center" headers="Loading">0.946</td>
<td class="gt_row gt_center" headers="Communality">0.946</td>
<td class="gt_row gt_center" headers="Uniqueness">0.054</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Item">V5</td>
<td class="gt_row gt_center" headers="Factor">ML1</td>
<td class="gt_row gt_center" headers="Loading">0.927</td>
<td class="gt_row gt_center" headers="Communality">0.961</td>
<td class="gt_row gt_center" headers="Uniqueness">0.039</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Item">V13</td>
<td class="gt_row gt_center" headers="Factor">ML1</td>
<td class="gt_row gt_center" headers="Loading">0.889</td>
<td class="gt_row gt_center" headers="Communality">0.958</td>
<td class="gt_row gt_center" headers="Uniqueness">0.042</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Item">V2</td>
<td class="gt_row gt_center" headers="Factor">ML2</td>
<td class="gt_row gt_center" headers="Loading">0.994</td>
<td class="gt_row gt_center" headers="Communality">1.148</td>
<td class="gt_row gt_center" headers="Uniqueness">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Item">V4</td>
<td class="gt_row gt_center" headers="Factor">ML2</td>
<td class="gt_row gt_center" headers="Loading">0.951</td>
<td class="gt_row gt_center" headers="Communality">1.100</td>
<td class="gt_row gt_center" headers="Uniqueness">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Item">V3</td>
<td class="gt_row gt_center" headers="Factor">ML2</td>
<td class="gt_row gt_center" headers="Loading">0.815</td>
<td class="gt_row gt_center" headers="Communality">0.953</td>
<td class="gt_row gt_center" headers="Uniqueness">0.047</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Item">V6</td>
<td class="gt_row gt_center" headers="Factor">ML2</td>
<td class="gt_row gt_center" headers="Loading">−0.695</td>
<td class="gt_row gt_center" headers="Communality">0.984</td>
<td class="gt_row gt_center" headers="Uniqueness">0.016</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Item">V9</td>
<td class="gt_row gt_center" headers="Factor">ML2</td>
<td class="gt_row gt_center" headers="Loading">−0.631</td>
<td class="gt_row gt_center" headers="Communality">0.857</td>
<td class="gt_row gt_center" headers="Uniqueness">0.143</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Item">V14</td>
<td class="gt_row gt_center" headers="Factor">ML2</td>
<td class="gt_row gt_center" headers="Loading">0.598</td>
<td class="gt_row gt_center" headers="Communality">0.756</td>
<td class="gt_row gt_center" headers="Uniqueness">0.244</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Item">V7</td>
<td class="gt_row gt_center" headers="Factor">ML3</td>
<td class="gt_row gt_center" headers="Loading">0.999</td>
<td class="gt_row gt_center" headers="Communality">1.168</td>
<td class="gt_row gt_center" headers="Uniqueness">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Item">V1</td>
<td class="gt_row gt_center" headers="Factor">ML3</td>
<td class="gt_row gt_center" headers="Loading">0.949</td>
<td class="gt_row gt_center" headers="Communality">1.010</td>
<td class="gt_row gt_center" headers="Uniqueness">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Item">V12</td>
<td class="gt_row gt_center" headers="Factor">ML4</td>
<td class="gt_row gt_center" headers="Loading">0.873</td>
<td class="gt_row gt_center" headers="Communality">0.817</td>
<td class="gt_row gt_center" headers="Uniqueness">0.183</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Item">V15</td>
<td class="gt_row gt_center" headers="Factor">ML4</td>
<td class="gt_row gt_center" headers="Loading">0.588</td>
<td class="gt_row gt_center" headers="Communality">0.765</td>
<td class="gt_row gt_center" headers="Uniqueness">0.235</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Item">V10</td>
<td class="gt_row gt_center" headers="Factor">ML4</td>
<td class="gt_row gt_center" headers="Loading">0.580</td>
<td class="gt_row gt_center" headers="Communality">0.784</td>
<td class="gt_row gt_center" headers="Uniqueness">0.216</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> h² = communality (proportion of variance explained by factors)</td>
</tr>
<tr class="even">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> u² = uniqueness (1 - communality)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>上表は各項目が<strong>最も強く負荷する因子</strong>と、その<strong>共通性（因子で説明される割合）</strong>、<strong>独自性</strong>を並べたものです。共通性が低い項目はスケールからの除外や項目修正の候補になります。</p>
</section>
<section id="信頼性α係数ω係数" class="level3" data-number="13.1.4">
<h3 data-number="13.1.4" class="anchored" data-anchor-id="信頼性α係数ω係数"><span class="header-section-number">13.1.4</span> 信頼性（α係数・ω係数）</h3>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select items loading highest on Factor 1 (example)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>items_f1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"V6"</span>, <span class="st">"V14"</span>, <span class="st">"V1"</span>, <span class="st">"V7"</span>)  <span class="co"># Adjust based on actual data</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate reliability coefficients</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>alpha_result <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">alpha</span>(survey[, items_f1])</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Some items ( V14 ) were negatively correlated with the first principal component and 
probably should be reversed.  
To do this, run the function again with the 'check.keys=TRUE' option</code></pre>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>omega_result <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">omega</span>(survey[, items_f1], <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create reliability summary table</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Coefficient =</span> <span class="fu">c</span>(<span class="st">"Cronbach's α"</span>, <span class="st">"McDonald's ω"</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, omega_result<span class="sc">$</span>omega.tot),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_lower =</span> <span class="fu">c</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>ase <span class="sc">*</span> <span class="sc">-</span><span class="fl">1.96</span> <span class="sc">+</span> alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_upper =</span> <span class="fu">c</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>ase <span class="sc">*</span> <span class="fl">1.96</span> <span class="sc">+</span> alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Internal Consistency Reliability"</span>,</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Factor 1 items:"</span>, <span class="fu">paste</span>(items_f1, <span class="at">collapse =</span> <span class="st">", "</span>))</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Value, CI_lower, CI_upper),</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_merge</span>(</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(CI_lower, CI_upper),</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">"[{1}, {2}]"</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">Coefficient =</span> <span class="st">"Coefficient"</span>,</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="st">"Estimate"</span>,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_lower =</span> <span class="st">"95% CI"</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sub_missing</span>(</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> CI_lower,</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing_text =</span> <span class="st">"—"</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6ffe6"</span>),</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Value,</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Value <span class="sc">&gt;</span> <span class="fl">0.7</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Values &gt; 0.7 indicate acceptable reliability"</span>,</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> Value)</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="cjtatsgzgg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cjtatsgzgg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cjtatsgzgg thead, #cjtatsgzgg tbody, #cjtatsgzgg tfoot, #cjtatsgzgg tr, #cjtatsgzgg td, #cjtatsgzgg th {
  border-style: none;
}

#cjtatsgzgg p {
  margin: 0;
  padding: 0;
}

#cjtatsgzgg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cjtatsgzgg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cjtatsgzgg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cjtatsgzgg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cjtatsgzgg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cjtatsgzgg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cjtatsgzgg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cjtatsgzgg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cjtatsgzgg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cjtatsgzgg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cjtatsgzgg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cjtatsgzgg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cjtatsgzgg .gt_spanner_row {
  border-bottom-style: hidden;
}

#cjtatsgzgg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cjtatsgzgg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cjtatsgzgg .gt_from_md > :first-child {
  margin-top: 0;
}

#cjtatsgzgg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cjtatsgzgg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cjtatsgzgg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cjtatsgzgg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cjtatsgzgg .gt_row_group_first td {
  border-top-width: 2px;
}

#cjtatsgzgg .gt_row_group_first th {
  border-top-width: 2px;
}

#cjtatsgzgg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cjtatsgzgg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cjtatsgzgg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cjtatsgzgg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cjtatsgzgg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cjtatsgzgg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cjtatsgzgg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cjtatsgzgg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cjtatsgzgg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cjtatsgzgg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cjtatsgzgg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cjtatsgzgg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cjtatsgzgg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cjtatsgzgg .gt_left {
  text-align: left;
}

#cjtatsgzgg .gt_center {
  text-align: center;
}

#cjtatsgzgg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cjtatsgzgg .gt_font_normal {
  font-weight: normal;
}

#cjtatsgzgg .gt_font_bold {
  font-weight: bold;
}

#cjtatsgzgg .gt_font_italic {
  font-style: italic;
}

#cjtatsgzgg .gt_super {
  font-size: 65%;
}

#cjtatsgzgg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cjtatsgzgg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cjtatsgzgg .gt_indent_1 {
  text-indent: 5px;
}

#cjtatsgzgg .gt_indent_2 {
  text-indent: 10px;
}

#cjtatsgzgg .gt_indent_3 {
  text-indent: 15px;
}

#cjtatsgzgg .gt_indent_4 {
  text-indent: 20px;
}

#cjtatsgzgg .gt_indent_5 {
  text-indent: 25px;
}

#cjtatsgzgg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cjtatsgzgg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="3" class="gt_heading gt_title gt_font_normal">Internal Consistency Reliability</th>
</tr>
<tr class="gt_heading even">
<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Factor 1 items: V6, V14, V1, V7</th>
</tr>
<tr class="gt_col_headings header">
<th id="Coefficient" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Coefficient</th>
<th id="Value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Estimate<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="CI_lower" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">95% CI</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Coefficient">Cronbach's α</td>
<td class="gt_row gt_right" headers="Value">0.212</td>
<td class="gt_row gt_right" headers="CI_lower">[0.136, 0.289]</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Coefficient">McDonald's ω</td>
<td class="gt_row gt_right" headers="Value" style="background-color: #E6FFE6">0.927</td>
<td class="gt_row gt_right" headers="CI_lower">[—, NA]</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="3" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Values &gt; 0.7 indicate acceptable reliability</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="可視化" class="level3" data-number="13.1.5">
<h3 data-number="13.1.5" class="anchored" data-anchor-id="可視化"><span class="header-section-number">13.1.5</span> 可視化</h3>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor structure diagram</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">fa.diagram</span>(fit_efa)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/efa-visualization-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create loading bar plot</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>loadings_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(<span class="fu">unclass</span>(fit_efa<span class="sc">$</span>loadings))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>loadings_df<span class="sc">$</span>Item <span class="ot">&lt;-</span> <span class="fu">rownames</span>(loadings_df)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>loadings_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(loadings_df, <span class="at">cols =</span> <span class="sc">-</span>Item, <span class="at">names_to =</span> <span class="st">"Factor"</span>, <span class="at">values_to =</span> <span class="st">"Loading"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(loadings_long, <span class="fu">aes</span>(<span class="at">x =</span> Item, <span class="at">y =</span> <span class="fu">abs</span>(Loading), <span class="at">fill =</span> Factor)) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Factor Loadings by Item"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Item"</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"|Loading|"</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/efa-visualization-2.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
<section id="因子負荷のヒートマップtidyverse" class="level4">
<h4 class="anchored" data-anchor-id="因子負荷のヒートマップtidyverse">因子負荷のヒートマップ（tidyverse）</h4>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare heatmap data</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>heat_tbl <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">unclass</span>(fit_efa<span class="sc">$</span>loadings)) <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Item"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Item, <span class="at">names_to =</span> <span class="st">"Factor"</span>, <span class="at">values_to =</span> <span class="st">"Loading"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Abs =</span> <span class="fu">abs</span>(Loading))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create heatmap</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heat_tbl, <span class="fu">aes</span>(Factor, Item, <span class="at">fill =</span> Loading)) <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">"blue"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Loading"</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"EFA Loadings Heatmap"</span>,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Red = positive loading, Blue = negative loading"</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/efa-heatmap-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="確認的因子分析cfa" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> 確認的因子分析（CFA）</h1>
<section id="lavaan-の記法とデータ" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="lavaan-の記法とデータ"><span class="header-section-number">14.1</span> lavaan の記法とデータ</h2>
<p><code>=~</code> は「〜により測定」を表し、<code>~~</code> は（共）分散、<code>~</code> は回帰、<code>~1</code> は切片を表します。</p>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load example data from lavaan</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(HolzingerSwineford1939)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumed: x1-x3 = visual, x4-x6 = textual, x7-x9 = speed</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="モデル定義と推定" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="モデル定義と推定"><span class="header-section-number">14.2</span> モデル定義と推定</h2>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define CFA models</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="st">  visual  =~ x1 + x2 + x3</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="st">  textual =~ x4 + x5 + x6</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="st">  speed   =~ x7 + x8 + x9</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="st">  visual  =~ x1 + x2</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="st">  textual =~ x4 + x5</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="st">  speed   =~ x7 + x8</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>fit_cfa_1 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model_1, <span class="at">data =</span> HolzingerSwineford1939, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>fit_cfa_2 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model_2, <span class="at">data =</span> HolzingerSwineford1939, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Display summary</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_cfa_1, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 20 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        21

  Number of observations                           301

Model Test User Model:
                                                      
  Test statistic                                85.306
  Degrees of freedom                                24
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               918.852
  Degrees of freedom                                36
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.931
  Tucker-Lewis Index (TLI)                       0.896

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3737.745
  Loglikelihood unrestricted model (H1)      -3695.092
                                                      
  Akaike (AIC)                                7517.490
  Bayesian (BIC)                              7595.339
  Sample-size adjusted Bayesian (SABIC)       7528.739

Root Mean Square Error of Approximation:

  RMSEA                                          0.092
  90 Percent confidence interval - lower         0.071
  90 Percent confidence interval - upper         0.114
  P-value H_0: RMSEA &lt;= 0.050                    0.001
  P-value H_0: RMSEA &gt;= 0.080                    0.840

Standardized Root Mean Square Residual:

  SRMR                                           0.065

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1                0.900    0.081   11.128    0.000    0.900    0.772
    x2                0.498    0.077    6.429    0.000    0.498    0.424
    x3                0.656    0.074    8.817    0.000    0.656    0.581
  textual =~                                                            
    x4                0.990    0.057   17.474    0.000    0.990    0.852
    x5                1.102    0.063   17.576    0.000    1.102    0.855
    x6                0.917    0.054   17.082    0.000    0.917    0.838
  speed =~                                                              
    x7                0.619    0.070    8.903    0.000    0.619    0.570
    x8                0.731    0.066   11.090    0.000    0.731    0.723
    x9                0.670    0.065   10.305    0.000    0.670    0.665

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textual           0.459    0.064    7.189    0.000    0.459    0.459
    speed             0.471    0.073    6.461    0.000    0.471    0.471
  textual ~~                                                            
    speed             0.283    0.069    4.117    0.000    0.283    0.283

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1                0.549    0.114    4.833    0.000    0.549    0.404
   .x2                1.134    0.102   11.146    0.000    1.134    0.821
   .x3                0.844    0.091    9.317    0.000    0.844    0.662
   .x4                0.371    0.048    7.779    0.000    0.371    0.275
   .x5                0.446    0.058    7.642    0.000    0.446    0.269
   .x6                0.356    0.043    8.277    0.000    0.356    0.298
   .x7                0.799    0.081    9.823    0.000    0.799    0.676
   .x8                0.488    0.074    6.573    0.000    0.488    0.477
   .x9                0.566    0.071    8.003    0.000    0.566    0.558
    visual            1.000                               1.000    1.000
    textual           1.000                               1.000    1.000
    speed             1.000                               1.000    1.000</code></pre>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and display fit indices</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>fit_indices_1 <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(fit_cfa_1, <span class="fu">c</span>(<span class="st">"chisq"</span>,<span class="st">"df"</span>,<span class="st">"pvalue"</span>,<span class="st">"cfi"</span>,<span class="st">"tli"</span>,<span class="st">"rmsea"</span>,<span class="st">"srmr"</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>fit_indices_2 <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(fit_cfa_2, <span class="fu">c</span>(<span class="st">"chisq"</span>,<span class="st">"df"</span>,<span class="st">"pvalue"</span>,<span class="st">"cfi"</span>,<span class="st">"tli"</span>,<span class="st">"rmsea"</span>,<span class="st">"srmr"</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create fit indices comparison table</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Measure =</span> <span class="fu">names</span>(fit_indices_1),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model_1 =</span> <span class="fu">as.numeric</span>(fit_indices_1),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model_2 =</span> <span class="fu">as.numeric</span>(fit_indices_2)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"CFA Model Fit Comparison"</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Model 1 (3 indicators per factor) vs Model 2 (2 indicators per factor)"</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Model_1, Model_2),</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> Measure <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"df"</span>),</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">0</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Model_1, Model_2),</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> Measure <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"cfi"</span>, <span class="st">"tli"</span>, <span class="st">"rmsea"</span>, <span class="st">"srmr"</span>),</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_scientific</span>(</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Model_1, Model_2),</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> Measure <span class="sc">==</span> <span class="st">"pvalue"</span>,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Measure =</span> <span class="st">"Fit Index"</span>,</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model_1 =</span> <span class="st">"Model 1"</span>,</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model_2 =</span> <span class="st">"Model 2"</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6ffe6"</span>),</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Model_1,</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> (Measure <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"cfi"</span>, <span class="st">"tli"</span>) <span class="sc">&amp;</span> Model_1 <span class="sc">&gt;</span> <span class="fl">0.95</span>) <span class="sc">|</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>             (Measure <span class="sc">==</span> <span class="st">"rmsea"</span> <span class="sc">&amp;</span> Model_1 <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">|</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>             (Measure <span class="sc">==</span> <span class="st">"srmr"</span> <span class="sc">&amp;</span> Model_1 <span class="sc">&lt;</span> <span class="fl">0.08</span>)</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6ffe6"</span>),</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Model_2,</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> (Measure <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"cfi"</span>, <span class="st">"tli"</span>) <span class="sc">&amp;</span> Model_2 <span class="sc">&gt;</span> <span class="fl">0.95</span>) <span class="sc">|</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>             (Measure <span class="sc">==</span> <span class="st">"rmsea"</span> <span class="sc">&amp;</span> Model_2 <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">|</span></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>             (Measure <span class="sc">==</span> <span class="st">"srmr"</span> <span class="sc">&amp;</span> Model_2 <span class="sc">&lt;</span> <span class="fl">0.08</span>)</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Good fit: CFI/TLI &gt; 0.95, RMSEA &lt; 0.05, SRMR &lt; 0.08"</span>,</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="fu">c</span>(Model_1, Model_2))</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ejpvuuonzy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ejpvuuonzy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ejpvuuonzy thead, #ejpvuuonzy tbody, #ejpvuuonzy tfoot, #ejpvuuonzy tr, #ejpvuuonzy td, #ejpvuuonzy th {
  border-style: none;
}

#ejpvuuonzy p {
  margin: 0;
  padding: 0;
}

#ejpvuuonzy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ejpvuuonzy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ejpvuuonzy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ejpvuuonzy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ejpvuuonzy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ejpvuuonzy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ejpvuuonzy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ejpvuuonzy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ejpvuuonzy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ejpvuuonzy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ejpvuuonzy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ejpvuuonzy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ejpvuuonzy .gt_spanner_row {
  border-bottom-style: hidden;
}

#ejpvuuonzy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ejpvuuonzy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ejpvuuonzy .gt_from_md > :first-child {
  margin-top: 0;
}

#ejpvuuonzy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ejpvuuonzy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ejpvuuonzy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ejpvuuonzy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ejpvuuonzy .gt_row_group_first td {
  border-top-width: 2px;
}

#ejpvuuonzy .gt_row_group_first th {
  border-top-width: 2px;
}

#ejpvuuonzy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejpvuuonzy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ejpvuuonzy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ejpvuuonzy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ejpvuuonzy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejpvuuonzy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ejpvuuonzy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ejpvuuonzy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ejpvuuonzy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ejpvuuonzy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ejpvuuonzy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejpvuuonzy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ejpvuuonzy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejpvuuonzy .gt_left {
  text-align: left;
}

#ejpvuuonzy .gt_center {
  text-align: center;
}

#ejpvuuonzy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ejpvuuonzy .gt_font_normal {
  font-weight: normal;
}

#ejpvuuonzy .gt_font_bold {
  font-weight: bold;
}

#ejpvuuonzy .gt_font_italic {
  font-style: italic;
}

#ejpvuuonzy .gt_super {
  font-size: 65%;
}

#ejpvuuonzy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ejpvuuonzy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ejpvuuonzy .gt_indent_1 {
  text-indent: 5px;
}

#ejpvuuonzy .gt_indent_2 {
  text-indent: 10px;
}

#ejpvuuonzy .gt_indent_3 {
  text-indent: 15px;
}

#ejpvuuonzy .gt_indent_4 {
  text-indent: 20px;
}

#ejpvuuonzy .gt_indent_5 {
  text-indent: 25px;
}

#ejpvuuonzy .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ejpvuuonzy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="3" class="gt_heading gt_title gt_font_normal">CFA Model Fit Comparison</th>
</tr>
<tr class="gt_heading even">
<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Model 1 (3 indicators per factor) vs Model 2 (2 indicators per factor)</th>
</tr>
<tr class="gt_col_headings header">
<th id="Measure" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Fit Index</th>
<th id="Model_1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Model 1<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="Model_2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Model 2<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Measure">chisq</td>
<td class="gt_row gt_right" headers="Model_1">85</td>
<td class="gt_row gt_right" headers="Model_2">19</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Measure">df</td>
<td class="gt_row gt_right" headers="Model_1">24</td>
<td class="gt_row gt_right" headers="Model_2">6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Measure">pvalue</td>
<td class="gt_row gt_right" headers="Model_1">8.503&nbsp;×&nbsp;10<sup>−9</sup></td>
<td class="gt_row gt_right" headers="Model_2">4.767&nbsp;×&nbsp;10<sup>−3</sup></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Measure">cfi</td>
<td class="gt_row gt_right" headers="Model_1">0.931</td>
<td class="gt_row gt_right" headers="Model_2" style="background-color: #E6FFE6">0.969</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Measure">tli</td>
<td class="gt_row gt_right" headers="Model_1">0.896</td>
<td class="gt_row gt_right" headers="Model_2">0.922</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Measure">rmsea</td>
<td class="gt_row gt_right" headers="Model_1">0.092</td>
<td class="gt_row gt_right" headers="Model_2">0.084</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Measure">srmr</td>
<td class="gt_row gt_right" headers="Model_1" style="background-color: #E6FFE6">0.065</td>
<td class="gt_row gt_right" headers="Model_2" style="background-color: #E6FFE6">0.057</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="3" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Good fit: CFI/TLI &gt; 0.95, RMSEA &lt; 0.05, SRMR &lt; 0.08</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p><strong>モデル適合度の読み方</strong>: CFI/TLI は 0.90 以上（望ましくは 0.95 以上）、RMSEA は 0.08 未満（望ましくは 0.05 未満）、SRMR は 0.08 未満が一つの目安です。適合だけでなく、<strong>理論整合性</strong>・<strong>パラメータの解釈可能性</strong>・<strong>識別性</strong>を合わせて評価します。</p>
<section id="可視化と含意共分散" class="level3" data-number="14.2.1">
<h3 data-number="14.2.1" class="anchored" data-anchor-id="可視化と含意共分散"><span class="header-section-number">14.2.1</span> 可視化と含意共分散</h3>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Path diagrams</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fit_cfa_1, <span class="at">whatLabels =</span> <span class="st">"est"</span>, <span class="at">layout =</span> <span class="st">"tree"</span>, <span class="at">rotation =</span> <span class="dv">2</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/cfa-visualization-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fit_cfa_1, <span class="at">what =</span> <span class="st">"stand"</span>, <span class="at">style =</span> <span class="st">"lisrel"</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/cfa-visualization-2.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display implied covariance matrix</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>implied_cov <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(fit_cfa_1, <span class="at">what =</span> <span class="st">"implied"</span>)<span class="sc">$</span>cov</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Show first 6x6 of implied covariance matrix</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(implied_cov[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]) <span class="sc">|&gt;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Variable"</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Implied Covariance Matrix"</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"First 6 variables shown"</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="sc">-</span>Variable,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#f8f9fa"</span>),</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns =</span> Variable)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="aeltgaiovw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#aeltgaiovw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#aeltgaiovw thead, #aeltgaiovw tbody, #aeltgaiovw tfoot, #aeltgaiovw tr, #aeltgaiovw td, #aeltgaiovw th {
  border-style: none;
}

#aeltgaiovw p {
  margin: 0;
  padding: 0;
}

#aeltgaiovw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#aeltgaiovw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#aeltgaiovw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#aeltgaiovw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#aeltgaiovw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aeltgaiovw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aeltgaiovw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aeltgaiovw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#aeltgaiovw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#aeltgaiovw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#aeltgaiovw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#aeltgaiovw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#aeltgaiovw .gt_spanner_row {
  border-bottom-style: hidden;
}

#aeltgaiovw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#aeltgaiovw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#aeltgaiovw .gt_from_md > :first-child {
  margin-top: 0;
}

#aeltgaiovw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#aeltgaiovw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#aeltgaiovw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#aeltgaiovw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#aeltgaiovw .gt_row_group_first td {
  border-top-width: 2px;
}

#aeltgaiovw .gt_row_group_first th {
  border-top-width: 2px;
}

#aeltgaiovw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aeltgaiovw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#aeltgaiovw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#aeltgaiovw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aeltgaiovw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aeltgaiovw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#aeltgaiovw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#aeltgaiovw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#aeltgaiovw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aeltgaiovw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aeltgaiovw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aeltgaiovw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aeltgaiovw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aeltgaiovw .gt_left {
  text-align: left;
}

#aeltgaiovw .gt_center {
  text-align: center;
}

#aeltgaiovw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#aeltgaiovw .gt_font_normal {
  font-weight: normal;
}

#aeltgaiovw .gt_font_bold {
  font-weight: bold;
}

#aeltgaiovw .gt_font_italic {
  font-style: italic;
}

#aeltgaiovw .gt_super {
  font-size: 65%;
}

#aeltgaiovw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#aeltgaiovw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#aeltgaiovw .gt_indent_1 {
  text-indent: 5px;
}

#aeltgaiovw .gt_indent_2 {
  text-indent: 10px;
}

#aeltgaiovw .gt_indent_3 {
  text-indent: 15px;
}

#aeltgaiovw .gt_indent_4 {
  text-indent: 20px;
}

#aeltgaiovw .gt_indent_5 {
  text-indent: 25px;
}

#aeltgaiovw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#aeltgaiovw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="7" class="gt_heading gt_title gt_font_normal">Model Implied Covariance Matrix</th>
</tr>
<tr class="gt_heading even">
<th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">First 6 variables shown</th>
</tr>
<tr class="gt_col_headings header">
<th id="Variable" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Variable</th>
<th id="x1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">x1</th>
<th id="x2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">x2</th>
<th id="x3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">x3</th>
<th id="x4" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">x4</th>
<th id="x5" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">x5</th>
<th id="x6" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">x6</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Variable" style="background-color: #F8F9FA">x1</td>
<td class="gt_row gt_right" headers="x1">1.358</td>
<td class="gt_row gt_right" headers="x2">0.448</td>
<td class="gt_row gt_right" headers="x3">0.590</td>
<td class="gt_row gt_right" headers="x4">0.408</td>
<td class="gt_row gt_right" headers="x5">0.454</td>
<td class="gt_row gt_right" headers="x6">0.378</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable" style="background-color: #F8F9FA">x2</td>
<td class="gt_row gt_right" headers="x1">0.448</td>
<td class="gt_row gt_right" headers="x2">1.382</td>
<td class="gt_row gt_right" headers="x3">0.327</td>
<td class="gt_row gt_right" headers="x4">0.226</td>
<td class="gt_row gt_right" headers="x5">0.252</td>
<td class="gt_row gt_right" headers="x6">0.209</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variable" style="background-color: #F8F9FA">x3</td>
<td class="gt_row gt_right" headers="x1">0.590</td>
<td class="gt_row gt_right" headers="x2">0.327</td>
<td class="gt_row gt_right" headers="x3">1.275</td>
<td class="gt_row gt_right" headers="x4">0.298</td>
<td class="gt_row gt_right" headers="x5">0.331</td>
<td class="gt_row gt_right" headers="x6">0.276</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable" style="background-color: #F8F9FA">x4</td>
<td class="gt_row gt_right" headers="x1">0.408</td>
<td class="gt_row gt_right" headers="x2">0.226</td>
<td class="gt_row gt_right" headers="x3">0.298</td>
<td class="gt_row gt_right" headers="x4">1.351</td>
<td class="gt_row gt_right" headers="x5">1.090</td>
<td class="gt_row gt_right" headers="x6">0.907</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variable" style="background-color: #F8F9FA">x5</td>
<td class="gt_row gt_right" headers="x1">0.454</td>
<td class="gt_row gt_right" headers="x2">0.252</td>
<td class="gt_row gt_right" headers="x3">0.331</td>
<td class="gt_row gt_right" headers="x4">1.090</td>
<td class="gt_row gt_right" headers="x5">1.660</td>
<td class="gt_row gt_right" headers="x6">1.010</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable" style="background-color: #F8F9FA">x6</td>
<td class="gt_row gt_right" headers="x1">0.378</td>
<td class="gt_row gt_right" headers="x2">0.209</td>
<td class="gt_row gt_right" headers="x3">0.276</td>
<td class="gt_row gt_right" headers="x4">0.907</td>
<td class="gt_row gt_right" headers="x5">1.010</td>
<td class="gt_row gt_right" headers="x6">1.196</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
</section>
<section id="主成分分析pca" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> 主成分分析（PCA）</h1>
<p>PCA は観測変数から<strong>主成分</strong>を抽出し、全分散のうち何割を説明できるか（寄与率）で次元削減を行う手法です。</p>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load example data</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(decathlon)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA with supplementary variables</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantitative supplementary: columns 11-12</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Qualitative supplementary: column 13</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>res_pca <span class="ot">&lt;-</span> <span class="fu">PCA</span>(decathlon, <span class="at">quanti.sup =</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">quali.sup =</span> <span class="dv">13</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display eigenvalues and variance explained</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>pca_eig_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(res_pca<span class="sc">$</span>eig)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>pca_eig_df<span class="sc">$</span>Dimension <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pca_eig_df)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>pca_eig_df <span class="sc">|&gt;</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Dimension, <span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PCA Eigenvalues and Variance Explained"</span>,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Decathlon dataset"</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="sc">-</span>Dimension,</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dimension =</span> <span class="st">"Dim"</span>,</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">eigenvalue =</span> <span class="st">"Eigenvalue"</span>,</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">percentage of variance</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"% Variance"</span>,</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Cumulative %"</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6ffe6"</span>),</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span>,</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">80</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"First few components typically explain most variance"</span>,</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span>)</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="zwwitljcik" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zwwitljcik table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zwwitljcik thead, #zwwitljcik tbody, #zwwitljcik tfoot, #zwwitljcik tr, #zwwitljcik td, #zwwitljcik th {
  border-style: none;
}

#zwwitljcik p {
  margin: 0;
  padding: 0;
}

#zwwitljcik .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zwwitljcik .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zwwitljcik .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zwwitljcik .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zwwitljcik .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zwwitljcik .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zwwitljcik .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zwwitljcik .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zwwitljcik .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zwwitljcik .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zwwitljcik .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zwwitljcik .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zwwitljcik .gt_spanner_row {
  border-bottom-style: hidden;
}

#zwwitljcik .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zwwitljcik .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zwwitljcik .gt_from_md > :first-child {
  margin-top: 0;
}

#zwwitljcik .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zwwitljcik .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zwwitljcik .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zwwitljcik .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zwwitljcik .gt_row_group_first td {
  border-top-width: 2px;
}

#zwwitljcik .gt_row_group_first th {
  border-top-width: 2px;
}

#zwwitljcik .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zwwitljcik .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zwwitljcik .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zwwitljcik .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zwwitljcik .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zwwitljcik .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zwwitljcik .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zwwitljcik .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zwwitljcik .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zwwitljcik .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zwwitljcik .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zwwitljcik .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zwwitljcik .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zwwitljcik .gt_left {
  text-align: left;
}

#zwwitljcik .gt_center {
  text-align: center;
}

#zwwitljcik .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zwwitljcik .gt_font_normal {
  font-weight: normal;
}

#zwwitljcik .gt_font_bold {
  font-weight: bold;
}

#zwwitljcik .gt_font_italic {
  font-style: italic;
}

#zwwitljcik .gt_super {
  font-size: 65%;
}

#zwwitljcik .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zwwitljcik .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zwwitljcik .gt_indent_1 {
  text-indent: 5px;
}

#zwwitljcik .gt_indent_2 {
  text-indent: 10px;
}

#zwwitljcik .gt_indent_3 {
  text-indent: 15px;
}

#zwwitljcik .gt_indent_4 {
  text-indent: 20px;
}

#zwwitljcik .gt_indent_5 {
  text-indent: 25px;
}

#zwwitljcik .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zwwitljcik div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal">PCA Eigenvalues and Variance Explained</th>
</tr>
<tr class="gt_heading even">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Decathlon dataset</th>
</tr>
<tr class="gt_col_headings header">
<th id="Dimension" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Dim</th>
<th id="eigenvalue" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Eigenvalue</th>
<th id="percentage-of-variance" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">% Variance</th>
<th id="cumulative-percentage-of-variance" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Cumulative %<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Dimension">1</td>
<td class="gt_row gt_right" headers="eigenvalue">3.27</td>
<td class="gt_row gt_right" headers="percentage of variance">32.72</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance" style="background-color: #E6FFE6">32.72</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Dimension">2</td>
<td class="gt_row gt_right" headers="eigenvalue">1.74</td>
<td class="gt_row gt_right" headers="percentage of variance">17.37</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance" style="background-color: #E6FFE6">50.09</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Dimension">3</td>
<td class="gt_row gt_right" headers="eigenvalue">1.40</td>
<td class="gt_row gt_right" headers="percentage of variance">14.05</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance" style="background-color: #E6FFE6">64.14</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Dimension">4</td>
<td class="gt_row gt_right" headers="eigenvalue">1.06</td>
<td class="gt_row gt_right" headers="percentage of variance">10.57</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance" style="background-color: #E6FFE6">74.71</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Dimension">5</td>
<td class="gt_row gt_right" headers="eigenvalue">0.68</td>
<td class="gt_row gt_right" headers="percentage of variance">6.85</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance">81.56</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Dimension">6</td>
<td class="gt_row gt_right" headers="eigenvalue">0.60</td>
<td class="gt_row gt_right" headers="percentage of variance">5.99</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance">87.55</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Dimension">7</td>
<td class="gt_row gt_right" headers="eigenvalue">0.45</td>
<td class="gt_row gt_right" headers="percentage of variance">4.51</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance">92.06</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Dimension">8</td>
<td class="gt_row gt_right" headers="eigenvalue">0.40</td>
<td class="gt_row gt_right" headers="percentage of variance">3.97</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance">96.03</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Dimension">9</td>
<td class="gt_row gt_right" headers="eigenvalue">0.21</td>
<td class="gt_row gt_right" headers="percentage of variance">2.15</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance">98.18</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Dimension">10</td>
<td class="gt_row gt_right" headers="eigenvalue">0.18</td>
<td class="gt_row gt_right" headers="percentage of variance">1.82</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance">100.00</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> First few components typically explain most variance</td>
</tr>
</tfoot>

</table>

</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(res_pca, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/pca-analysis-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(res_pca, <span class="at">addlabels =</span> <span class="cn">TRUE</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/pca-analysis-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<p>主成分は<strong>分散を最大化</strong>する直交軸で、因子分析のように誤差項を明示的に分離しません。スケーリング（共分散行列か相関行列か）に注意が必要です。</p>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coordinates for tidyverse biplot</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_pca<span class="sc">$</span>ind<span class="sc">$</span>coord) <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>())</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_pca<span class="sc">$</span>var<span class="sc">$</span>coord, <span class="at">rownames =</span> <span class="st">"Variable"</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create biplot with ggplot2</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> ind, <span class="fu">aes</span>(Dim<span class="fl">.1</span>, Dim<span class="fl">.2</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> var, </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> Dim<span class="fl">.1</span> <span class="sc">*</span> <span class="dv">3</span>, <span class="at">yend =</span> Dim<span class="fl">.2</span> <span class="sc">*</span> <span class="dv">3</span>), </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>)),</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> var, </span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(Dim<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">3.2</span>, Dim<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">3.2</span>, <span class="at">label =</span> Variable), </span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"darkred"</span>,</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">3.5</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PCA Biplot (tidyverse)"</span>,</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Individuals and variables in principal component space"</span>,</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"Dim 1 ("</span>, <span class="fu">round</span>(res_pca<span class="sc">$</span>eig[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"%)"</span>),</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Dim 2 ("</span>, <span class="fu">round</span>(res_pca<span class="sc">$</span>eig[<span class="dv">2</span>,<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"%)"</span>)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/pca-biplot-tidyverse-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="コレスポンデンス分析camca" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> コレスポンデンス分析（CA/MCA）</h1>
<p>カテゴリ × カテゴリのクロス集計表を幾何学的に可視化します。多値カテゴリの個票データには <strong>MCA</strong> を用います。</p>
<section id="ca対応分析の例" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="ca対応分析の例"><span class="header-section-number">16.1</span> CA（対応分析）の例</h2>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data for CA</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>df_ca <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">RowCat =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"TypeA"</span>, <span class="st">"TypeB"</span>, <span class="st">"TypeC"</span>), <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>)),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ColCat =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>), <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>))</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>tab_ca <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(<span class="fu">table</span>(df_ca<span class="sc">$</span>RowCat, df_ca<span class="sc">$</span>ColCat))</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display contingency table</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>tab_ca <span class="sc">|&gt;</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Row Category"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Contingency Table for CA"</span>,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Row categories vs Column categories"</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Row Category</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Category"</span>,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Low =</span> <span class="st">"Low"</span>,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Medium =</span> <span class="st">"Medium"</span>,</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">High =</span> <span class="st">"High"</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Column Categories"</span>,</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Low, Medium, High)</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="typxvkpthc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#typxvkpthc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#typxvkpthc thead, #typxvkpthc tbody, #typxvkpthc tfoot, #typxvkpthc tr, #typxvkpthc td, #typxvkpthc th {
  border-style: none;
}

#typxvkpthc p {
  margin: 0;
  padding: 0;
}

#typxvkpthc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#typxvkpthc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#typxvkpthc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#typxvkpthc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#typxvkpthc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#typxvkpthc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#typxvkpthc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#typxvkpthc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#typxvkpthc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#typxvkpthc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#typxvkpthc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#typxvkpthc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#typxvkpthc .gt_spanner_row {
  border-bottom-style: hidden;
}

#typxvkpthc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#typxvkpthc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#typxvkpthc .gt_from_md > :first-child {
  margin-top: 0;
}

#typxvkpthc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#typxvkpthc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#typxvkpthc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#typxvkpthc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#typxvkpthc .gt_row_group_first td {
  border-top-width: 2px;
}

#typxvkpthc .gt_row_group_first th {
  border-top-width: 2px;
}

#typxvkpthc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#typxvkpthc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#typxvkpthc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#typxvkpthc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#typxvkpthc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#typxvkpthc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#typxvkpthc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#typxvkpthc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#typxvkpthc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#typxvkpthc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#typxvkpthc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#typxvkpthc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#typxvkpthc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#typxvkpthc .gt_left {
  text-align: left;
}

#typxvkpthc .gt_center {
  text-align: center;
}

#typxvkpthc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#typxvkpthc .gt_font_normal {
  font-weight: normal;
}

#typxvkpthc .gt_font_bold {
  font-weight: bold;
}

#typxvkpthc .gt_font_italic {
  font-style: italic;
}

#typxvkpthc .gt_super {
  font-size: 65%;
}

#typxvkpthc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#typxvkpthc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#typxvkpthc .gt_indent_1 {
  text-indent: 5px;
}

#typxvkpthc .gt_indent_2 {
  text-indent: 10px;
}

#typxvkpthc .gt_indent_3 {
  text-indent: 15px;
}

#typxvkpthc .gt_indent_4 {
  text-indent: 20px;
}

#typxvkpthc .gt_indent_5 {
  text-indent: 25px;
}

#typxvkpthc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#typxvkpthc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal">Contingency Table for CA</th>
</tr>
<tr class="gt_heading even">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Row categories vs Column categories</th>
</tr>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="Row-Category" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Category</th>
<th colspan="3" id="Column Categories" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Column Categories
</div></th>
</tr>
<tr class="gt_col_headings even">
<th id="Low" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Low</th>
<th id="Medium" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Medium</th>
<th id="High" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">High</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Row Category">TypeA</td>
<td class="gt_row gt_right" headers="Low">18</td>
<td class="gt_row gt_right" headers="Medium">25</td>
<td class="gt_row gt_right" headers="High">10</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Row Category">TypeB</td>
<td class="gt_row gt_right" headers="Low">7</td>
<td class="gt_row gt_right" headers="Medium">17</td>
<td class="gt_row gt_right" headers="High">5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Row Category">TypeC</td>
<td class="gt_row gt_right" headers="Low">6</td>
<td class="gt_row gt_right" headers="Medium">8</td>
<td class="gt_row gt_right" headers="High">4</td>
</tr>
</tbody>
</table>

</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform CA</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>res_ca <span class="ot">&lt;-</span> <span class="fu">CA</span>(tab_ca, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_ca_biplot</span>(res_ca, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/ca-analysis-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display eigenvalues and contributions</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>ca_eig <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_ca<span class="sc">$</span>eig) <span class="sc">|&gt;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dimension =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Dimension, <span class="fu">everything</span>())</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>ca_eig <span class="sc">|&gt;</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"CA Eigenvalues and Inertia"</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Decomposition of total inertia"</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="sc">-</span>Dimension,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dimension =</span> <span class="st">"Dim"</span>,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">eigenvalue =</span> <span class="st">"Eigenvalue"</span>,</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">percentage of variance</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"% Inertia"</span>,</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Cumulative %"</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Total inertia = chi-square statistic / n"</span>,</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> eigenvalue)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="dtlvqjtkyw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dtlvqjtkyw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dtlvqjtkyw thead, #dtlvqjtkyw tbody, #dtlvqjtkyw tfoot, #dtlvqjtkyw tr, #dtlvqjtkyw td, #dtlvqjtkyw th {
  border-style: none;
}

#dtlvqjtkyw p {
  margin: 0;
  padding: 0;
}

#dtlvqjtkyw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dtlvqjtkyw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dtlvqjtkyw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dtlvqjtkyw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dtlvqjtkyw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dtlvqjtkyw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dtlvqjtkyw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dtlvqjtkyw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dtlvqjtkyw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dtlvqjtkyw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dtlvqjtkyw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dtlvqjtkyw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dtlvqjtkyw .gt_spanner_row {
  border-bottom-style: hidden;
}

#dtlvqjtkyw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dtlvqjtkyw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dtlvqjtkyw .gt_from_md > :first-child {
  margin-top: 0;
}

#dtlvqjtkyw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dtlvqjtkyw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dtlvqjtkyw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dtlvqjtkyw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dtlvqjtkyw .gt_row_group_first td {
  border-top-width: 2px;
}

#dtlvqjtkyw .gt_row_group_first th {
  border-top-width: 2px;
}

#dtlvqjtkyw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dtlvqjtkyw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dtlvqjtkyw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dtlvqjtkyw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dtlvqjtkyw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dtlvqjtkyw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dtlvqjtkyw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dtlvqjtkyw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dtlvqjtkyw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dtlvqjtkyw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dtlvqjtkyw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dtlvqjtkyw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dtlvqjtkyw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dtlvqjtkyw .gt_left {
  text-align: left;
}

#dtlvqjtkyw .gt_center {
  text-align: center;
}

#dtlvqjtkyw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dtlvqjtkyw .gt_font_normal {
  font-weight: normal;
}

#dtlvqjtkyw .gt_font_bold {
  font-weight: bold;
}

#dtlvqjtkyw .gt_font_italic {
  font-style: italic;
}

#dtlvqjtkyw .gt_super {
  font-size: 65%;
}

#dtlvqjtkyw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dtlvqjtkyw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dtlvqjtkyw .gt_indent_1 {
  text-indent: 5px;
}

#dtlvqjtkyw .gt_indent_2 {
  text-indent: 10px;
}

#dtlvqjtkyw .gt_indent_3 {
  text-indent: 15px;
}

#dtlvqjtkyw .gt_indent_4 {
  text-indent: 20px;
}

#dtlvqjtkyw .gt_indent_5 {
  text-indent: 25px;
}

#dtlvqjtkyw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dtlvqjtkyw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal">CA Eigenvalues and Inertia</th>
</tr>
<tr class="gt_heading even">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Decomposition of total inertia</th>
</tr>
<tr class="gt_col_headings header">
<th id="Dimension" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Dim</th>
<th id="eigenvalue" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Eigenvalue<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="percentage-of-variance" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">% Inertia</th>
<th id="cumulative-percentage-of-variance" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Cumulative %</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Dimension">1</td>
<td class="gt_row gt_right" headers="eigenvalue">0.013</td>
<td class="gt_row gt_right" headers="percentage of variance">94.078</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance">94.078</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Dimension">2</td>
<td class="gt_row gt_right" headers="eigenvalue">0.001</td>
<td class="gt_row gt_right" headers="percentage of variance">5.922</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance">100.000</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Total inertia = chi-square statistic / n</td>
</tr>
</tfoot>

</table>

</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Row contributions to Dimension 1</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>contrib_row <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_ca<span class="sc">$</span>row<span class="sc">$</span>contrib[,<span class="dv">1</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>], <span class="at">rownames =</span> <span class="st">"Category"</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Contrib_Dim1 =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Contrib_Dim1))</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>contrib_row <span class="sc">|&gt;</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Row Category Contributions"</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Contribution to Dimension 1 (%)"</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Contrib_Dim1,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Row Category"</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Contrib_Dim1 =</span> <span class="st">"Contribution (%)"</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6f3ff"</span>),</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Contrib_Dim1,</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Contrib_Dim1 <span class="sc">&gt;</span> <span class="dv">30</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="hnumbkmnfy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hnumbkmnfy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hnumbkmnfy thead, #hnumbkmnfy tbody, #hnumbkmnfy tfoot, #hnumbkmnfy tr, #hnumbkmnfy td, #hnumbkmnfy th {
  border-style: none;
}

#hnumbkmnfy p {
  margin: 0;
  padding: 0;
}

#hnumbkmnfy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hnumbkmnfy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hnumbkmnfy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hnumbkmnfy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hnumbkmnfy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hnumbkmnfy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hnumbkmnfy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hnumbkmnfy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hnumbkmnfy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hnumbkmnfy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hnumbkmnfy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hnumbkmnfy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hnumbkmnfy .gt_spanner_row {
  border-bottom-style: hidden;
}

#hnumbkmnfy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hnumbkmnfy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hnumbkmnfy .gt_from_md > :first-child {
  margin-top: 0;
}

#hnumbkmnfy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hnumbkmnfy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hnumbkmnfy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hnumbkmnfy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hnumbkmnfy .gt_row_group_first td {
  border-top-width: 2px;
}

#hnumbkmnfy .gt_row_group_first th {
  border-top-width: 2px;
}

#hnumbkmnfy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hnumbkmnfy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hnumbkmnfy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hnumbkmnfy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hnumbkmnfy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hnumbkmnfy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hnumbkmnfy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hnumbkmnfy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hnumbkmnfy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hnumbkmnfy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hnumbkmnfy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hnumbkmnfy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hnumbkmnfy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hnumbkmnfy .gt_left {
  text-align: left;
}

#hnumbkmnfy .gt_center {
  text-align: center;
}

#hnumbkmnfy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hnumbkmnfy .gt_font_normal {
  font-weight: normal;
}

#hnumbkmnfy .gt_font_bold {
  font-weight: bold;
}

#hnumbkmnfy .gt_font_italic {
  font-style: italic;
}

#hnumbkmnfy .gt_super {
  font-size: 65%;
}

#hnumbkmnfy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hnumbkmnfy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hnumbkmnfy .gt_indent_1 {
  text-indent: 5px;
}

#hnumbkmnfy .gt_indent_2 {
  text-indent: 10px;
}

#hnumbkmnfy .gt_indent_3 {
  text-indent: 15px;
}

#hnumbkmnfy .gt_indent_4 {
  text-indent: 20px;
}

#hnumbkmnfy .gt_indent_5 {
  text-indent: 25px;
}

#hnumbkmnfy .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hnumbkmnfy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="2" class="gt_heading gt_title gt_font_normal">Row Category Contributions</th>
</tr>
<tr class="gt_heading even">
<th colspan="2" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Contribution to Dimension 1 (%)</th>
</tr>
<tr class="gt_col_headings header">
<th id="Category" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Row Category</th>
<th id="Contrib_Dim1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Contribution (%)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Category">TypeB</td>
<td class="gt_row gt_right" headers="Contrib_Dim1" style="background-color: #E6F3FF">69.92</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Category">TypeA</td>
<td class="gt_row gt_right" headers="Contrib_Dim1">15.98</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Category">TypeC</td>
<td class="gt_row gt_right" headers="Contrib_Dim1">14.09</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="mca多重対応分析の例" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="mca多重対応分析の例"><span class="header-section-number">16.2</span> MCA（多重対応分析）の例</h2>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data for MCA</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>df_mca <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q1 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"Maybe"</span>), <span class="dv">150</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q2 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>), <span class="dv">150</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q3 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>), <span class="dv">150</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q4 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Agree"</span>, <span class="st">"Neutral"</span>, <span class="st">"Disagree"</span>), <span class="dv">150</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform MCA</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>res_mca <span class="ot">&lt;-</span> <span class="fu">MCA</span>(df_mca, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizations</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_biplot</span>(res_mca, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/mca-analysis-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual plot colored by Q2</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_ind</span>(res_mca,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.ind =</span> df_mca<span class="sc">$</span>Q2,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">addEllipses =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">"confidence"</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">legend.title =</span> <span class="st">"Q2 Level"</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/mca-analysis-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable categories plot</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_var</span>(res_mca,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.var =</span> <span class="st">"contrib"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/mca-analysis-3.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display eigenvalues</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>mca_eig <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_mca<span class="sc">$</span>eig) <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dimension =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Dimension, <span class="fu">everything</span>())</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>mca_eig <span class="sc">|&gt;</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">|&gt;</span>  <span class="co"># Show top 5 dimensions</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"MCA Eigenvalues and Inertia"</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Top 5 dimensions"</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="sc">-</span>Dimension,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dimension =</span> <span class="st">"Dim"</span>,</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">eigenvalue =</span> <span class="st">"Eigenvalue"</span>,</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">percentage of variance</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"% Inertia"</span>,</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Cumulative %"</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#fff3cd"</span>),</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span>,</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"MCA typically requires more dimensions than CA"</span>,</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span>)</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="dmhodmcgaf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dmhodmcgaf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dmhodmcgaf thead, #dmhodmcgaf tbody, #dmhodmcgaf tfoot, #dmhodmcgaf tr, #dmhodmcgaf td, #dmhodmcgaf th {
  border-style: none;
}

#dmhodmcgaf p {
  margin: 0;
  padding: 0;
}

#dmhodmcgaf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dmhodmcgaf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dmhodmcgaf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dmhodmcgaf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dmhodmcgaf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dmhodmcgaf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dmhodmcgaf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dmhodmcgaf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dmhodmcgaf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dmhodmcgaf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dmhodmcgaf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dmhodmcgaf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dmhodmcgaf .gt_spanner_row {
  border-bottom-style: hidden;
}

#dmhodmcgaf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dmhodmcgaf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dmhodmcgaf .gt_from_md > :first-child {
  margin-top: 0;
}

#dmhodmcgaf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dmhodmcgaf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dmhodmcgaf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dmhodmcgaf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dmhodmcgaf .gt_row_group_first td {
  border-top-width: 2px;
}

#dmhodmcgaf .gt_row_group_first th {
  border-top-width: 2px;
}

#dmhodmcgaf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmhodmcgaf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dmhodmcgaf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dmhodmcgaf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dmhodmcgaf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmhodmcgaf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dmhodmcgaf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dmhodmcgaf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dmhodmcgaf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dmhodmcgaf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dmhodmcgaf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmhodmcgaf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dmhodmcgaf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmhodmcgaf .gt_left {
  text-align: left;
}

#dmhodmcgaf .gt_center {
  text-align: center;
}

#dmhodmcgaf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dmhodmcgaf .gt_font_normal {
  font-weight: normal;
}

#dmhodmcgaf .gt_font_bold {
  font-weight: bold;
}

#dmhodmcgaf .gt_font_italic {
  font-style: italic;
}

#dmhodmcgaf .gt_super {
  font-size: 65%;
}

#dmhodmcgaf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dmhodmcgaf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dmhodmcgaf .gt_indent_1 {
  text-indent: 5px;
}

#dmhodmcgaf .gt_indent_2 {
  text-indent: 10px;
}

#dmhodmcgaf .gt_indent_3 {
  text-indent: 15px;
}

#dmhodmcgaf .gt_indent_4 {
  text-indent: 20px;
}

#dmhodmcgaf .gt_indent_5 {
  text-indent: 25px;
}

#dmhodmcgaf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dmhodmcgaf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal">MCA Eigenvalues and Inertia</th>
</tr>
<tr class="gt_heading even">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Top 5 dimensions</th>
</tr>
<tr class="gt_col_headings header">
<th id="Dimension" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Dim</th>
<th id="eigenvalue" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Eigenvalue</th>
<th id="percentage-of-variance" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">% Inertia</th>
<th id="cumulative-percentage-of-variance" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Cumulative %<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Dimension">1</td>
<td class="gt_row gt_right" headers="eigenvalue">0.334</td>
<td class="gt_row gt_right" headers="percentage of variance">14.842</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance" style="background-color: #FFF3CD">14.842</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Dimension">2</td>
<td class="gt_row gt_right" headers="eigenvalue">0.318</td>
<td class="gt_row gt_right" headers="percentage of variance">14.144</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance" style="background-color: #FFF3CD">28.986</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Dimension">3</td>
<td class="gt_row gt_right" headers="eigenvalue">0.310</td>
<td class="gt_row gt_right" headers="percentage of variance">13.767</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance">42.753</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Dimension">4</td>
<td class="gt_row gt_right" headers="eigenvalue">0.269</td>
<td class="gt_row gt_right" headers="percentage of variance">11.934</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance">54.687</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Dimension">5</td>
<td class="gt_row gt_right" headers="eigenvalue">0.247</td>
<td class="gt_row gt_right" headers="percentage of variance">10.996</td>
<td class="gt_row gt_right" headers="cumulative percentage of variance">65.683</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> MCA typically requires more dimensions than CA</td>
</tr>
</tfoot>

</table>

</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable contributions</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>var_contrib <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_mca<span class="sc">$</span>var<span class="sc">$</span>contrib[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">rownames =</span> <span class="st">"Category"</span>) <span class="sc">|&gt;</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Dim1 =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">Dim2 =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Dim1)) <span class="sc">|&gt;</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)  <span class="co"># Top 10 categories</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>var_contrib <span class="sc">|&gt;</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"MCA Variable Category Contributions"</span>,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Top 10 categories by Dimension 1 contribution"</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Dim1, Dim2),</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Category"</span>,</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dim1 =</span> <span class="st">"Dim 1 (%)"</span>,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dim2 =</span> <span class="st">"Dim 2 (%)"</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6f3ff"</span>),</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Dim1,</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Dim1 <span class="sc">&gt;</span> <span class="dv">10</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="mzzqwufjmf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mzzqwufjmf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mzzqwufjmf thead, #mzzqwufjmf tbody, #mzzqwufjmf tfoot, #mzzqwufjmf tr, #mzzqwufjmf td, #mzzqwufjmf th {
  border-style: none;
}

#mzzqwufjmf p {
  margin: 0;
  padding: 0;
}

#mzzqwufjmf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mzzqwufjmf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mzzqwufjmf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mzzqwufjmf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mzzqwufjmf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mzzqwufjmf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mzzqwufjmf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mzzqwufjmf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mzzqwufjmf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mzzqwufjmf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mzzqwufjmf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mzzqwufjmf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mzzqwufjmf .gt_spanner_row {
  border-bottom-style: hidden;
}

#mzzqwufjmf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mzzqwufjmf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mzzqwufjmf .gt_from_md > :first-child {
  margin-top: 0;
}

#mzzqwufjmf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mzzqwufjmf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mzzqwufjmf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mzzqwufjmf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mzzqwufjmf .gt_row_group_first td {
  border-top-width: 2px;
}

#mzzqwufjmf .gt_row_group_first th {
  border-top-width: 2px;
}

#mzzqwufjmf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mzzqwufjmf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mzzqwufjmf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mzzqwufjmf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mzzqwufjmf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mzzqwufjmf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mzzqwufjmf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mzzqwufjmf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mzzqwufjmf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mzzqwufjmf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mzzqwufjmf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mzzqwufjmf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mzzqwufjmf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mzzqwufjmf .gt_left {
  text-align: left;
}

#mzzqwufjmf .gt_center {
  text-align: center;
}

#mzzqwufjmf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mzzqwufjmf .gt_font_normal {
  font-weight: normal;
}

#mzzqwufjmf .gt_font_bold {
  font-weight: bold;
}

#mzzqwufjmf .gt_font_italic {
  font-style: italic;
}

#mzzqwufjmf .gt_super {
  font-size: 65%;
}

#mzzqwufjmf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mzzqwufjmf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mzzqwufjmf .gt_indent_1 {
  text-indent: 5px;
}

#mzzqwufjmf .gt_indent_2 {
  text-indent: 10px;
}

#mzzqwufjmf .gt_indent_3 {
  text-indent: 15px;
}

#mzzqwufjmf .gt_indent_4 {
  text-indent: 20px;
}

#mzzqwufjmf .gt_indent_5 {
  text-indent: 25px;
}

#mzzqwufjmf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mzzqwufjmf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="3" class="gt_heading gt_title gt_font_normal">MCA Variable Category Contributions</th>
</tr>
<tr class="gt_heading even">
<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Top 10 categories by Dimension 1 contribution</th>
</tr>
<tr class="gt_col_headings header">
<th id="Category" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Category</th>
<th id="Dim1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Dim 1 (%)</th>
<th id="Dim2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Dim 2 (%)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Category">High</td>
<td class="gt_row gt_right" headers="Dim1" style="background-color: #E6F3FF">21.46</td>
<td class="gt_row gt_right" headers="Dim2">3.19</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Category">Maybe</td>
<td class="gt_row gt_right" headers="Dim1" style="background-color: #E6F3FF">16.25</td>
<td class="gt_row gt_right" headers="Dim2">2.09</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Category">Low</td>
<td class="gt_row gt_right" headers="Dim1" style="background-color: #E6F3FF">10.07</td>
<td class="gt_row gt_right" headers="Dim2">0.34</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Category">Neutral</td>
<td class="gt_row gt_right" headers="Dim1">9.16</td>
<td class="gt_row gt_right" headers="Dim2">1.82</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Category">No</td>
<td class="gt_row gt_right" headers="Dim1">9.13</td>
<td class="gt_row gt_right" headers="Dim2">10.32</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Category">Agree</td>
<td class="gt_row gt_right" headers="Dim1">8.22</td>
<td class="gt_row gt_right" headers="Dim2">0.08</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Category">A</td>
<td class="gt_row gt_right" headers="Dim1">6.84</td>
<td class="gt_row gt_right" headers="Dim2">27.27</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Category">C</td>
<td class="gt_row gt_right" headers="Dim1">6.15</td>
<td class="gt_row gt_right" headers="Dim2">1.93</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Category">D</td>
<td class="gt_row gt_right" headers="Dim1">5.63</td>
<td class="gt_row gt_right" headers="Dim2">21.01</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Category">B</td>
<td class="gt_row gt_right" headers="Dim1">5.33</td>
<td class="gt_row gt_right" headers="Dim2">1.01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="tidyverseスタイルでの可視化" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="tidyverseスタイルでの可視化"><span class="header-section-number">16.3</span> tidyverseスタイルでの可視化</h2>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CA biplot with tidyverse</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>row_coords <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_ca<span class="sc">$</span>row<span class="sc">$</span>coord, <span class="at">rownames =</span> <span class="st">"RowCategory"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>col_coords <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_ca<span class="sc">$</span>col<span class="sc">$</span>coord, <span class="at">rownames =</span> <span class="st">"ColCategory"</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined plot</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> row_coords, </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>), </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> row_coords, </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>, <span class="at">label =</span> RowCategory), </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> col_coords, </span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>), </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> col_coords, </span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>, <span class="at">label =</span> ColCategory), </span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"CA Biplot (tidyverse style)"</span>,</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Blue triangles: row categories, Red circles: column categories"</span>,</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"Dim 1 ("</span>, <span class="fu">round</span>(res_ca<span class="sc">$</span>eig[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"%)"</span>),</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Dim 2 ("</span>, <span class="fu">round</span>(res_ca<span class="sc">$</span>eig[<span class="dv">2</span>,<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"%)"</span>)) <span class="sc">+</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>)</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/ca-mca-tidyverse-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MCA biplot with tidyverse</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>ind_coords <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_mca<span class="sc">$</span>ind<span class="sc">$</span>coord[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]) <span class="sc">|&gt;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Q2 =</span> df_mca<span class="sc">$</span>Q2)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>var_coords <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_mca<span class="sc">$</span>var<span class="sc">$</span>coord[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">rownames =</span> <span class="st">"Variable"</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># MCA biplot</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> ind_coords, </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>, <span class="at">color =</span> Q2), </span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> var_coords, </span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>), </span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> var_coords, </span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>, <span class="at">label =</span> Variable), </span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MCA Biplot (tidyverse style)"</span>,</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Points: individuals colored by Q2, Squares: variable categories"</span>,</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"Dim 1 ("</span>, <span class="fu">round</span>(res_mca<span class="sc">$</span>eig[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"%)"</span>),</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Dim 2 ("</span>, <span class="fu">round</span>(res_mca<span class="sc">$</span>eig[<span class="dv">2</span>,<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"%)"</span>)) <span class="sc">+</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>)) <span class="sc">+</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/ca-mca-tidyverse-2.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="多次元尺度法mds" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> 多次元尺度法（MDS）</h1>
<p>計量（距離そのものを近似）/ 非計量（順位距離を近似）の 2 系統。</p>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create distance matrix from iris data</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>dist_mat <span class="ot">&lt;-</span> <span class="fu">dist</span>(x)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Classical MDS</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>fit_cmd <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(dist_mat, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">eig =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coordinates and create data frame</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>cmd_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(fit_cmd<span class="sc">$</span>points) <span class="sc">|&gt;</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"Dim1"</span>,<span class="st">"Dim2"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species =</span> iris<span class="sc">$</span>Species)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display eigenvalues for classical MDS</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>cmd_eig_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Dimension =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(fit_cmd<span class="sc">$</span>eig),</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Eigenvalue =</span> fit_cmd<span class="sc">$</span>eig,</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Proportion =</span> fit_cmd<span class="sc">$</span>eig <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">abs</span>(fit_cmd<span class="sc">$</span>eig[fit_cmd<span class="sc">$</span>eig <span class="sc">&gt;</span> <span class="dv">0</span>])),</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cumulative =</span> <span class="fu">cumsum</span>(fit_cmd<span class="sc">$</span>eig <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">abs</span>(fit_cmd<span class="sc">$</span>eig[fit_cmd<span class="sc">$</span>eig <span class="sc">&gt;</span> <span class="dv">0</span>])))</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>cmd_eig_df <span class="sc">|&gt;</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Classical MDS Eigenvalues"</span>,</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Iris dataset distance decomposition"</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Eigenvalue, Proportion, Cumulative),</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dimension =</span> <span class="st">"Dim"</span>,</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Eigenvalue =</span> <span class="st">"Eigenvalue"</span>,</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Proportion =</span> <span class="st">"Proportion"</span>,</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cumulative =</span> <span class="st">"Cumulative"</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6ffe6"</span>),</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Eigenvalue,</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Eigenvalue <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Negative eigenvalues indicate non-Euclidean distances"</span>,</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Eigenvalue,</span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Eigenvalue <span class="sc">&lt;</span> <span class="dv">0</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ihapvbhnlz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ihapvbhnlz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ihapvbhnlz thead, #ihapvbhnlz tbody, #ihapvbhnlz tfoot, #ihapvbhnlz tr, #ihapvbhnlz td, #ihapvbhnlz th {
  border-style: none;
}

#ihapvbhnlz p {
  margin: 0;
  padding: 0;
}

#ihapvbhnlz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ihapvbhnlz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ihapvbhnlz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ihapvbhnlz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ihapvbhnlz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ihapvbhnlz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ihapvbhnlz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ihapvbhnlz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ihapvbhnlz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ihapvbhnlz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ihapvbhnlz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ihapvbhnlz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ihapvbhnlz .gt_spanner_row {
  border-bottom-style: hidden;
}

#ihapvbhnlz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ihapvbhnlz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ihapvbhnlz .gt_from_md > :first-child {
  margin-top: 0;
}

#ihapvbhnlz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ihapvbhnlz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ihapvbhnlz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ihapvbhnlz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ihapvbhnlz .gt_row_group_first td {
  border-top-width: 2px;
}

#ihapvbhnlz .gt_row_group_first th {
  border-top-width: 2px;
}

#ihapvbhnlz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ihapvbhnlz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ihapvbhnlz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ihapvbhnlz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ihapvbhnlz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ihapvbhnlz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ihapvbhnlz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ihapvbhnlz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ihapvbhnlz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ihapvbhnlz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ihapvbhnlz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ihapvbhnlz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ihapvbhnlz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ihapvbhnlz .gt_left {
  text-align: left;
}

#ihapvbhnlz .gt_center {
  text-align: center;
}

#ihapvbhnlz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ihapvbhnlz .gt_font_normal {
  font-weight: normal;
}

#ihapvbhnlz .gt_font_bold {
  font-weight: bold;
}

#ihapvbhnlz .gt_font_italic {
  font-style: italic;
}

#ihapvbhnlz .gt_super {
  font-size: 65%;
}

#ihapvbhnlz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ihapvbhnlz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ihapvbhnlz .gt_indent_1 {
  text-indent: 5px;
}

#ihapvbhnlz .gt_indent_2 {
  text-indent: 10px;
}

#ihapvbhnlz .gt_indent_3 {
  text-indent: 15px;
}

#ihapvbhnlz .gt_indent_4 {
  text-indent: 20px;
}

#ihapvbhnlz .gt_indent_5 {
  text-indent: 25px;
}

#ihapvbhnlz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ihapvbhnlz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal">Classical MDS Eigenvalues</th>
</tr>
<tr class="gt_heading even">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Iris dataset distance decomposition</th>
</tr>
<tr class="gt_col_headings header">
<th id="Dimension" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Dim</th>
<th id="Eigenvalue" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Eigenvalue</th>
<th id="Proportion" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Proportion</th>
<th id="Cumulative" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Cumulative</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Dimension">1</td>
<td class="gt_row gt_right" headers="Eigenvalue" style="background-color: #E6FFE6">630.008</td>
<td class="gt_row gt_right" headers="Proportion">0.925</td>
<td class="gt_row gt_right" headers="Cumulative">0.925</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Dimension">2</td>
<td class="gt_row gt_right" headers="Eigenvalue" style="background-color: #E6FFE6">36.158</td>
<td class="gt_row gt_right" headers="Proportion">0.053</td>
<td class="gt_row gt_right" headers="Cumulative">0.978</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Dimension">3</td>
<td class="gt_row gt_right" headers="Eigenvalue" style="background-color: #E6FFE6">11.653</td>
<td class="gt_row gt_right" headers="Proportion">0.017</td>
<td class="gt_row gt_right" headers="Cumulative">0.995</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Dimension">4</td>
<td class="gt_row gt_right" headers="Eigenvalue" style="background-color: #E6FFE6">3.551</td>
<td class="gt_row gt_right" headers="Proportion">0.005</td>
<td class="gt_row gt_right" headers="Cumulative">1.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Dimension">5</td>
<td class="gt_row gt_right" headers="Eigenvalue" style="background-color: #E6FFE6">0.000</td>
<td class="gt_row gt_right" headers="Proportion">0.000</td>
<td class="gt_row gt_right" headers="Cumulative">1.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Dimension">6</td>
<td class="gt_row gt_right" headers="Eigenvalue" style="background-color: #E6FFE6">0.000</td>
<td class="gt_row gt_right" headers="Proportion">0.000</td>
<td class="gt_row gt_right" headers="Cumulative">1.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Dimension">7</td>
<td class="gt_row gt_right" headers="Eigenvalue" style="background-color: #E6FFE6">0.000</td>
<td class="gt_row gt_right" headers="Proportion">0.000</td>
<td class="gt_row gt_right" headers="Cumulative">1.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Dimension">8</td>
<td class="gt_row gt_right" headers="Eigenvalue" style="background-color: #E6FFE6">0.000</td>
<td class="gt_row gt_right" headers="Proportion">0.000</td>
<td class="gt_row gt_right" headers="Cumulative">1.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Dimension">9</td>
<td class="gt_row gt_right" headers="Eigenvalue" style="background-color: #E6FFE6">0.000</td>
<td class="gt_row gt_right" headers="Proportion">0.000</td>
<td class="gt_row gt_right" headers="Cumulative">1.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Dimension">10</td>
<td class="gt_row gt_right" headers="Eigenvalue" style="background-color: #E6FFE6">0.000</td>
<td class="gt_row gt_right" headers="Proportion">0.000</td>
<td class="gt_row gt_right" headers="Cumulative">1.000</td>
</tr>
</tbody>
</table>

</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize classical MDS</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cmd_df, <span class="fu">aes</span>(Dim1, Dim2, <span class="at">color =</span> Species)) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Classical MDS (cmdscale)"</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"2D representation of 4D iris measurements"</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Dimension 1"</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Dimension 2"</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/mds-analysis-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-metric MDS</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>fit_nmds <span class="ot">&lt;-</span> smacof<span class="sc">::</span><span class="fu">mds</span>(dist_mat, <span class="at">type =</span> <span class="st">"ordinal"</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coordinates</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>mds_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(fit_nmds<span class="sc">$</span>conf) <span class="sc">|&gt;</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"Dim1"</span>,<span class="st">"Dim2"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species =</span> iris<span class="sc">$</span>Species)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize non-metric MDS</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mds_df, <span class="fu">aes</span>(Dim1, Dim2, <span class="at">color =</span> Species)) <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Non-metric MDS (smacof)"</span>,</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Preserves rank order of distances, Stress ="</span>, <span class="fu">round</span>(fit_nmds<span class="sc">$</span>stress, <span class="dv">3</span>)),</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Dimension 1"</span>,</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Dimension 2"</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>)</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/mds-analysis-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display stress and GOF statistics</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation between original and MDS distances</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>mds_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(fit_nmds<span class="sc">$</span>conf)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>dist_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">as.vector</span>(dist_mat), <span class="fu">as.vector</span>(mds_dist))</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create GOF statistics table</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Stress-1"</span>, <span class="st">"Correlation"</span>, <span class="st">"N Objects"</span>, <span class="st">"N Dims"</span>),</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    fit_nmds<span class="sc">$</span>stress,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    dist_cor,</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nrow</span>(fit_nmds<span class="sc">$</span>conf),</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ncol</span>(fit_nmds<span class="sc">$</span>conf)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Non-metric MDS Goodness of Fit"</span>,</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Stress and fit statistics"</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Value,</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> Metric <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Stress-1"</span>, <span class="st">"Correlation"</span>),</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Value,</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> Metric <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"N Objects"</span>, <span class="st">"N Dims"</span>),</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">0</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Metric =</span> <span class="st">"Measure"</span>,</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="st">"Value"</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6ffe6"</span>),</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Value,</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Metric <span class="sc">==</span> <span class="st">"Stress-1"</span> <span class="sc">&amp;</span> Value <span class="sc">&lt;</span> <span class="fl">0.1</span></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6f3ff"</span>),</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Value,</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Metric <span class="sc">==</span> <span class="st">"Correlation"</span> <span class="sc">&amp;</span> Value <span class="sc">&gt;</span> <span class="fl">0.9</span></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Stress &lt; 0.1 indicates good fit"</span>,</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Value,</span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Metric <span class="sc">==</span> <span class="st">"Stress-1"</span></span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Higher correlation indicates better preservation of distances"</span>,</span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Value,</span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Metric <span class="sc">==</span> <span class="st">"Correlation"</span></span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="hihyitachb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hihyitachb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hihyitachb thead, #hihyitachb tbody, #hihyitachb tfoot, #hihyitachb tr, #hihyitachb td, #hihyitachb th {
  border-style: none;
}

#hihyitachb p {
  margin: 0;
  padding: 0;
}

#hihyitachb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hihyitachb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hihyitachb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hihyitachb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hihyitachb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hihyitachb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hihyitachb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hihyitachb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hihyitachb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hihyitachb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hihyitachb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hihyitachb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hihyitachb .gt_spanner_row {
  border-bottom-style: hidden;
}

#hihyitachb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hihyitachb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hihyitachb .gt_from_md > :first-child {
  margin-top: 0;
}

#hihyitachb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hihyitachb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hihyitachb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hihyitachb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hihyitachb .gt_row_group_first td {
  border-top-width: 2px;
}

#hihyitachb .gt_row_group_first th {
  border-top-width: 2px;
}

#hihyitachb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hihyitachb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hihyitachb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hihyitachb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hihyitachb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hihyitachb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hihyitachb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hihyitachb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hihyitachb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hihyitachb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hihyitachb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hihyitachb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hihyitachb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hihyitachb .gt_left {
  text-align: left;
}

#hihyitachb .gt_center {
  text-align: center;
}

#hihyitachb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hihyitachb .gt_font_normal {
  font-weight: normal;
}

#hihyitachb .gt_font_bold {
  font-weight: bold;
}

#hihyitachb .gt_font_italic {
  font-style: italic;
}

#hihyitachb .gt_super {
  font-size: 65%;
}

#hihyitachb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hihyitachb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hihyitachb .gt_indent_1 {
  text-indent: 5px;
}

#hihyitachb .gt_indent_2 {
  text-indent: 10px;
}

#hihyitachb .gt_indent_3 {
  text-indent: 15px;
}

#hihyitachb .gt_indent_4 {
  text-indent: 20px;
}

#hihyitachb .gt_indent_5 {
  text-indent: 25px;
}

#hihyitachb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hihyitachb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="2" class="gt_heading gt_title gt_font_normal">Non-metric MDS Goodness of Fit</th>
</tr>
<tr class="gt_heading even">
<th colspan="2" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Stress and fit statistics</th>
</tr>
<tr class="gt_col_headings header">
<th id="Metric" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Measure</th>
<th id="Value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Value</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Metric">Stress-1</td>
<td class="gt_row gt_right" headers="Value" style="background-color: #E6FFE6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span>&nbsp;0.026</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Metric">Correlation</td>
<td class="gt_row gt_right" headers="Value" style="background-color: #E6F3FF"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span>&nbsp;0.999</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Metric">N Objects</td>
<td class="gt_row gt_right" headers="Value">150</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Metric">N Dims</td>
<td class="gt_row gt_right" headers="Value">2</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Stress &lt; 0.1 indicates good fit</td>
</tr>
<tr class="even">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Higher correlation indicates better preservation of distances</td>
</tr>
</tfoot>

</table>

</div>
</div>
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shepard diagram</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_nmds, <span class="at">plot.type =</span> <span class="st">"Shepard"</span>, <span class="at">main =</span> <span class="st">"Shepard Diagram"</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法_files/figure-html/mds-analysis-3.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<p><strong>実務上のヒント</strong>: 次元削減や潜在変数モデルは「可視化・表の整形」とセットで共有すると意思決定が速くなります。推定→可視化（散布図・ヒートマップ）→要約表（gt）→解釈メモ、の順でノート化しておくと再現性が高まります。また、<strong>前処理（標準化・欠損処理・カテゴリ結合）</strong>の妥当性が結論を大きく左右します。</p>
</section>
<section id="参考" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> 参考</h1>
<ul>
<li>カテゴリカルデータの相関（ポリコリック/ポリシリアル/テトラコリック など）
<ul>
<li>https://norimune.net/673</li>
</ul></li>
<li>Confirmatory Factor Analysis（入門）
<ul>
<li>https://bookdown.org/bean_jerry/using_r_for_social_work_research/confirmatory-factor-analysis.html</li>
</ul></li>
<li>PCA 解説と実装（Qiita）
<ul>
<li>https://qiita.com/zumax/items/d92342c3da94020eedec</li>
</ul></li>
<li>CA の実装ガイド
<ul>
<li>http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/113-ca-correspondence-analysis-in-r-essentials/</li>
</ul></li>
<li>Factoshiny（FactoMineR の GUI）
<ul>
<li>http://factominer.free.fr/graphs/factoshiny.html</li>
</ul></li>
<li>多次元尺度法の教材
<ul>
<li>https://pages.mtu.edu/~shanem/psy5220/daily/Day16/MDS.html#multi-dimensional-scaling</li>
</ul></li>
</ul>
</section>
<section id="セッション情報" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> セッション情報</h1>
<div class="cell">
<details class="code-fold">
<summary>コードを表示</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.0 (2025-04-11)
Platform: aarch64-apple-darwin20
Running under: macOS Sequoia 15.6

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Asia/Tokyo
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] broom_1.0.9          scales_1.4.0         gt_1.0.0            
 [4] smacof_2.1-7         e1071_1.7-16         colorspace_2.1-1    
 [7] plotrix_3.8-4        factoextra_1.0.7     FactoMineR_2.12     
[10] lavaanPlot_0.8.1     semPlot_1.1.6        lavaan_0.6-19       
[13] sjPlot_2.9.0         GPArotation_2025.3-1 psych_2.5.6         
[16] lubridate_1.9.4      forcats_1.0.0        stringr_1.5.1       
[19] dplyr_1.1.4          purrr_1.1.0          readr_2.1.5         
[22] tidyr_1.3.1          tibble_3.3.0         ggplot2_3.5.2       
[25] tidyverse_2.0.0     

loaded via a namespace (and not attached):
  [1] splines_4.5.0        XML_3.99-0.18        rpart_4.1.24        
  [4] lifecycle_1.0.4      rstatix_0.7.2        Rdpack_2.6.4        
  [7] doParallel_1.0.17    lattice_0.22-7       MASS_7.3-65         
 [10] insight_1.3.1        flashClust_1.01-2    rockchalk_1.8.157   
 [13] backports_1.5.0      magrittr_2.0.3       openxlsx_4.2.8      
 [16] Hmisc_5.2-3          sass_0.4.10          rmarkdown_2.29      
 [19] yaml_2.3.10          qgraph_1.9.8         zip_2.3.3           
 [22] pbapply_1.7-4        minqa_1.2.8          RColorBrewer_1.1-3  
 [25] abind_1.4-8          quadprog_1.5-8       nnet_7.3-20         
 [28] ggrepel_0.9.6        gdata_3.0.1          ellipse_0.5.0       
 [31] arm_1.14-4           performance_0.15.0   codetools_0.2-20    
 [34] DT_0.33              xml2_1.3.8           tidyselect_1.2.1    
 [37] shape_1.4.6.1        farver_2.1.2         lme4_1.1-37         
 [40] stats4_4.5.0         base64enc_0.1-3      jsonlite_2.0.0      
 [43] mitml_0.4-5          Formula_1.2-5        survival_3.8-3      
 [46] iterators_1.0.14     emmeans_1.11.2       foreach_1.5.2       
 [49] tools_4.5.0          Rcpp_1.1.0           glue_1.8.0          
 [52] mnormt_2.1.1         gridExtra_2.3        pan_1.9             
 [55] xfun_0.52            withr_3.0.2          fastmap_1.2.0       
 [58] boot_1.3-31          digest_0.6.37        mi_1.1              
 [61] timechange_0.3.0     R6_2.6.1             estimability_1.5.1  
 [64] mice_3.18.0          gtools_3.9.5         jpeg_0.1-11         
 [67] weights_1.1.2        DiagrammeR_1.0.11    generics_0.1.4      
 [70] data.table_1.17.8    corpcor_1.6.10       class_7.3-23        
 [73] htmlwidgets_1.6.4    scatterplot3d_0.3-44 pkgconfig_2.0.3     
 [76] sem_3.1-16           gtable_0.3.6         htmltools_0.5.8.1   
 [79] carData_3.0-5        multcompView_0.1-10  leaps_3.2           
 [82] png_0.1-8            wordcloud_2.6        reformulas_0.4.1    
 [85] knitr_1.50           rstudioapi_0.17.1    tzdb_0.5.0          
 [88] reshape2_1.4.4       coda_0.19-4.1        visNetwork_2.1.2    
 [91] checkmate_2.3.2      nlme_3.1-168         nloptr_2.2.1        
 [94] proxy_0.4-27         sjlabelled_1.2.0     parallel_4.5.0      
 [97] foreign_0.8-90       pillar_1.11.0        grid_4.5.0          
[100] vctrs_0.6.5          ggpubr_0.6.1         car_3.1-3           
[103] OpenMx_2.22.7        jomo_2.7-6           xtable_1.8-4        
[106] cluster_2.1.8.1      htmlTable_2.4.3      evaluate_1.0.4      
[109] pbivnorm_0.6.0       mvtnorm_1.3-3        cli_3.6.5           
[112] kutils_1.73          compiler_4.5.0       rlang_1.1.6         
[115] ggsignif_0.6.4       labeling_0.4.3       fdrtool_1.2.18      
[118] plyr_1.8.9           sjmisc_2.8.11        stringi_1.8.7       
[121] nnls_1.6             lisrelToR_0.3        glmnet_4.1-10       
[124] pacman_0.5.1         Matrix_1.7-3         hms_1.1.3           
[127] glasso_1.11          rbibutils_2.3        igraph_2.1.4        
[130] RcppParallel_5.1.10  polynom_1.4-1       </code></pre>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "コピーしました");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "コピーしました");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./8_ROC曲線_ツリーモデル.html" class="pagination-link" aria-label="ROC曲線・ツリーモデル">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">ROC曲線・ツリーモデル</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./10_一般化可能性理論.html" class="pagination-link" aria-label="一般化可能性理論">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">一般化可能性理論</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">ソースコード</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb47" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "9_因子分析_主成分分析_コレスポンデンス分析_多次元尺度法"</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "小室竜也"</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "目次"</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: journal</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co">    fontsize: 1.1em</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="co">    linestretch: 1.8</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="co">    mainfont: "Noto Serif JP"</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="an">lang:</span><span class="co"> ja</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="in">/* journalテーマ用のアカデミックなカスタムスタイル */</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="in">body {</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="in">  font-family: 'Noto Serif JP', 'Times New Roman', serif;</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a><span class="in">  color: #2c3e50;</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="in">  line-height: 1.8;</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a><span class="in">/* タイトルブロックをジャーナル風に */</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a><span class="in">.quarto-title-banner {</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="in">  background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="in">  border-bottom: 4px double #495057;</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a><span class="in">  padding: 2.5em 2em;</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a><span class="in">  text-align: center;</span></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a><span class="in">.quarto-title-banner .title {</span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a><span class="in">  color: #212529 !important;</span></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 2.2em !important;</span></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a><span class="in">  font-weight: 700;</span></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a><span class="in">  letter-spacing: 0.02em;</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a><span class="in">  text-transform: uppercase;</span></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a><span class="in">  font-family: 'Noto Sans JP', sans-serif;</span></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a><span class="in">/* 見出しのアカデミックスタイル */</span></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a><span class="in">h1 {</span></span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 1.8em;</span></span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a><span class="in">  font-weight: 700;</span></span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a><span class="in">  color: #1a1a1a;</span></span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a><span class="in">  border-bottom: 2px solid #212529;</span></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a><span class="in">  padding-bottom: 0.5em;</span></span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-top: 2em;</span></span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-bottom: 1em;</span></span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a><span class="in">  text-transform: uppercase;</span></span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a><span class="in">  letter-spacing: 0.03em;</span></span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a><span class="in">h2 {</span></span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 1.4em;</span></span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a><span class="in">  font-weight: 600;</span></span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a><span class="in">  color: #343a40;</span></span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-top: 1.5em;</span></span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-bottom: 0.8em;</span></span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a><span class="in">h2:before {</span></span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a><span class="in">  content: "§";</span></span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-right: 0.5em;</span></span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a><span class="in">  color: #6c757d;</span></span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a><span class="in">  font-weight: 400;</span></span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a><span class="in">h3 {</span></span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 1.2em;</span></span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a><span class="in">  font-weight: 600;</span></span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a><span class="in">  color: #495057;</span></span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a><span class="in">  font-style: italic;</span></span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-top: 1.2em;</span></span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-bottom: 0.6em;</span></span>
<span id="cb47-81"><a href="#cb47-81" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb47-82"><a href="#cb47-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a><span class="in">/* テーブルを学術論文風に */</span></span>
<span id="cb47-84"><a href="#cb47-84" aria-hidden="true" tabindex="-1"></a><span class="in">table {</span></span>
<span id="cb47-85"><a href="#cb47-85" aria-hidden="true" tabindex="-1"></a><span class="in">  margin: 2em auto;</span></span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a><span class="in">  border-collapse: collapse;</span></span>
<span id="cb47-87"><a href="#cb47-87" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 0.95em;</span></span>
<span id="cb47-88"><a href="#cb47-88" aria-hidden="true" tabindex="-1"></a><span class="in">  width: 90%;</span></span>
<span id="cb47-89"><a href="#cb47-89" aria-hidden="true" tabindex="-1"></a><span class="in">  border-top: 2px solid #212529;</span></span>
<span id="cb47-90"><a href="#cb47-90" aria-hidden="true" tabindex="-1"></a><span class="in">  border-bottom: 2px solid #212529;</span></span>
<span id="cb47-91"><a href="#cb47-91" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb47-92"><a href="#cb47-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-93"><a href="#cb47-93" aria-hidden="true" tabindex="-1"></a><span class="in">thead {</span></span>
<span id="cb47-94"><a href="#cb47-94" aria-hidden="true" tabindex="-1"></a><span class="in">  background: #f8f9fa;</span></span>
<span id="cb47-95"><a href="#cb47-95" aria-hidden="true" tabindex="-1"></a><span class="in">  border-bottom: 1px solid #212529;</span></span>
<span id="cb47-96"><a href="#cb47-96" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb47-97"><a href="#cb47-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-98"><a href="#cb47-98" aria-hidden="true" tabindex="-1"></a><span class="in">/* コードブロックをシンプルに */</span></span>
<span id="cb47-99"><a href="#cb47-99" aria-hidden="true" tabindex="-1"></a><span class="in">pre {</span></span>
<span id="cb47-100"><a href="#cb47-100" aria-hidden="true" tabindex="-1"></a><span class="in">  background: #f8f9fa !important;</span></span>
<span id="cb47-101"><a href="#cb47-101" aria-hidden="true" tabindex="-1"></a><span class="in">  border: 1px solid #dee2e6;</span></span>
<span id="cb47-102"><a href="#cb47-102" aria-hidden="true" tabindex="-1"></a><span class="in">  border-radius: 0;</span></span>
<span id="cb47-103"><a href="#cb47-103" aria-hidden="true" tabindex="-1"></a><span class="in">  padding: 1em;</span></span>
<span id="cb47-104"><a href="#cb47-104" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 0.9em;</span></span>
<span id="cb47-105"><a href="#cb47-105" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb47-106"><a href="#cb47-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-107"><a href="#cb47-107" aria-hidden="true" tabindex="-1"></a><span class="in">/* 数式を強調 */</span></span>
<span id="cb47-108"><a href="#cb47-108" aria-hidden="true" tabindex="-1"></a><span class="in">.math {</span></span>
<span id="cb47-109"><a href="#cb47-109" aria-hidden="true" tabindex="-1"></a><span class="in">  color: #212529;</span></span>
<span id="cb47-110"><a href="#cb47-110" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 1.05em;</span></span>
<span id="cb47-111"><a href="#cb47-111" aria-hidden="true" tabindex="-1"></a><span class="in">  font-style: italic;</span></span>
<span id="cb47-112"><a href="#cb47-112" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb47-113"><a href="#cb47-113" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb47-114"><a href="#cb47-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-115"><a href="#cb47-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-116"><a href="#cb47-116" aria-hidden="true" tabindex="-1"></a><span class="fu"># はじめに</span></span>
<span id="cb47-117"><a href="#cb47-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-118"><a href="#cb47-118" aria-hidden="true" tabindex="-1"></a>本ドキュメントは、**探索的因子分析 (EFA)**、**確認的因子分析 (CFA)**、**主成分分析 (PCA)**、**コレスポンデンス分析 (CA/MCA)**、および**多次元尺度法 (MDS)** を、R による実行例とともに体系的にまとめた実践ガイドです。教育・心理領域のアンケートデータやテストデータを対象に、モデルの考え方、実装、そして解釈の要点を一貫した流れで示します。</span>
<span id="cb47-119"><a href="#cb47-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-120"><a href="#cb47-120" aria-hidden="true" tabindex="-1"></a>依存パッケージは適宜 <span class="in">`install.packages()`</span> で導入してください。</span>
<span id="cb47-121"><a href="#cb47-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-124"><a href="#cb47-124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-125"><a href="#cb47-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb47-126"><a href="#cb47-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb47-127"><a href="#cb47-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb47-128"><a href="#cb47-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-129"><a href="#cb47-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb47-130"><a href="#cb47-130" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb47-131"><a href="#cb47-131" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb47-132"><a href="#cb47-132" aria-hidden="true" tabindex="-1"></a>  tidyverse,        <span class="co"># Data manipulation and visualization</span></span>
<span id="cb47-133"><a href="#cb47-133" aria-hidden="true" tabindex="-1"></a>  psych,            <span class="co"># EFA and reliability analysis</span></span>
<span id="cb47-134"><a href="#cb47-134" aria-hidden="true" tabindex="-1"></a>  GPArotation,      <span class="co"># Factor rotations</span></span>
<span id="cb47-135"><a href="#cb47-135" aria-hidden="true" tabindex="-1"></a>  sjPlot,           <span class="co"># EFA table formatting</span></span>
<span id="cb47-136"><a href="#cb47-136" aria-hidden="true" tabindex="-1"></a>  lavaan,           <span class="co"># CFA/SEM</span></span>
<span id="cb47-137"><a href="#cb47-137" aria-hidden="true" tabindex="-1"></a>  semPlot,          <span class="co"># Path diagrams</span></span>
<span id="cb47-138"><a href="#cb47-138" aria-hidden="true" tabindex="-1"></a>  lavaanPlot,       <span class="co"># Alternative path diagrams</span></span>
<span id="cb47-139"><a href="#cb47-139" aria-hidden="true" tabindex="-1"></a>  FactoMineR,       <span class="co"># PCA, CA, MCA</span></span>
<span id="cb47-140"><a href="#cb47-140" aria-hidden="true" tabindex="-1"></a>  factoextra,       <span class="co"># Visualization support</span></span>
<span id="cb47-141"><a href="#cb47-141" aria-hidden="true" tabindex="-1"></a>  smacof,           <span class="co"># Non-metric MDS</span></span>
<span id="cb47-142"><a href="#cb47-142" aria-hidden="true" tabindex="-1"></a>  gt,               <span class="co"># Table formatting</span></span>
<span id="cb47-143"><a href="#cb47-143" aria-hidden="true" tabindex="-1"></a>  scales,           <span class="co"># Axis labeling</span></span>
<span id="cb47-144"><a href="#cb47-144" aria-hidden="true" tabindex="-1"></a>  broom             <span class="co"># Model output tidying</span></span>
<span id="cb47-145"><a href="#cb47-145" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-146"><a href="#cb47-146" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb47-147"><a href="#cb47-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-148"><a href="#cb47-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-149"><a href="#cb47-149" aria-hidden="true" tabindex="-1"></a><span class="fu"># 探索的因子分析（EFA）</span></span>
<span id="cb47-150"><a href="#cb47-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-151"><a href="#cb47-151" aria-hidden="true" tabindex="-1"></a><span class="fu">## コンセプトと手順</span></span>
<span id="cb47-152"><a href="#cb47-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-153"><a href="#cb47-153" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**独自性** = 特殊分散 + 誤差分散、**共通性** = 1 − 独自性（= 因子負荷の二乗和）</span>
<span id="cb47-154"><a href="#cb47-154" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>目的は、相関行列を**因子**に分解し、**共通分散**の説明を最大化すること</span>
<span id="cb47-155"><a href="#cb47-155" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>一般的な手順: **(1) 因子数の決定** → **(2) 因子負荷の推定** → **(3) 回転** → **(4) 解釈**</span>
<span id="cb47-156"><a href="#cb47-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-157"><a href="#cb47-157" aria-hidden="true" tabindex="-1"></a>EFAは観測変数間の相関を「共通因子 + 独自性」に分解するモデルです。推定の目的は、相関行列のうち**共通分散**をできるだけ少ない因子で説明することにあります。因子数は「過少（情報の取りこぼし）」と「過多（過適合）」のトレードオフで、スクリープロット・平行分析・情報量基準（BICなど）を**総合判断**するのが実務的です。回転は**解釈可能性の向上**が目的で、斜交回転（因子間相関を許容）をデフォルトとし、理論的に独立と考える場合のみ直交回転を検討します。</span>
<span id="cb47-158"><a href="#cb47-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-159"><a href="#cb47-159" aria-hidden="true" tabindex="-1"></a><span class="fu">### データ例（シミュレーション）</span></span>
<span id="cb47-160"><a href="#cb47-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-163"><a href="#cb47-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-164"><a href="#cb47-164" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: generate-efa-data</span></span>
<span id="cb47-165"><a href="#cb47-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-166"><a href="#cb47-166" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameters for data generation</span></span>
<span id="cb47-167"><a href="#cb47-167" aria-hidden="true" tabindex="-1"></a>n_respondents <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb47-168"><a href="#cb47-168" aria-hidden="true" tabindex="-1"></a>n_items <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb47-169"><a href="#cb47-169" aria-hidden="true" tabindex="-1"></a>n_factors <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb47-170"><a href="#cb47-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-171"><a href="#cb47-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random factor loadings and scores</span></span>
<span id="cb47-172"><a href="#cb47-172" aria-hidden="true" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n_items <span class="sc">*</span> n_factors), <span class="at">nrow =</span> n_items, <span class="at">ncol =</span> n_factors)</span>
<span id="cb47-173"><a href="#cb47-173" aria-hidden="true" tabindex="-1"></a>factor_scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n_respondents <span class="sc">*</span> n_factors), <span class="at">nrow =</span> n_respondents, <span class="at">ncol =</span> n_factors)</span>
<span id="cb47-174"><a href="#cb47-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-175"><a href="#cb47-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to Likert scale (1-6)</span></span>
<span id="cb47-176"><a href="#cb47-176" aria-hidden="true" tabindex="-1"></a>raw <span class="ot">&lt;-</span> factor_scores <span class="sc">%*%</span> <span class="fu">t</span>(loadings)</span>
<span id="cb47-177"><a href="#cb47-177" aria-hidden="true" tabindex="-1"></a>rng01 <span class="ot">&lt;-</span> <span class="fu">apply</span>(raw, <span class="dv">1</span>, <span class="cf">function</span>(x) (x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)))</span>
<span id="cb47-178"><a href="#cb47-178" aria-hidden="true" tabindex="-1"></a>data_scaled <span class="ot">&lt;-</span> <span class="fu">t</span>(rng01) <span class="sc">*</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb47-179"><a href="#cb47-179" aria-hidden="true" tabindex="-1"></a>round_likert <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">pmin</span>(<span class="fu">pmax</span>(<span class="fu">round</span>(x), <span class="dv">1</span>), <span class="dv">6</span>)</span>
<span id="cb47-180"><a href="#cb47-180" aria-hidden="true" tabindex="-1"></a>survey <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">apply</span>(data_scaled, <span class="dv">2</span>, round_likert))</span>
<span id="cb47-181"><a href="#cb47-181" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(survey) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"V"</span>, <span class="fu">seq_len</span>(<span class="fu">ncol</span>(survey)))</span>
<span id="cb47-182"><a href="#cb47-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-183"><a href="#cb47-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-184"><a href="#cb47-184" aria-hidden="true" tabindex="-1"></a><span class="fu">### 因子数の決定（ガットマン基準・スクリープロット・平行分析）</span></span>
<span id="cb47-185"><a href="#cb47-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-188"><a href="#cb47-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-189"><a href="#cb47-189" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: determine-factors</span></span>
<span id="cb47-190"><a href="#cb47-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-191"><a href="#cb47-191" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate eigenvalues (Guttman criterion: λ &gt; 1)</span></span>
<span id="cb47-192"><a href="#cb47-192" aria-hidden="true" tabindex="-1"></a>eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cor</span>(survey))<span class="sc">$</span>values</span>
<span id="cb47-193"><a href="#cb47-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-194"><a href="#cb47-194" aria-hidden="true" tabindex="-1"></a><span class="co"># Display eigenvalues in gt table</span></span>
<span id="cb47-195"><a href="#cb47-195" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb47-196"><a href="#cb47-196" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(eig),</span>
<span id="cb47-197"><a href="#cb47-197" aria-hidden="true" tabindex="-1"></a>  <span class="at">Eigenvalue =</span> eig,</span>
<span id="cb47-198"><a href="#cb47-198" aria-hidden="true" tabindex="-1"></a>  <span class="at">Proportion =</span> eig <span class="sc">/</span> <span class="fu">sum</span>(eig),</span>
<span id="cb47-199"><a href="#cb47-199" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cumulative =</span> <span class="fu">cumsum</span>(eig <span class="sc">/</span> <span class="fu">sum</span>(eig))</span>
<span id="cb47-200"><a href="#cb47-200" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb47-201"><a href="#cb47-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span>  <span class="co"># Show first 10 components</span></span>
<span id="cb47-202"><a href="#cb47-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-203"><a href="#cb47-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb47-204"><a href="#cb47-204" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Eigenvalues from Correlation Matrix"</span>,</span>
<span id="cb47-205"><a href="#cb47-205" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Components with eigenvalue &gt; 1 should be retained (Kaiser criterion)"</span></span>
<span id="cb47-206"><a href="#cb47-206" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-207"><a href="#cb47-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb47-208"><a href="#cb47-208" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Eigenvalue, Proportion, Cumulative),</span>
<span id="cb47-209"><a href="#cb47-209" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb47-210"><a href="#cb47-210" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-211"><a href="#cb47-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb47-212"><a href="#cb47-212" aria-hidden="true" tabindex="-1"></a>    <span class="at">Component =</span> <span class="st">"Component"</span>,</span>
<span id="cb47-213"><a href="#cb47-213" aria-hidden="true" tabindex="-1"></a>    <span class="at">Eigenvalue =</span> <span class="st">"Eigenvalue"</span>,</span>
<span id="cb47-214"><a href="#cb47-214" aria-hidden="true" tabindex="-1"></a>    <span class="at">Proportion =</span> <span class="st">"Proportion"</span>,</span>
<span id="cb47-215"><a href="#cb47-215" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cumulative =</span> <span class="st">"Cumulative"</span></span>
<span id="cb47-216"><a href="#cb47-216" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-217"><a href="#cb47-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb47-218"><a href="#cb47-218" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(</span>
<span id="cb47-219"><a href="#cb47-219" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6ffe6"</span>),</span>
<span id="cb47-220"><a href="#cb47-220" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>)</span>
<span id="cb47-221"><a href="#cb47-221" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb47-222"><a href="#cb47-222" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb47-223"><a href="#cb47-223" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Eigenvalue,</span>
<span id="cb47-224"><a href="#cb47-224" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Eigenvalue <span class="sc">&gt;</span> <span class="dv">1</span></span>
<span id="cb47-225"><a href="#cb47-225" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-226"><a href="#cb47-226" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-227"><a href="#cb47-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb47-228"><a href="#cb47-228" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Components with eigenvalue &gt; 1 are highlighted"</span>,</span>
<span id="cb47-229"><a href="#cb47-229" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> Eigenvalue)</span>
<span id="cb47-230"><a href="#cb47-230" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-231"><a href="#cb47-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-232"><a href="#cb47-232" aria-hidden="true" tabindex="-1"></a><span class="co"># Scree plot and parallel analysis</span></span>
<span id="cb47-233"><a href="#cb47-233" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">VSS.scree</span>(survey)</span>
<span id="cb47-234"><a href="#cb47-234" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">fa.parallel</span>(survey, <span class="at">fm =</span> <span class="st">"ml"</span>, <span class="at">fa =</span> <span class="st">"pc"</span>, <span class="at">n.iter =</span> <span class="dv">100</span>)</span>
<span id="cb47-235"><a href="#cb47-235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-236"><a href="#cb47-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-237"><a href="#cb47-237" aria-hidden="true" tabindex="-1"></a><span class="fu">#### tidyverseで作るスクリープロット（自作）</span></span>
<span id="cb47-238"><a href="#cb47-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-241"><a href="#cb47-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-242"><a href="#cb47-242" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: scree-plot-tidyverse</span></span>
<span id="cb47-243"><a href="#cb47-243" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb47-244"><a href="#cb47-244" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb47-245"><a href="#cb47-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-246"><a href="#cb47-246" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scree plot data</span></span>
<span id="cb47-247"><a href="#cb47-247" aria-hidden="true" tabindex="-1"></a>eig_vals <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cor</span>(survey))<span class="sc">$</span>values</span>
<span id="cb47-248"><a href="#cb47-248" aria-hidden="true" tabindex="-1"></a>scree_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Component =</span> <span class="fu">seq_along</span>(eig_vals), <span class="at">Eigenvalue =</span> eig_vals)</span>
<span id="cb47-249"><a href="#cb47-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-250"><a href="#cb47-250" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize with ggplot2</span></span>
<span id="cb47-251"><a href="#cb47-251" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(scree_tbl, <span class="fu">aes</span>(Component, Eigenvalue)) <span class="sc">+</span></span>
<span id="cb47-252"><a href="#cb47-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb47-253"><a href="#cb47-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb47-254"><a href="#cb47-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb47-255"><a href="#cb47-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scree_tbl<span class="sc">$</span>Component) <span class="sc">+</span></span>
<span id="cb47-256"><a href="#cb47-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-257"><a href="#cb47-257" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Scree Plot (tidyverse)"</span>,</span>
<span id="cb47-258"><a href="#cb47-258" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Components with eigenvalue &gt; 1 (above red line) are candidates for retention"</span>,</span>
<span id="cb47-259"><a href="#cb47-259" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Eigenvalue"</span></span>
<span id="cb47-260"><a href="#cb47-260" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-261"><a href="#cb47-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb47-262"><a href="#cb47-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb47-263"><a href="#cb47-263" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb47-264"><a href="#cb47-264" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>)</span>
<span id="cb47-265"><a href="#cb47-265" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-266"><a href="#cb47-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-267"><a href="#cb47-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-268"><a href="#cb47-268" aria-hidden="true" tabindex="-1"></a><span class="fu">### 因子負荷の推定と回転</span></span>
<span id="cb47-269"><a href="#cb47-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-272"><a href="#cb47-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-273"><a href="#cb47-273" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: efa-analysis</span></span>
<span id="cb47-274"><a href="#cb47-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-275"><a href="#cb47-275" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit EFA model with promax rotation</span></span>
<span id="cb47-276"><a href="#cb47-276" aria-hidden="true" tabindex="-1"></a>fit_efa <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(survey, <span class="at">nfactors =</span> <span class="dv">4</span>, <span class="at">fm =</span> <span class="st">"ml"</span>, <span class="at">rotate =</span> <span class="st">"promax"</span>)</span>
<span id="cb47-277"><a href="#cb47-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-278"><a href="#cb47-278" aria-hidden="true" tabindex="-1"></a><span class="co"># Display summary</span></span>
<span id="cb47-279"><a href="#cb47-279" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_efa)</span>
<span id="cb47-280"><a href="#cb47-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-281"><a href="#cb47-281" aria-hidden="true" tabindex="-1"></a><span class="co"># Create formatted table with factor loadings</span></span>
<span id="cb47-282"><a href="#cb47-282" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_fa</span>(</span>
<span id="cb47-283"><a href="#cb47-283" aria-hidden="true" tabindex="-1"></a>  survey, </span>
<span id="cb47-284"><a href="#cb47-284" aria-hidden="true" tabindex="-1"></a>  <span class="at">rotation =</span> <span class="st">"promax"</span>, </span>
<span id="cb47-285"><a href="#cb47-285" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"ml"</span>, </span>
<span id="cb47-286"><a href="#cb47-286" aria-hidden="true" tabindex="-1"></a>  <span class="at">nmbr.fctr =</span> <span class="dv">4</span>,</span>
<span id="cb47-287"><a href="#cb47-287" aria-hidden="true" tabindex="-1"></a>  <span class="at">fctr.load.tlrn =</span> <span class="fl">0.1</span>, </span>
<span id="cb47-288"><a href="#cb47-288" aria-hidden="true" tabindex="-1"></a>  <span class="at">sort =</span> <span class="cn">TRUE</span>, </span>
<span id="cb47-289"><a href="#cb47-289" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Exploratory Factor Analysis Results"</span>,</span>
<span id="cb47-290"><a href="#cb47-290" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.cronb =</span> <span class="cn">TRUE</span>, </span>
<span id="cb47-291"><a href="#cb47-291" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.comm =</span> <span class="cn">TRUE</span>, </span>
<span id="cb47-292"><a href="#cb47-292" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb47-293"><a href="#cb47-293" aria-hidden="true" tabindex="-1"></a>  <span class="at">encoding =</span> <span class="st">"UTF-8"</span></span>
<span id="cb47-294"><a href="#cb47-294" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-295"><a href="#cb47-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-296"><a href="#cb47-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-297"><a href="#cb47-297" aria-hidden="true" tabindex="-1"></a>**因子負荷の要約表（gt）**</span>
<span id="cb47-298"><a href="#cb47-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-301"><a href="#cb47-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-302"><a href="#cb47-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: efa-summary-table</span></span>
<span id="cb47-303"><a href="#cb47-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-304"><a href="#cb47-304" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and tidy factor loadings</span></span>
<span id="cb47-305"><a href="#cb47-305" aria-hidden="true" tabindex="-1"></a>load_tbl <span class="ot">&lt;-</span> fit_efa<span class="sc">$</span>loadings <span class="sc">|&gt;</span></span>
<span id="cb47-306"><a href="#cb47-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unclass</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-307"><a href="#cb47-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-308"><a href="#cb47-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Item"</span>)</span>
<span id="cb47-309"><a href="#cb47-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-310"><a href="#cb47-310" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary with max loading per item, communality, and uniqueness</span></span>
<span id="cb47-311"><a href="#cb47-311" aria-hidden="true" tabindex="-1"></a>efa_summary <span class="ot">&lt;-</span> load_tbl <span class="sc">|&gt;</span></span>
<span id="cb47-312"><a href="#cb47-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Item, <span class="at">names_to =</span> <span class="st">"Factor"</span>, <span class="at">values_to =</span> <span class="st">"Loading"</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-313"><a href="#cb47-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Item) <span class="sc">|&gt;</span></span>
<span id="cb47-314"><a href="#cb47-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-315"><a href="#cb47-315" aria-hidden="true" tabindex="-1"></a>    <span class="at">Abs =</span> <span class="fu">abs</span>(Loading),</span>
<span id="cb47-316"><a href="#cb47-316" aria-hidden="true" tabindex="-1"></a>    <span class="at">Communality =</span> <span class="fu">sum</span>(Loading<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># Sum of squared loadings across all factors</span></span>
<span id="cb47-317"><a href="#cb47-317" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-318"><a href="#cb47-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> Abs, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-319"><a href="#cb47-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-320"><a href="#cb47-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Uniqueness =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pmin</span>(Communality, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb47-321"><a href="#cb47-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Item, Factor, Loading, Communality, Uniqueness) <span class="sc">|&gt;</span></span>
<span id="cb47-322"><a href="#cb47-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Factor, <span class="fu">desc</span>(<span class="fu">abs</span>(Loading)))</span>
<span id="cb47-323"><a href="#cb47-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-324"><a href="#cb47-324" aria-hidden="true" tabindex="-1"></a><span class="co"># Display in gt table</span></span>
<span id="cb47-325"><a href="#cb47-325" aria-hidden="true" tabindex="-1"></a>efa_summary <span class="sc">|&gt;</span></span>
<span id="cb47-326"><a href="#cb47-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-327"><a href="#cb47-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb47-328"><a href="#cb47-328" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"EFA Summary Table"</span>,</span>
<span id="cb47-329"><a href="#cb47-329" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Maximum Loading, Communality, and Uniqueness per Item"</span></span>
<span id="cb47-330"><a href="#cb47-330" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-331"><a href="#cb47-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb47-332"><a href="#cb47-332" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Loading, Communality, Uniqueness),</span>
<span id="cb47-333"><a href="#cb47-333" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb47-334"><a href="#cb47-334" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-335"><a href="#cb47-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb47-336"><a href="#cb47-336" aria-hidden="true" tabindex="-1"></a>    <span class="at">Item =</span> <span class="st">"Item"</span>,</span>
<span id="cb47-337"><a href="#cb47-337" aria-hidden="true" tabindex="-1"></a>    <span class="at">Factor =</span> <span class="st">"Primary Factor"</span>,</span>
<span id="cb47-338"><a href="#cb47-338" aria-hidden="true" tabindex="-1"></a>    <span class="at">Loading =</span> <span class="st">"Max Loading"</span>,</span>
<span id="cb47-339"><a href="#cb47-339" aria-hidden="true" tabindex="-1"></a>    <span class="at">Communality =</span> <span class="st">"h²"</span>,</span>
<span id="cb47-340"><a href="#cb47-340" aria-hidden="true" tabindex="-1"></a>    <span class="at">Uniqueness =</span> <span class="st">"u²"</span></span>
<span id="cb47-341"><a href="#cb47-341" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-342"><a href="#cb47-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(</span>
<span id="cb47-343"><a href="#cb47-343" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Factor Solution"</span>,</span>
<span id="cb47-344"><a href="#cb47-344" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Item, Factor, Loading)</span>
<span id="cb47-345"><a href="#cb47-345" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-346"><a href="#cb47-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(</span>
<span id="cb47-347"><a href="#cb47-347" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Variance Components"</span>,</span>
<span id="cb47-348"><a href="#cb47-348" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Communality, Uniqueness)</span>
<span id="cb47-349"><a href="#cb47-349" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-350"><a href="#cb47-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb47-351"><a href="#cb47-351" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb47-352"><a href="#cb47-352" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="sc">-</span>Item</span>
<span id="cb47-353"><a href="#cb47-353" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-354"><a href="#cb47-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb47-355"><a href="#cb47-355" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(</span>
<span id="cb47-356"><a href="#cb47-356" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#f8f9fa"</span>),</span>
<span id="cb47-357"><a href="#cb47-357" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>)</span>
<span id="cb47-358"><a href="#cb47-358" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb47-359"><a href="#cb47-359" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_spanners</span>()</span>
<span id="cb47-360"><a href="#cb47-360" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-361"><a href="#cb47-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb47-362"><a href="#cb47-362" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"h² = communality (proportion of variance explained by factors)"</span>,</span>
<span id="cb47-363"><a href="#cb47-363" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> Communality)</span>
<span id="cb47-364"><a href="#cb47-364" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-365"><a href="#cb47-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb47-366"><a href="#cb47-366" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"u² = uniqueness (1 - communality)"</span>,</span>
<span id="cb47-367"><a href="#cb47-367" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> Uniqueness)</span>
<span id="cb47-368"><a href="#cb47-368" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-369"><a href="#cb47-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-370"><a href="#cb47-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-371"><a href="#cb47-371" aria-hidden="true" tabindex="-1"></a>上表は各項目が**最も強く負荷する因子**と、その**共通性（因子で説明される割合）**、**独自性**を並べたものです。共通性が低い項目はスケールからの除外や項目修正の候補になります。</span>
<span id="cb47-372"><a href="#cb47-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-373"><a href="#cb47-373" aria-hidden="true" tabindex="-1"></a><span class="fu">### 信頼性（α係数・ω係数）</span></span>
<span id="cb47-374"><a href="#cb47-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-377"><a href="#cb47-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-378"><a href="#cb47-378" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: reliability-analysis</span></span>
<span id="cb47-379"><a href="#cb47-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-380"><a href="#cb47-380" aria-hidden="true" tabindex="-1"></a><span class="co"># Select items loading highest on Factor 1 (example)</span></span>
<span id="cb47-381"><a href="#cb47-381" aria-hidden="true" tabindex="-1"></a>items_f1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"V6"</span>, <span class="st">"V14"</span>, <span class="st">"V1"</span>, <span class="st">"V7"</span>)  <span class="co"># Adjust based on actual data</span></span>
<span id="cb47-382"><a href="#cb47-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-383"><a href="#cb47-383" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate reliability coefficients</span></span>
<span id="cb47-384"><a href="#cb47-384" aria-hidden="true" tabindex="-1"></a>alpha_result <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">alpha</span>(survey[, items_f1])</span>
<span id="cb47-385"><a href="#cb47-385" aria-hidden="true" tabindex="-1"></a>omega_result <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">omega</span>(survey[, items_f1], <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb47-386"><a href="#cb47-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-387"><a href="#cb47-387" aria-hidden="true" tabindex="-1"></a><span class="co"># Create reliability summary table</span></span>
<span id="cb47-388"><a href="#cb47-388" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb47-389"><a href="#cb47-389" aria-hidden="true" tabindex="-1"></a>  <span class="at">Coefficient =</span> <span class="fu">c</span>(<span class="st">"Cronbach's α"</span>, <span class="st">"McDonald's ω"</span>),</span>
<span id="cb47-390"><a href="#cb47-390" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, omega_result<span class="sc">$</span>omega.tot),</span>
<span id="cb47-391"><a href="#cb47-391" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_lower =</span> <span class="fu">c</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>ase <span class="sc">*</span> <span class="sc">-</span><span class="fl">1.96</span> <span class="sc">+</span> alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha,</span>
<span id="cb47-392"><a href="#cb47-392" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>),</span>
<span id="cb47-393"><a href="#cb47-393" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_upper =</span> <span class="fu">c</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>ase <span class="sc">*</span> <span class="fl">1.96</span> <span class="sc">+</span> alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha,</span>
<span id="cb47-394"><a href="#cb47-394" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>)</span>
<span id="cb47-395"><a href="#cb47-395" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb47-396"><a href="#cb47-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-397"><a href="#cb47-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb47-398"><a href="#cb47-398" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Internal Consistency Reliability"</span>,</span>
<span id="cb47-399"><a href="#cb47-399" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Factor 1 items:"</span>, <span class="fu">paste</span>(items_f1, <span class="at">collapse =</span> <span class="st">", "</span>))</span>
<span id="cb47-400"><a href="#cb47-400" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-401"><a href="#cb47-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb47-402"><a href="#cb47-402" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Value, CI_lower, CI_upper),</span>
<span id="cb47-403"><a href="#cb47-403" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb47-404"><a href="#cb47-404" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-405"><a href="#cb47-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_merge</span>(</span>
<span id="cb47-406"><a href="#cb47-406" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(CI_lower, CI_upper),</span>
<span id="cb47-407"><a href="#cb47-407" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">"[{1}, {2}]"</span></span>
<span id="cb47-408"><a href="#cb47-408" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-409"><a href="#cb47-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb47-410"><a href="#cb47-410" aria-hidden="true" tabindex="-1"></a>    <span class="at">Coefficient =</span> <span class="st">"Coefficient"</span>,</span>
<span id="cb47-411"><a href="#cb47-411" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="st">"Estimate"</span>,</span>
<span id="cb47-412"><a href="#cb47-412" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_lower =</span> <span class="st">"95% CI"</span></span>
<span id="cb47-413"><a href="#cb47-413" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-414"><a href="#cb47-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sub_missing</span>(</span>
<span id="cb47-415"><a href="#cb47-415" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> CI_lower,</span>
<span id="cb47-416"><a href="#cb47-416" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing_text =</span> <span class="st">"—"</span></span>
<span id="cb47-417"><a href="#cb47-417" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-418"><a href="#cb47-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb47-419"><a href="#cb47-419" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6ffe6"</span>),</span>
<span id="cb47-420"><a href="#cb47-420" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb47-421"><a href="#cb47-421" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Value,</span>
<span id="cb47-422"><a href="#cb47-422" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Value <span class="sc">&gt;</span> <span class="fl">0.7</span></span>
<span id="cb47-423"><a href="#cb47-423" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-424"><a href="#cb47-424" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-425"><a href="#cb47-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb47-426"><a href="#cb47-426" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Values &gt; 0.7 indicate acceptable reliability"</span>,</span>
<span id="cb47-427"><a href="#cb47-427" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> Value)</span>
<span id="cb47-428"><a href="#cb47-428" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-429"><a href="#cb47-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-430"><a href="#cb47-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-431"><a href="#cb47-431" aria-hidden="true" tabindex="-1"></a><span class="fu">### 可視化</span></span>
<span id="cb47-432"><a href="#cb47-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-435"><a href="#cb47-435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-436"><a href="#cb47-436" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: efa-visualization</span></span>
<span id="cb47-437"><a href="#cb47-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb47-438"><a href="#cb47-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb47-439"><a href="#cb47-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-440"><a href="#cb47-440" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor structure diagram</span></span>
<span id="cb47-441"><a href="#cb47-441" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">fa.diagram</span>(fit_efa)</span>
<span id="cb47-442"><a href="#cb47-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-443"><a href="#cb47-443" aria-hidden="true" tabindex="-1"></a><span class="co"># Create loading bar plot</span></span>
<span id="cb47-444"><a href="#cb47-444" aria-hidden="true" tabindex="-1"></a>loadings_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(<span class="fu">unclass</span>(fit_efa<span class="sc">$</span>loadings))</span>
<span id="cb47-445"><a href="#cb47-445" aria-hidden="true" tabindex="-1"></a>loadings_df<span class="sc">$</span>Item <span class="ot">&lt;-</span> <span class="fu">rownames</span>(loadings_df)</span>
<span id="cb47-446"><a href="#cb47-446" aria-hidden="true" tabindex="-1"></a>loadings_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(loadings_df, <span class="at">cols =</span> <span class="sc">-</span>Item, <span class="at">names_to =</span> <span class="st">"Factor"</span>, <span class="at">values_to =</span> <span class="st">"Loading"</span>)</span>
<span id="cb47-447"><a href="#cb47-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-448"><a href="#cb47-448" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(loadings_long, <span class="fu">aes</span>(<span class="at">x =</span> Item, <span class="at">y =</span> <span class="fu">abs</span>(Loading), <span class="at">fill =</span> Factor)) <span class="sc">+</span></span>
<span id="cb47-449"><a href="#cb47-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb47-450"><a href="#cb47-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb47-451"><a href="#cb47-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-452"><a href="#cb47-452" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Factor Loadings by Item"</span>,</span>
<span id="cb47-453"><a href="#cb47-453" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Item"</span>,</span>
<span id="cb47-454"><a href="#cb47-454" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"|Loading|"</span></span>
<span id="cb47-455"><a href="#cb47-455" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-456"><a href="#cb47-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb47-457"><a href="#cb47-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)</span>
<span id="cb47-458"><a href="#cb47-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-459"><a href="#cb47-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-460"><a href="#cb47-460" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 因子負荷のヒートマップ（tidyverse）</span></span>
<span id="cb47-461"><a href="#cb47-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-464"><a href="#cb47-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-465"><a href="#cb47-465" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: efa-heatmap</span></span>
<span id="cb47-466"><a href="#cb47-466" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb47-467"><a href="#cb47-467" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb47-468"><a href="#cb47-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-469"><a href="#cb47-469" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare heatmap data</span></span>
<span id="cb47-470"><a href="#cb47-470" aria-hidden="true" tabindex="-1"></a>heat_tbl <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">unclass</span>(fit_efa<span class="sc">$</span>loadings)) <span class="sc">|&gt;</span></span>
<span id="cb47-471"><a href="#cb47-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Item"</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-472"><a href="#cb47-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Item, <span class="at">names_to =</span> <span class="st">"Factor"</span>, <span class="at">values_to =</span> <span class="st">"Loading"</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-473"><a href="#cb47-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Abs =</span> <span class="fu">abs</span>(Loading))</span>
<span id="cb47-474"><a href="#cb47-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-475"><a href="#cb47-475" aria-hidden="true" tabindex="-1"></a><span class="co"># Create heatmap</span></span>
<span id="cb47-476"><a href="#cb47-476" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heat_tbl, <span class="fu">aes</span>(Factor, Item, <span class="at">fill =</span> Loading)) <span class="sc">+</span></span>
<span id="cb47-477"><a href="#cb47-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb47-478"><a href="#cb47-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb47-479"><a href="#cb47-479" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">"blue"</span>,</span>
<span id="cb47-480"><a href="#cb47-480" aria-hidden="true" tabindex="-1"></a>    <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb47-481"><a href="#cb47-481" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb47-482"><a href="#cb47-482" aria-hidden="true" tabindex="-1"></a>    <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb47-483"><a href="#cb47-483" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Loading"</span></span>
<span id="cb47-484"><a href="#cb47-484" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-485"><a href="#cb47-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-486"><a href="#cb47-486" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"EFA Loadings Heatmap"</span>,</span>
<span id="cb47-487"><a href="#cb47-487" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Red = positive loading, Blue = negative loading"</span></span>
<span id="cb47-488"><a href="#cb47-488" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-489"><a href="#cb47-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb47-490"><a href="#cb47-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb47-491"><a href="#cb47-491" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb47-492"><a href="#cb47-492" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb47-493"><a href="#cb47-493" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-494"><a href="#cb47-494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-495"><a href="#cb47-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-496"><a href="#cb47-496" aria-hidden="true" tabindex="-1"></a><span class="fu"># 確認的因子分析（CFA）</span></span>
<span id="cb47-497"><a href="#cb47-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-498"><a href="#cb47-498" aria-hidden="true" tabindex="-1"></a><span class="fu">## lavaan の記法とデータ</span></span>
<span id="cb47-499"><a href="#cb47-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-500"><a href="#cb47-500" aria-hidden="true" tabindex="-1"></a><span class="in">`=~`</span> は「〜により測定」を表し、<span class="in">`~~`</span> は（共）分散、<span class="in">`~`</span> は回帰、<span class="in">`~1`</span> は切片を表します。</span>
<span id="cb47-501"><a href="#cb47-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-504"><a href="#cb47-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-505"><a href="#cb47-505" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cfa-data</span></span>
<span id="cb47-506"><a href="#cb47-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-507"><a href="#cb47-507" aria-hidden="true" tabindex="-1"></a><span class="co"># Load example data from lavaan</span></span>
<span id="cb47-508"><a href="#cb47-508" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(HolzingerSwineford1939)</span>
<span id="cb47-509"><a href="#cb47-509" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumed: x1-x3 = visual, x4-x6 = textual, x7-x9 = speed</span></span>
<span id="cb47-510"><a href="#cb47-510" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-511"><a href="#cb47-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-512"><a href="#cb47-512" aria-hidden="true" tabindex="-1"></a><span class="fu">## モデル定義と推定</span></span>
<span id="cb47-513"><a href="#cb47-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-516"><a href="#cb47-516" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-517"><a href="#cb47-517" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cfa-models</span></span>
<span id="cb47-518"><a href="#cb47-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-519"><a href="#cb47-519" aria-hidden="true" tabindex="-1"></a><span class="co"># Define CFA models</span></span>
<span id="cb47-520"><a href="#cb47-520" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb47-521"><a href="#cb47-521" aria-hidden="true" tabindex="-1"></a><span class="st">  visual  =~ x1 + x2 + x3</span></span>
<span id="cb47-522"><a href="#cb47-522" aria-hidden="true" tabindex="-1"></a><span class="st">  textual =~ x4 + x5 + x6</span></span>
<span id="cb47-523"><a href="#cb47-523" aria-hidden="true" tabindex="-1"></a><span class="st">  speed   =~ x7 + x8 + x9</span></span>
<span id="cb47-524"><a href="#cb47-524" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb47-525"><a href="#cb47-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-526"><a href="#cb47-526" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb47-527"><a href="#cb47-527" aria-hidden="true" tabindex="-1"></a><span class="st">  visual  =~ x1 + x2</span></span>
<span id="cb47-528"><a href="#cb47-528" aria-hidden="true" tabindex="-1"></a><span class="st">  textual =~ x4 + x5</span></span>
<span id="cb47-529"><a href="#cb47-529" aria-hidden="true" tabindex="-1"></a><span class="st">  speed   =~ x7 + x8</span></span>
<span id="cb47-530"><a href="#cb47-530" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb47-531"><a href="#cb47-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-532"><a href="#cb47-532" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models</span></span>
<span id="cb47-533"><a href="#cb47-533" aria-hidden="true" tabindex="-1"></a>fit_cfa_1 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model_1, <span class="at">data =</span> HolzingerSwineford1939, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-534"><a href="#cb47-534" aria-hidden="true" tabindex="-1"></a>fit_cfa_2 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model_2, <span class="at">data =</span> HolzingerSwineford1939, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-535"><a href="#cb47-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-536"><a href="#cb47-536" aria-hidden="true" tabindex="-1"></a><span class="co"># Display summary</span></span>
<span id="cb47-537"><a href="#cb47-537" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_cfa_1, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-538"><a href="#cb47-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-539"><a href="#cb47-539" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and display fit indices</span></span>
<span id="cb47-540"><a href="#cb47-540" aria-hidden="true" tabindex="-1"></a>fit_indices_1 <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(fit_cfa_1, <span class="fu">c</span>(<span class="st">"chisq"</span>,<span class="st">"df"</span>,<span class="st">"pvalue"</span>,<span class="st">"cfi"</span>,<span class="st">"tli"</span>,<span class="st">"rmsea"</span>,<span class="st">"srmr"</span>))</span>
<span id="cb47-541"><a href="#cb47-541" aria-hidden="true" tabindex="-1"></a>fit_indices_2 <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(fit_cfa_2, <span class="fu">c</span>(<span class="st">"chisq"</span>,<span class="st">"df"</span>,<span class="st">"pvalue"</span>,<span class="st">"cfi"</span>,<span class="st">"tli"</span>,<span class="st">"rmsea"</span>,<span class="st">"srmr"</span>))</span>
<span id="cb47-542"><a href="#cb47-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-543"><a href="#cb47-543" aria-hidden="true" tabindex="-1"></a><span class="co"># Create fit indices comparison table</span></span>
<span id="cb47-544"><a href="#cb47-544" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb47-545"><a href="#cb47-545" aria-hidden="true" tabindex="-1"></a>  <span class="at">Measure =</span> <span class="fu">names</span>(fit_indices_1),</span>
<span id="cb47-546"><a href="#cb47-546" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model_1 =</span> <span class="fu">as.numeric</span>(fit_indices_1),</span>
<span id="cb47-547"><a href="#cb47-547" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model_2 =</span> <span class="fu">as.numeric</span>(fit_indices_2)</span>
<span id="cb47-548"><a href="#cb47-548" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb47-549"><a href="#cb47-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-550"><a href="#cb47-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb47-551"><a href="#cb47-551" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"CFA Model Fit Comparison"</span>,</span>
<span id="cb47-552"><a href="#cb47-552" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Model 1 (3 indicators per factor) vs Model 2 (2 indicators per factor)"</span></span>
<span id="cb47-553"><a href="#cb47-553" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-554"><a href="#cb47-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb47-555"><a href="#cb47-555" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Model_1, Model_2),</span>
<span id="cb47-556"><a href="#cb47-556" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> Measure <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"df"</span>),</span>
<span id="cb47-557"><a href="#cb47-557" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">0</span></span>
<span id="cb47-558"><a href="#cb47-558" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-559"><a href="#cb47-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb47-560"><a href="#cb47-560" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Model_1, Model_2),</span>
<span id="cb47-561"><a href="#cb47-561" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> Measure <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"cfi"</span>, <span class="st">"tli"</span>, <span class="st">"rmsea"</span>, <span class="st">"srmr"</span>),</span>
<span id="cb47-562"><a href="#cb47-562" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb47-563"><a href="#cb47-563" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-564"><a href="#cb47-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_scientific</span>(</span>
<span id="cb47-565"><a href="#cb47-565" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Model_1, Model_2),</span>
<span id="cb47-566"><a href="#cb47-566" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> Measure <span class="sc">==</span> <span class="st">"pvalue"</span>,</span>
<span id="cb47-567"><a href="#cb47-567" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb47-568"><a href="#cb47-568" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-569"><a href="#cb47-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb47-570"><a href="#cb47-570" aria-hidden="true" tabindex="-1"></a>    <span class="at">Measure =</span> <span class="st">"Fit Index"</span>,</span>
<span id="cb47-571"><a href="#cb47-571" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model_1 =</span> <span class="st">"Model 1"</span>,</span>
<span id="cb47-572"><a href="#cb47-572" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model_2 =</span> <span class="st">"Model 2"</span></span>
<span id="cb47-573"><a href="#cb47-573" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-574"><a href="#cb47-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb47-575"><a href="#cb47-575" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6ffe6"</span>),</span>
<span id="cb47-576"><a href="#cb47-576" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb47-577"><a href="#cb47-577" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Model_1,</span>
<span id="cb47-578"><a href="#cb47-578" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> (Measure <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"cfi"</span>, <span class="st">"tli"</span>) <span class="sc">&amp;</span> Model_1 <span class="sc">&gt;</span> <span class="fl">0.95</span>) <span class="sc">|</span></span>
<span id="cb47-579"><a href="#cb47-579" aria-hidden="true" tabindex="-1"></a>             (Measure <span class="sc">==</span> <span class="st">"rmsea"</span> <span class="sc">&amp;</span> Model_1 <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">|</span></span>
<span id="cb47-580"><a href="#cb47-580" aria-hidden="true" tabindex="-1"></a>             (Measure <span class="sc">==</span> <span class="st">"srmr"</span> <span class="sc">&amp;</span> Model_1 <span class="sc">&lt;</span> <span class="fl">0.08</span>)</span>
<span id="cb47-581"><a href="#cb47-581" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-582"><a href="#cb47-582" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-583"><a href="#cb47-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb47-584"><a href="#cb47-584" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6ffe6"</span>),</span>
<span id="cb47-585"><a href="#cb47-585" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb47-586"><a href="#cb47-586" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Model_2,</span>
<span id="cb47-587"><a href="#cb47-587" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> (Measure <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"cfi"</span>, <span class="st">"tli"</span>) <span class="sc">&amp;</span> Model_2 <span class="sc">&gt;</span> <span class="fl">0.95</span>) <span class="sc">|</span></span>
<span id="cb47-588"><a href="#cb47-588" aria-hidden="true" tabindex="-1"></a>             (Measure <span class="sc">==</span> <span class="st">"rmsea"</span> <span class="sc">&amp;</span> Model_2 <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">|</span></span>
<span id="cb47-589"><a href="#cb47-589" aria-hidden="true" tabindex="-1"></a>             (Measure <span class="sc">==</span> <span class="st">"srmr"</span> <span class="sc">&amp;</span> Model_2 <span class="sc">&lt;</span> <span class="fl">0.08</span>)</span>
<span id="cb47-590"><a href="#cb47-590" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-591"><a href="#cb47-591" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-592"><a href="#cb47-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb47-593"><a href="#cb47-593" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Good fit: CFI/TLI &gt; 0.95, RMSEA &lt; 0.05, SRMR &lt; 0.08"</span>,</span>
<span id="cb47-594"><a href="#cb47-594" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="fu">c</span>(Model_1, Model_2))</span>
<span id="cb47-595"><a href="#cb47-595" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-596"><a href="#cb47-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-597"><a href="#cb47-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-598"><a href="#cb47-598" aria-hidden="true" tabindex="-1"></a>**モデル適合度の読み方**: CFI/TLI は 0.90 以上（望ましくは 0.95 以上）、RMSEA は 0.08 未満（望ましくは 0.05 未満）、SRMR は 0.08 未満が一つの目安です。適合だけでなく、**理論整合性**・**パラメータの解釈可能性**・**識別性**を合わせて評価します。</span>
<span id="cb47-599"><a href="#cb47-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-600"><a href="#cb47-600" aria-hidden="true" tabindex="-1"></a><span class="fu">### 可視化と含意共分散</span></span>
<span id="cb47-601"><a href="#cb47-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-604"><a href="#cb47-604" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-605"><a href="#cb47-605" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cfa-visualization</span></span>
<span id="cb47-606"><a href="#cb47-606" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb47-607"><a href="#cb47-607" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb47-608"><a href="#cb47-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-609"><a href="#cb47-609" aria-hidden="true" tabindex="-1"></a><span class="co"># Path diagrams</span></span>
<span id="cb47-610"><a href="#cb47-610" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fit_cfa_1, <span class="at">whatLabels =</span> <span class="st">"est"</span>, <span class="at">layout =</span> <span class="st">"tree"</span>, <span class="at">rotation =</span> <span class="dv">2</span>)</span>
<span id="cb47-611"><a href="#cb47-611" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fit_cfa_1, <span class="at">what =</span> <span class="st">"stand"</span>, <span class="at">style =</span> <span class="st">"lisrel"</span>)</span>
<span id="cb47-612"><a href="#cb47-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-613"><a href="#cb47-613" aria-hidden="true" tabindex="-1"></a><span class="co"># Display implied covariance matrix</span></span>
<span id="cb47-614"><a href="#cb47-614" aria-hidden="true" tabindex="-1"></a>implied_cov <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(fit_cfa_1, <span class="at">what =</span> <span class="st">"implied"</span>)<span class="sc">$</span>cov</span>
<span id="cb47-615"><a href="#cb47-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-616"><a href="#cb47-616" aria-hidden="true" tabindex="-1"></a><span class="co"># Show first 6x6 of implied covariance matrix</span></span>
<span id="cb47-617"><a href="#cb47-617" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(implied_cov[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]) <span class="sc">|&gt;</span></span>
<span id="cb47-618"><a href="#cb47-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Variable"</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-619"><a href="#cb47-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-620"><a href="#cb47-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb47-621"><a href="#cb47-621" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Implied Covariance Matrix"</span>,</span>
<span id="cb47-622"><a href="#cb47-622" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"First 6 variables shown"</span></span>
<span id="cb47-623"><a href="#cb47-623" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-624"><a href="#cb47-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb47-625"><a href="#cb47-625" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="sc">-</span>Variable,</span>
<span id="cb47-626"><a href="#cb47-626" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb47-627"><a href="#cb47-627" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-628"><a href="#cb47-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb47-629"><a href="#cb47-629" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#f8f9fa"</span>),</span>
<span id="cb47-630"><a href="#cb47-630" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns =</span> Variable)</span>
<span id="cb47-631"><a href="#cb47-631" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-632"><a href="#cb47-632" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-633"><a href="#cb47-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-634"><a href="#cb47-634" aria-hidden="true" tabindex="-1"></a><span class="fu"># 主成分分析（PCA）</span></span>
<span id="cb47-635"><a href="#cb47-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-636"><a href="#cb47-636" aria-hidden="true" tabindex="-1"></a>PCA は観測変数から**主成分**を抽出し、全分散のうち何割を説明できるか（寄与率）で次元削減を行う手法です。</span>
<span id="cb47-637"><a href="#cb47-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-640"><a href="#cb47-640" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-641"><a href="#cb47-641" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pca-analysis</span></span>
<span id="cb47-642"><a href="#cb47-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-643"><a href="#cb47-643" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb47-644"><a href="#cb47-644" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb47-645"><a href="#cb47-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-646"><a href="#cb47-646" aria-hidden="true" tabindex="-1"></a><span class="co"># Load example data</span></span>
<span id="cb47-647"><a href="#cb47-647" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(decathlon)</span>
<span id="cb47-648"><a href="#cb47-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-649"><a href="#cb47-649" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA with supplementary variables</span></span>
<span id="cb47-650"><a href="#cb47-650" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantitative supplementary: columns 11-12</span></span>
<span id="cb47-651"><a href="#cb47-651" aria-hidden="true" tabindex="-1"></a><span class="co"># Qualitative supplementary: column 13</span></span>
<span id="cb47-652"><a href="#cb47-652" aria-hidden="true" tabindex="-1"></a>res_pca <span class="ot">&lt;-</span> <span class="fu">PCA</span>(decathlon, <span class="at">quanti.sup =</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">quali.sup =</span> <span class="dv">13</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb47-653"><a href="#cb47-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-654"><a href="#cb47-654" aria-hidden="true" tabindex="-1"></a><span class="co"># Display eigenvalues and variance explained</span></span>
<span id="cb47-655"><a href="#cb47-655" aria-hidden="true" tabindex="-1"></a>pca_eig_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(res_pca<span class="sc">$</span>eig)</span>
<span id="cb47-656"><a href="#cb47-656" aria-hidden="true" tabindex="-1"></a>pca_eig_df<span class="sc">$</span>Dimension <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pca_eig_df)</span>
<span id="cb47-657"><a href="#cb47-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-658"><a href="#cb47-658" aria-hidden="true" tabindex="-1"></a>pca_eig_df <span class="sc">|&gt;</span></span>
<span id="cb47-659"><a href="#cb47-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Dimension, <span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb47-660"><a href="#cb47-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-661"><a href="#cb47-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb47-662"><a href="#cb47-662" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PCA Eigenvalues and Variance Explained"</span>,</span>
<span id="cb47-663"><a href="#cb47-663" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Decathlon dataset"</span></span>
<span id="cb47-664"><a href="#cb47-664" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-665"><a href="#cb47-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb47-666"><a href="#cb47-666" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="sc">-</span>Dimension,</span>
<span id="cb47-667"><a href="#cb47-667" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span></span>
<span id="cb47-668"><a href="#cb47-668" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-669"><a href="#cb47-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb47-670"><a href="#cb47-670" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dimension =</span> <span class="st">"Dim"</span>,</span>
<span id="cb47-671"><a href="#cb47-671" aria-hidden="true" tabindex="-1"></a>    <span class="at">eigenvalue =</span> <span class="st">"Eigenvalue"</span>,</span>
<span id="cb47-672"><a href="#cb47-672" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">percentage of variance</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"% Variance"</span>,</span>
<span id="cb47-673"><a href="#cb47-673" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Cumulative %"</span></span>
<span id="cb47-674"><a href="#cb47-674" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-675"><a href="#cb47-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb47-676"><a href="#cb47-676" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6ffe6"</span>),</span>
<span id="cb47-677"><a href="#cb47-677" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb47-678"><a href="#cb47-678" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span>,</span>
<span id="cb47-679"><a href="#cb47-679" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">80</span></span>
<span id="cb47-680"><a href="#cb47-680" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-681"><a href="#cb47-681" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-682"><a href="#cb47-682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb47-683"><a href="#cb47-683" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"First few components typically explain most variance"</span>,</span>
<span id="cb47-684"><a href="#cb47-684" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span>)</span>
<span id="cb47-685"><a href="#cb47-685" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-686"><a href="#cb47-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-687"><a href="#cb47-687" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb47-688"><a href="#cb47-688" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(res_pca, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-689"><a href="#cb47-689" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(res_pca, <span class="at">addlabels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-690"><a href="#cb47-690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-691"><a href="#cb47-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-692"><a href="#cb47-692" aria-hidden="true" tabindex="-1"></a>主成分は**分散を最大化**する直交軸で、因子分析のように誤差項を明示的に分離しません。スケーリング（共分散行列か相関行列か）に注意が必要です。</span>
<span id="cb47-693"><a href="#cb47-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-696"><a href="#cb47-696" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-697"><a href="#cb47-697" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pca-biplot-tidyverse</span></span>
<span id="cb47-698"><a href="#cb47-698" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb47-699"><a href="#cb47-699" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb47-700"><a href="#cb47-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-701"><a href="#cb47-701" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coordinates for tidyverse biplot</span></span>
<span id="cb47-702"><a href="#cb47-702" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_pca<span class="sc">$</span>ind<span class="sc">$</span>coord) <span class="sc">|&gt;</span></span>
<span id="cb47-703"><a href="#cb47-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>())</span>
<span id="cb47-704"><a href="#cb47-704" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_pca<span class="sc">$</span>var<span class="sc">$</span>coord, <span class="at">rownames =</span> <span class="st">"Variable"</span>)</span>
<span id="cb47-705"><a href="#cb47-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-706"><a href="#cb47-706" aria-hidden="true" tabindex="-1"></a><span class="co"># Create biplot with ggplot2</span></span>
<span id="cb47-707"><a href="#cb47-707" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb47-708"><a href="#cb47-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> ind, <span class="fu">aes</span>(Dim<span class="fl">.1</span>, Dim<span class="fl">.2</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb47-709"><a href="#cb47-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb47-710"><a href="#cb47-710" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> var, </span>
<span id="cb47-711"><a href="#cb47-711" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> Dim<span class="fl">.1</span> <span class="sc">*</span> <span class="dv">3</span>, <span class="at">yend =</span> Dim<span class="fl">.2</span> <span class="sc">*</span> <span class="dv">3</span>), </span>
<span id="cb47-712"><a href="#cb47-712" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>)),</span>
<span id="cb47-713"><a href="#cb47-713" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb47-714"><a href="#cb47-714" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb47-715"><a href="#cb47-715" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-716"><a href="#cb47-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb47-717"><a href="#cb47-717" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> var, </span>
<span id="cb47-718"><a href="#cb47-718" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(Dim<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">3.2</span>, Dim<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">3.2</span>, <span class="at">label =</span> Variable), </span>
<span id="cb47-719"><a href="#cb47-719" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"darkred"</span>,</span>
<span id="cb47-720"><a href="#cb47-720" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">3.5</span></span>
<span id="cb47-721"><a href="#cb47-721" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-722"><a href="#cb47-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-723"><a href="#cb47-723" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PCA Biplot (tidyverse)"</span>,</span>
<span id="cb47-724"><a href="#cb47-724" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Individuals and variables in principal component space"</span>,</span>
<span id="cb47-725"><a href="#cb47-725" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"Dim 1 ("</span>, <span class="fu">round</span>(res_pca<span class="sc">$</span>eig[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"%)"</span>),</span>
<span id="cb47-726"><a href="#cb47-726" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Dim 2 ("</span>, <span class="fu">round</span>(res_pca<span class="sc">$</span>eig[<span class="dv">2</span>,<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"%)"</span>)</span>
<span id="cb47-727"><a href="#cb47-727" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-728"><a href="#cb47-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb47-729"><a href="#cb47-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb47-730"><a href="#cb47-730" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb47-731"><a href="#cb47-731" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>)</span>
<span id="cb47-732"><a href="#cb47-732" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-733"><a href="#cb47-733" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-734"><a href="#cb47-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-735"><a href="#cb47-735" aria-hidden="true" tabindex="-1"></a><span class="fu"># コレスポンデンス分析（CA/MCA）</span></span>
<span id="cb47-736"><a href="#cb47-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-737"><a href="#cb47-737" aria-hidden="true" tabindex="-1"></a>カテゴリ × カテゴリのクロス集計表を幾何学的に可視化します。多値カテゴリの個票データには **MCA** を用います。</span>
<span id="cb47-738"><a href="#cb47-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-739"><a href="#cb47-739" aria-hidden="true" tabindex="-1"></a><span class="fu">## CA（対応分析）の例</span></span>
<span id="cb47-740"><a href="#cb47-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-743"><a href="#cb47-743" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-744"><a href="#cb47-744" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ca-analysis</span></span>
<span id="cb47-745"><a href="#cb47-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-746"><a href="#cb47-746" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data for CA</span></span>
<span id="cb47-747"><a href="#cb47-747" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb47-748"><a href="#cb47-748" aria-hidden="true" tabindex="-1"></a>df_ca <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb47-749"><a href="#cb47-749" aria-hidden="true" tabindex="-1"></a>  <span class="at">RowCat =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"TypeA"</span>, <span class="st">"TypeB"</span>, <span class="st">"TypeC"</span>), <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb47-750"><a href="#cb47-750" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>)),</span>
<span id="cb47-751"><a href="#cb47-751" aria-hidden="true" tabindex="-1"></a>  <span class="at">ColCat =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>), <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-752"><a href="#cb47-752" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>))</span>
<span id="cb47-753"><a href="#cb47-753" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-754"><a href="#cb47-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-755"><a href="#cb47-755" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table</span></span>
<span id="cb47-756"><a href="#cb47-756" aria-hidden="true" tabindex="-1"></a>tab_ca <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(<span class="fu">table</span>(df_ca<span class="sc">$</span>RowCat, df_ca<span class="sc">$</span>ColCat))</span>
<span id="cb47-757"><a href="#cb47-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-758"><a href="#cb47-758" aria-hidden="true" tabindex="-1"></a><span class="co"># Display contingency table</span></span>
<span id="cb47-759"><a href="#cb47-759" aria-hidden="true" tabindex="-1"></a>tab_ca <span class="sc">|&gt;</span></span>
<span id="cb47-760"><a href="#cb47-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Row Category"</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-761"><a href="#cb47-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-762"><a href="#cb47-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb47-763"><a href="#cb47-763" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Contingency Table for CA"</span>,</span>
<span id="cb47-764"><a href="#cb47-764" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Row categories vs Column categories"</span></span>
<span id="cb47-765"><a href="#cb47-765" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-766"><a href="#cb47-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb47-767"><a href="#cb47-767" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Row Category</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Category"</span>,</span>
<span id="cb47-768"><a href="#cb47-768" aria-hidden="true" tabindex="-1"></a>    <span class="at">Low =</span> <span class="st">"Low"</span>,</span>
<span id="cb47-769"><a href="#cb47-769" aria-hidden="true" tabindex="-1"></a>    <span class="at">Medium =</span> <span class="st">"Medium"</span>,</span>
<span id="cb47-770"><a href="#cb47-770" aria-hidden="true" tabindex="-1"></a>    <span class="at">High =</span> <span class="st">"High"</span></span>
<span id="cb47-771"><a href="#cb47-771" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-772"><a href="#cb47-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(</span>
<span id="cb47-773"><a href="#cb47-773" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Column Categories"</span>,</span>
<span id="cb47-774"><a href="#cb47-774" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Low, Medium, High)</span>
<span id="cb47-775"><a href="#cb47-775" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-776"><a href="#cb47-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-777"><a href="#cb47-777" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform CA</span></span>
<span id="cb47-778"><a href="#cb47-778" aria-hidden="true" tabindex="-1"></a>res_ca <span class="ot">&lt;-</span> <span class="fu">CA</span>(tab_ca, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb47-779"><a href="#cb47-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-780"><a href="#cb47-780" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb47-781"><a href="#cb47-781" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_ca_biplot</span>(res_ca, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-782"><a href="#cb47-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-783"><a href="#cb47-783" aria-hidden="true" tabindex="-1"></a><span class="co"># Display eigenvalues and contributions</span></span>
<span id="cb47-784"><a href="#cb47-784" aria-hidden="true" tabindex="-1"></a>ca_eig <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_ca<span class="sc">$</span>eig) <span class="sc">|&gt;</span></span>
<span id="cb47-785"><a href="#cb47-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dimension =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb47-786"><a href="#cb47-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Dimension, <span class="fu">everything</span>())</span>
<span id="cb47-787"><a href="#cb47-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-788"><a href="#cb47-788" aria-hidden="true" tabindex="-1"></a>ca_eig <span class="sc">|&gt;</span></span>
<span id="cb47-789"><a href="#cb47-789" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-790"><a href="#cb47-790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb47-791"><a href="#cb47-791" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"CA Eigenvalues and Inertia"</span>,</span>
<span id="cb47-792"><a href="#cb47-792" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Decomposition of total inertia"</span></span>
<span id="cb47-793"><a href="#cb47-793" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-794"><a href="#cb47-794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb47-795"><a href="#cb47-795" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="sc">-</span>Dimension,</span>
<span id="cb47-796"><a href="#cb47-796" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb47-797"><a href="#cb47-797" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-798"><a href="#cb47-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb47-799"><a href="#cb47-799" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dimension =</span> <span class="st">"Dim"</span>,</span>
<span id="cb47-800"><a href="#cb47-800" aria-hidden="true" tabindex="-1"></a>    <span class="at">eigenvalue =</span> <span class="st">"Eigenvalue"</span>,</span>
<span id="cb47-801"><a href="#cb47-801" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">percentage of variance</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"% Inertia"</span>,</span>
<span id="cb47-802"><a href="#cb47-802" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Cumulative %"</span></span>
<span id="cb47-803"><a href="#cb47-803" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-804"><a href="#cb47-804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb47-805"><a href="#cb47-805" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Total inertia = chi-square statistic / n"</span>,</span>
<span id="cb47-806"><a href="#cb47-806" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> eigenvalue)</span>
<span id="cb47-807"><a href="#cb47-807" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-808"><a href="#cb47-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-809"><a href="#cb47-809" aria-hidden="true" tabindex="-1"></a><span class="co"># Row contributions to Dimension 1</span></span>
<span id="cb47-810"><a href="#cb47-810" aria-hidden="true" tabindex="-1"></a>contrib_row <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_ca<span class="sc">$</span>row<span class="sc">$</span>contrib[,<span class="dv">1</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>], <span class="at">rownames =</span> <span class="st">"Category"</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-811"><a href="#cb47-811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Contrib_Dim1 =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-812"><a href="#cb47-812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Contrib_Dim1))</span>
<span id="cb47-813"><a href="#cb47-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-814"><a href="#cb47-814" aria-hidden="true" tabindex="-1"></a>contrib_row <span class="sc">|&gt;</span></span>
<span id="cb47-815"><a href="#cb47-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-816"><a href="#cb47-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb47-817"><a href="#cb47-817" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Row Category Contributions"</span>,</span>
<span id="cb47-818"><a href="#cb47-818" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Contribution to Dimension 1 (%)"</span></span>
<span id="cb47-819"><a href="#cb47-819" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-820"><a href="#cb47-820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb47-821"><a href="#cb47-821" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Contrib_Dim1,</span>
<span id="cb47-822"><a href="#cb47-822" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span></span>
<span id="cb47-823"><a href="#cb47-823" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-824"><a href="#cb47-824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb47-825"><a href="#cb47-825" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Row Category"</span>,</span>
<span id="cb47-826"><a href="#cb47-826" aria-hidden="true" tabindex="-1"></a>    <span class="at">Contrib_Dim1 =</span> <span class="st">"Contribution (%)"</span></span>
<span id="cb47-827"><a href="#cb47-827" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-828"><a href="#cb47-828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb47-829"><a href="#cb47-829" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6f3ff"</span>),</span>
<span id="cb47-830"><a href="#cb47-830" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb47-831"><a href="#cb47-831" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Contrib_Dim1,</span>
<span id="cb47-832"><a href="#cb47-832" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Contrib_Dim1 <span class="sc">&gt;</span> <span class="dv">30</span></span>
<span id="cb47-833"><a href="#cb47-833" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-834"><a href="#cb47-834" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-835"><a href="#cb47-835" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-836"><a href="#cb47-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-837"><a href="#cb47-837" aria-hidden="true" tabindex="-1"></a><span class="fu">## MCA（多重対応分析）の例</span></span>
<span id="cb47-838"><a href="#cb47-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-841"><a href="#cb47-841" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-842"><a href="#cb47-842" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: mca-analysis</span></span>
<span id="cb47-843"><a href="#cb47-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-844"><a href="#cb47-844" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data for MCA</span></span>
<span id="cb47-845"><a href="#cb47-845" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb47-846"><a href="#cb47-846" aria-hidden="true" tabindex="-1"></a>df_mca <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb47-847"><a href="#cb47-847" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q1 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"Maybe"</span>), <span class="dv">150</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb47-848"><a href="#cb47-848" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q2 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>), <span class="dv">150</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb47-849"><a href="#cb47-849" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q3 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>), <span class="dv">150</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb47-850"><a href="#cb47-850" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q4 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Agree"</span>, <span class="st">"Neutral"</span>, <span class="st">"Disagree"</span>), <span class="dv">150</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-851"><a href="#cb47-851" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-852"><a href="#cb47-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-853"><a href="#cb47-853" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform MCA</span></span>
<span id="cb47-854"><a href="#cb47-854" aria-hidden="true" tabindex="-1"></a>res_mca <span class="ot">&lt;-</span> <span class="fu">MCA</span>(df_mca, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb47-855"><a href="#cb47-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-856"><a href="#cb47-856" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizations</span></span>
<span id="cb47-857"><a href="#cb47-857" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_biplot</span>(res_mca, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-858"><a href="#cb47-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-859"><a href="#cb47-859" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual plot colored by Q2</span></span>
<span id="cb47-860"><a href="#cb47-860" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_ind</span>(res_mca,</span>
<span id="cb47-861"><a href="#cb47-861" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.ind =</span> df_mca<span class="sc">$</span>Q2,</span>
<span id="cb47-862"><a href="#cb47-862" aria-hidden="true" tabindex="-1"></a>             <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>),</span>
<span id="cb47-863"><a href="#cb47-863" aria-hidden="true" tabindex="-1"></a>             <span class="at">addEllipses =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-864"><a href="#cb47-864" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">"confidence"</span>,</span>
<span id="cb47-865"><a href="#cb47-865" aria-hidden="true" tabindex="-1"></a>             <span class="at">legend.title =</span> <span class="st">"Q2 Level"</span>,</span>
<span id="cb47-866"><a href="#cb47-866" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-867"><a href="#cb47-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-868"><a href="#cb47-868" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable categories plot</span></span>
<span id="cb47-869"><a href="#cb47-869" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_var</span>(res_mca,</span>
<span id="cb47-870"><a href="#cb47-870" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.var =</span> <span class="st">"contrib"</span>,</span>
<span id="cb47-871"><a href="#cb47-871" aria-hidden="true" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>),</span>
<span id="cb47-872"><a href="#cb47-872" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-873"><a href="#cb47-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-874"><a href="#cb47-874" aria-hidden="true" tabindex="-1"></a><span class="co"># Display eigenvalues</span></span>
<span id="cb47-875"><a href="#cb47-875" aria-hidden="true" tabindex="-1"></a>mca_eig <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_mca<span class="sc">$</span>eig) <span class="sc">|&gt;</span></span>
<span id="cb47-876"><a href="#cb47-876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dimension =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb47-877"><a href="#cb47-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Dimension, <span class="fu">everything</span>())</span>
<span id="cb47-878"><a href="#cb47-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-879"><a href="#cb47-879" aria-hidden="true" tabindex="-1"></a>mca_eig <span class="sc">|&gt;</span></span>
<span id="cb47-880"><a href="#cb47-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">|&gt;</span>  <span class="co"># Show top 5 dimensions</span></span>
<span id="cb47-881"><a href="#cb47-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-882"><a href="#cb47-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb47-883"><a href="#cb47-883" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"MCA Eigenvalues and Inertia"</span>,</span>
<span id="cb47-884"><a href="#cb47-884" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Top 5 dimensions"</span></span>
<span id="cb47-885"><a href="#cb47-885" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-886"><a href="#cb47-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb47-887"><a href="#cb47-887" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="sc">-</span>Dimension,</span>
<span id="cb47-888"><a href="#cb47-888" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb47-889"><a href="#cb47-889" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-890"><a href="#cb47-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb47-891"><a href="#cb47-891" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dimension =</span> <span class="st">"Dim"</span>,</span>
<span id="cb47-892"><a href="#cb47-892" aria-hidden="true" tabindex="-1"></a>    <span class="at">eigenvalue =</span> <span class="st">"Eigenvalue"</span>,</span>
<span id="cb47-893"><a href="#cb47-893" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">percentage of variance</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"% Inertia"</span>,</span>
<span id="cb47-894"><a href="#cb47-894" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Cumulative %"</span></span>
<span id="cb47-895"><a href="#cb47-895" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-896"><a href="#cb47-896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb47-897"><a href="#cb47-897" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#fff3cd"</span>),</span>
<span id="cb47-898"><a href="#cb47-898" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb47-899"><a href="#cb47-899" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span>,</span>
<span id="cb47-900"><a href="#cb47-900" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span></span>
<span id="cb47-901"><a href="#cb47-901" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-902"><a href="#cb47-902" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-903"><a href="#cb47-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb47-904"><a href="#cb47-904" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"MCA typically requires more dimensions than CA"</span>,</span>
<span id="cb47-905"><a href="#cb47-905" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">`</span><span class="at">cumulative percentage of variance</span><span class="st">`</span>)</span>
<span id="cb47-906"><a href="#cb47-906" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-907"><a href="#cb47-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-908"><a href="#cb47-908" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable contributions</span></span>
<span id="cb47-909"><a href="#cb47-909" aria-hidden="true" tabindex="-1"></a>var_contrib <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_mca<span class="sc">$</span>var<span class="sc">$</span>contrib[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">rownames =</span> <span class="st">"Category"</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-910"><a href="#cb47-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Dim1 =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">Dim2 =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-911"><a href="#cb47-911" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Dim1)) <span class="sc">|&gt;</span></span>
<span id="cb47-912"><a href="#cb47-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)  <span class="co"># Top 10 categories</span></span>
<span id="cb47-913"><a href="#cb47-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-914"><a href="#cb47-914" aria-hidden="true" tabindex="-1"></a>var_contrib <span class="sc">|&gt;</span></span>
<span id="cb47-915"><a href="#cb47-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-916"><a href="#cb47-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb47-917"><a href="#cb47-917" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"MCA Variable Category Contributions"</span>,</span>
<span id="cb47-918"><a href="#cb47-918" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Top 10 categories by Dimension 1 contribution"</span></span>
<span id="cb47-919"><a href="#cb47-919" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-920"><a href="#cb47-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb47-921"><a href="#cb47-921" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Dim1, Dim2),</span>
<span id="cb47-922"><a href="#cb47-922" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span></span>
<span id="cb47-923"><a href="#cb47-923" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-924"><a href="#cb47-924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb47-925"><a href="#cb47-925" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Category"</span>,</span>
<span id="cb47-926"><a href="#cb47-926" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dim1 =</span> <span class="st">"Dim 1 (%)"</span>,</span>
<span id="cb47-927"><a href="#cb47-927" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dim2 =</span> <span class="st">"Dim 2 (%)"</span></span>
<span id="cb47-928"><a href="#cb47-928" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-929"><a href="#cb47-929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb47-930"><a href="#cb47-930" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6f3ff"</span>),</span>
<span id="cb47-931"><a href="#cb47-931" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb47-932"><a href="#cb47-932" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Dim1,</span>
<span id="cb47-933"><a href="#cb47-933" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Dim1 <span class="sc">&gt;</span> <span class="dv">10</span></span>
<span id="cb47-934"><a href="#cb47-934" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-935"><a href="#cb47-935" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-936"><a href="#cb47-936" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-937"><a href="#cb47-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-938"><a href="#cb47-938" aria-hidden="true" tabindex="-1"></a><span class="fu">## tidyverseスタイルでの可視化</span></span>
<span id="cb47-939"><a href="#cb47-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-942"><a href="#cb47-942" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-943"><a href="#cb47-943" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ca-mca-tidyverse</span></span>
<span id="cb47-944"><a href="#cb47-944" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb47-945"><a href="#cb47-945" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb47-946"><a href="#cb47-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-947"><a href="#cb47-947" aria-hidden="true" tabindex="-1"></a><span class="co"># CA biplot with tidyverse</span></span>
<span id="cb47-948"><a href="#cb47-948" aria-hidden="true" tabindex="-1"></a>row_coords <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_ca<span class="sc">$</span>row<span class="sc">$</span>coord, <span class="at">rownames =</span> <span class="st">"RowCategory"</span>)</span>
<span id="cb47-949"><a href="#cb47-949" aria-hidden="true" tabindex="-1"></a>col_coords <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_ca<span class="sc">$</span>col<span class="sc">$</span>coord, <span class="at">rownames =</span> <span class="st">"ColCategory"</span>)</span>
<span id="cb47-950"><a href="#cb47-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-951"><a href="#cb47-951" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined plot</span></span>
<span id="cb47-952"><a href="#cb47-952" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb47-953"><a href="#cb47-953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> row_coords, </span>
<span id="cb47-954"><a href="#cb47-954" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>), </span>
<span id="cb47-955"><a href="#cb47-955" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb47-956"><a href="#cb47-956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> row_coords, </span>
<span id="cb47-957"><a href="#cb47-957" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>, <span class="at">label =</span> RowCategory), </span>
<span id="cb47-958"><a href="#cb47-958" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb47-959"><a href="#cb47-959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> col_coords, </span>
<span id="cb47-960"><a href="#cb47-960" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>), </span>
<span id="cb47-961"><a href="#cb47-961" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb47-962"><a href="#cb47-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> col_coords, </span>
<span id="cb47-963"><a href="#cb47-963" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>, <span class="at">label =</span> ColCategory), </span>
<span id="cb47-964"><a href="#cb47-964" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb47-965"><a href="#cb47-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb47-966"><a href="#cb47-966" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb47-967"><a href="#cb47-967" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"CA Biplot (tidyverse style)"</span>,</span>
<span id="cb47-968"><a href="#cb47-968" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Blue triangles: row categories, Red circles: column categories"</span>,</span>
<span id="cb47-969"><a href="#cb47-969" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"Dim 1 ("</span>, <span class="fu">round</span>(res_ca<span class="sc">$</span>eig[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"%)"</span>),</span>
<span id="cb47-970"><a href="#cb47-970" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Dim 2 ("</span>, <span class="fu">round</span>(res_ca<span class="sc">$</span>eig[<span class="dv">2</span>,<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"%)"</span>)) <span class="sc">+</span></span>
<span id="cb47-971"><a href="#cb47-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb47-972"><a href="#cb47-972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb47-973"><a href="#cb47-973" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb47-974"><a href="#cb47-974" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>)</span>
<span id="cb47-975"><a href="#cb47-975" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-976"><a href="#cb47-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-977"><a href="#cb47-977" aria-hidden="true" tabindex="-1"></a><span class="co"># MCA biplot with tidyverse</span></span>
<span id="cb47-978"><a href="#cb47-978" aria-hidden="true" tabindex="-1"></a>ind_coords <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_mca<span class="sc">$</span>ind<span class="sc">$</span>coord[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]) <span class="sc">|&gt;</span></span>
<span id="cb47-979"><a href="#cb47-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Q2 =</span> df_mca<span class="sc">$</span>Q2)</span>
<span id="cb47-980"><a href="#cb47-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-981"><a href="#cb47-981" aria-hidden="true" tabindex="-1"></a>var_coords <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(res_mca<span class="sc">$</span>var<span class="sc">$</span>coord[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">rownames =</span> <span class="st">"Variable"</span>)</span>
<span id="cb47-982"><a href="#cb47-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-983"><a href="#cb47-983" aria-hidden="true" tabindex="-1"></a><span class="co"># MCA biplot</span></span>
<span id="cb47-984"><a href="#cb47-984" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb47-985"><a href="#cb47-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> ind_coords, </span>
<span id="cb47-986"><a href="#cb47-986" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>, <span class="at">color =</span> Q2), </span>
<span id="cb47-987"><a href="#cb47-987" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb47-988"><a href="#cb47-988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> var_coords, </span>
<span id="cb47-989"><a href="#cb47-989" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>), </span>
<span id="cb47-990"><a href="#cb47-990" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb47-991"><a href="#cb47-991" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> var_coords, </span>
<span id="cb47-992"><a href="#cb47-992" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Dim 2</span><span class="st">`</span>, <span class="at">label =</span> Variable), </span>
<span id="cb47-993"><a href="#cb47-993" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb47-994"><a href="#cb47-994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb47-995"><a href="#cb47-995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb47-996"><a href="#cb47-996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MCA Biplot (tidyverse style)"</span>,</span>
<span id="cb47-997"><a href="#cb47-997" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Points: individuals colored by Q2, Squares: variable categories"</span>,</span>
<span id="cb47-998"><a href="#cb47-998" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"Dim 1 ("</span>, <span class="fu">round</span>(res_mca<span class="sc">$</span>eig[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"%)"</span>),</span>
<span id="cb47-999"><a href="#cb47-999" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Dim 2 ("</span>, <span class="fu">round</span>(res_mca<span class="sc">$</span>eig[<span class="dv">2</span>,<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"%)"</span>)) <span class="sc">+</span></span>
<span id="cb47-1000"><a href="#cb47-1000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>)) <span class="sc">+</span></span>
<span id="cb47-1001"><a href="#cb47-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb47-1002"><a href="#cb47-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb47-1003"><a href="#cb47-1003" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb47-1004"><a href="#cb47-1004" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb47-1005"><a href="#cb47-1005" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb47-1006"><a href="#cb47-1006" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-1007"><a href="#cb47-1007" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-1008"><a href="#cb47-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1009"><a href="#cb47-1009" aria-hidden="true" tabindex="-1"></a><span class="fu"># 多次元尺度法（MDS）</span></span>
<span id="cb47-1010"><a href="#cb47-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1011"><a href="#cb47-1011" aria-hidden="true" tabindex="-1"></a>計量（距離そのものを近似）/ 非計量（順位距離を近似）の 2 系統。</span>
<span id="cb47-1012"><a href="#cb47-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1015"><a href="#cb47-1015" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-1016"><a href="#cb47-1016" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: mds-analysis</span></span>
<span id="cb47-1017"><a href="#cb47-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1018"><a href="#cb47-1018" aria-hidden="true" tabindex="-1"></a><span class="co"># Create distance matrix from iris data</span></span>
<span id="cb47-1019"><a href="#cb47-1019" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb47-1020"><a href="#cb47-1020" aria-hidden="true" tabindex="-1"></a>dist_mat <span class="ot">&lt;-</span> <span class="fu">dist</span>(x)</span>
<span id="cb47-1021"><a href="#cb47-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1022"><a href="#cb47-1022" aria-hidden="true" tabindex="-1"></a><span class="co"># Classical MDS</span></span>
<span id="cb47-1023"><a href="#cb47-1023" aria-hidden="true" tabindex="-1"></a>fit_cmd <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(dist_mat, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">eig =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-1024"><a href="#cb47-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1025"><a href="#cb47-1025" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coordinates and create data frame</span></span>
<span id="cb47-1026"><a href="#cb47-1026" aria-hidden="true" tabindex="-1"></a>cmd_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(fit_cmd<span class="sc">$</span>points) <span class="sc">|&gt;</span></span>
<span id="cb47-1027"><a href="#cb47-1027" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"Dim1"</span>,<span class="st">"Dim2"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb47-1028"><a href="#cb47-1028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species =</span> iris<span class="sc">$</span>Species)</span>
<span id="cb47-1029"><a href="#cb47-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1030"><a href="#cb47-1030" aria-hidden="true" tabindex="-1"></a><span class="co"># Display eigenvalues for classical MDS</span></span>
<span id="cb47-1031"><a href="#cb47-1031" aria-hidden="true" tabindex="-1"></a>cmd_eig_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb47-1032"><a href="#cb47-1032" aria-hidden="true" tabindex="-1"></a>  <span class="at">Dimension =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(fit_cmd<span class="sc">$</span>eig),</span>
<span id="cb47-1033"><a href="#cb47-1033" aria-hidden="true" tabindex="-1"></a>  <span class="at">Eigenvalue =</span> fit_cmd<span class="sc">$</span>eig,</span>
<span id="cb47-1034"><a href="#cb47-1034" aria-hidden="true" tabindex="-1"></a>  <span class="at">Proportion =</span> fit_cmd<span class="sc">$</span>eig <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">abs</span>(fit_cmd<span class="sc">$</span>eig[fit_cmd<span class="sc">$</span>eig <span class="sc">&gt;</span> <span class="dv">0</span>])),</span>
<span id="cb47-1035"><a href="#cb47-1035" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cumulative =</span> <span class="fu">cumsum</span>(fit_cmd<span class="sc">$</span>eig <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">abs</span>(fit_cmd<span class="sc">$</span>eig[fit_cmd<span class="sc">$</span>eig <span class="sc">&gt;</span> <span class="dv">0</span>])))</span>
<span id="cb47-1036"><a href="#cb47-1036" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-1037"><a href="#cb47-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1038"><a href="#cb47-1038" aria-hidden="true" tabindex="-1"></a>cmd_eig_df <span class="sc">|&gt;</span></span>
<span id="cb47-1039"><a href="#cb47-1039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-1040"><a href="#cb47-1040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-1041"><a href="#cb47-1041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb47-1042"><a href="#cb47-1042" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Classical MDS Eigenvalues"</span>,</span>
<span id="cb47-1043"><a href="#cb47-1043" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Iris dataset distance decomposition"</span></span>
<span id="cb47-1044"><a href="#cb47-1044" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-1045"><a href="#cb47-1045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb47-1046"><a href="#cb47-1046" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Eigenvalue, Proportion, Cumulative),</span>
<span id="cb47-1047"><a href="#cb47-1047" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb47-1048"><a href="#cb47-1048" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-1049"><a href="#cb47-1049" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb47-1050"><a href="#cb47-1050" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dimension =</span> <span class="st">"Dim"</span>,</span>
<span id="cb47-1051"><a href="#cb47-1051" aria-hidden="true" tabindex="-1"></a>    <span class="at">Eigenvalue =</span> <span class="st">"Eigenvalue"</span>,</span>
<span id="cb47-1052"><a href="#cb47-1052" aria-hidden="true" tabindex="-1"></a>    <span class="at">Proportion =</span> <span class="st">"Proportion"</span>,</span>
<span id="cb47-1053"><a href="#cb47-1053" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cumulative =</span> <span class="st">"Cumulative"</span></span>
<span id="cb47-1054"><a href="#cb47-1054" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-1055"><a href="#cb47-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb47-1056"><a href="#cb47-1056" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6ffe6"</span>),</span>
<span id="cb47-1057"><a href="#cb47-1057" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb47-1058"><a href="#cb47-1058" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Eigenvalue,</span>
<span id="cb47-1059"><a href="#cb47-1059" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Eigenvalue <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb47-1060"><a href="#cb47-1060" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-1061"><a href="#cb47-1061" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-1062"><a href="#cb47-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb47-1063"><a href="#cb47-1063" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Negative eigenvalues indicate non-Euclidean distances"</span>,</span>
<span id="cb47-1064"><a href="#cb47-1064" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb47-1065"><a href="#cb47-1065" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Eigenvalue,</span>
<span id="cb47-1066"><a href="#cb47-1066" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Eigenvalue <span class="sc">&lt;</span> <span class="dv">0</span></span>
<span id="cb47-1067"><a href="#cb47-1067" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-1068"><a href="#cb47-1068" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-1069"><a href="#cb47-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1070"><a href="#cb47-1070" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize classical MDS</span></span>
<span id="cb47-1071"><a href="#cb47-1071" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cmd_df, <span class="fu">aes</span>(Dim1, Dim2, <span class="at">color =</span> Species)) <span class="sc">+</span></span>
<span id="cb47-1072"><a href="#cb47-1072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb47-1073"><a href="#cb47-1073" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-1074"><a href="#cb47-1074" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Classical MDS (cmdscale)"</span>,</span>
<span id="cb47-1075"><a href="#cb47-1075" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"2D representation of 4D iris measurements"</span>,</span>
<span id="cb47-1076"><a href="#cb47-1076" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Dimension 1"</span>,</span>
<span id="cb47-1077"><a href="#cb47-1077" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Dimension 2"</span></span>
<span id="cb47-1078"><a href="#cb47-1078" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-1079"><a href="#cb47-1079" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb47-1080"><a href="#cb47-1080" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb47-1081"><a href="#cb47-1081" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb47-1082"><a href="#cb47-1082" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb47-1083"><a href="#cb47-1083" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>)</span>
<span id="cb47-1084"><a href="#cb47-1084" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-1085"><a href="#cb47-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1086"><a href="#cb47-1086" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-metric MDS</span></span>
<span id="cb47-1087"><a href="#cb47-1087" aria-hidden="true" tabindex="-1"></a>fit_nmds <span class="ot">&lt;-</span> smacof<span class="sc">::</span><span class="fu">mds</span>(dist_mat, <span class="at">type =</span> <span class="st">"ordinal"</span>)</span>
<span id="cb47-1088"><a href="#cb47-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1089"><a href="#cb47-1089" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coordinates</span></span>
<span id="cb47-1090"><a href="#cb47-1090" aria-hidden="true" tabindex="-1"></a>mds_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(fit_nmds<span class="sc">$</span>conf) <span class="sc">|&gt;</span></span>
<span id="cb47-1091"><a href="#cb47-1091" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"Dim1"</span>,<span class="st">"Dim2"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb47-1092"><a href="#cb47-1092" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species =</span> iris<span class="sc">$</span>Species)</span>
<span id="cb47-1093"><a href="#cb47-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1094"><a href="#cb47-1094" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize non-metric MDS</span></span>
<span id="cb47-1095"><a href="#cb47-1095" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mds_df, <span class="fu">aes</span>(Dim1, Dim2, <span class="at">color =</span> Species)) <span class="sc">+</span></span>
<span id="cb47-1096"><a href="#cb47-1096" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb47-1097"><a href="#cb47-1097" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-1098"><a href="#cb47-1098" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Non-metric MDS (smacof)"</span>,</span>
<span id="cb47-1099"><a href="#cb47-1099" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Preserves rank order of distances, Stress ="</span>, <span class="fu">round</span>(fit_nmds<span class="sc">$</span>stress, <span class="dv">3</span>)),</span>
<span id="cb47-1100"><a href="#cb47-1100" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Dimension 1"</span>,</span>
<span id="cb47-1101"><a href="#cb47-1101" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Dimension 2"</span></span>
<span id="cb47-1102"><a href="#cb47-1102" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-1103"><a href="#cb47-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb47-1104"><a href="#cb47-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb47-1105"><a href="#cb47-1105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb47-1106"><a href="#cb47-1106" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb47-1107"><a href="#cb47-1107" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>)</span>
<span id="cb47-1108"><a href="#cb47-1108" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-1109"><a href="#cb47-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1110"><a href="#cb47-1110" aria-hidden="true" tabindex="-1"></a><span class="co"># Display stress and GOF statistics</span></span>
<span id="cb47-1111"><a href="#cb47-1111" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation between original and MDS distances</span></span>
<span id="cb47-1112"><a href="#cb47-1112" aria-hidden="true" tabindex="-1"></a>mds_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(fit_nmds<span class="sc">$</span>conf)</span>
<span id="cb47-1113"><a href="#cb47-1113" aria-hidden="true" tabindex="-1"></a>dist_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">as.vector</span>(dist_mat), <span class="fu">as.vector</span>(mds_dist))</span>
<span id="cb47-1114"><a href="#cb47-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1115"><a href="#cb47-1115" aria-hidden="true" tabindex="-1"></a><span class="co"># Create GOF statistics table</span></span>
<span id="cb47-1116"><a href="#cb47-1116" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb47-1117"><a href="#cb47-1117" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Stress-1"</span>, <span class="st">"Correlation"</span>, <span class="st">"N Objects"</span>, <span class="st">"N Dims"</span>),</span>
<span id="cb47-1118"><a href="#cb47-1118" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb47-1119"><a href="#cb47-1119" aria-hidden="true" tabindex="-1"></a>    fit_nmds<span class="sc">$</span>stress,</span>
<span id="cb47-1120"><a href="#cb47-1120" aria-hidden="true" tabindex="-1"></a>    dist_cor,</span>
<span id="cb47-1121"><a href="#cb47-1121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nrow</span>(fit_nmds<span class="sc">$</span>conf),</span>
<span id="cb47-1122"><a href="#cb47-1122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ncol</span>(fit_nmds<span class="sc">$</span>conf)</span>
<span id="cb47-1123"><a href="#cb47-1123" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-1124"><a href="#cb47-1124" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb47-1125"><a href="#cb47-1125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-1126"><a href="#cb47-1126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb47-1127"><a href="#cb47-1127" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Non-metric MDS Goodness of Fit"</span>,</span>
<span id="cb47-1128"><a href="#cb47-1128" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Stress and fit statistics"</span></span>
<span id="cb47-1129"><a href="#cb47-1129" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-1130"><a href="#cb47-1130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb47-1131"><a href="#cb47-1131" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Value,</span>
<span id="cb47-1132"><a href="#cb47-1132" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> Metric <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Stress-1"</span>, <span class="st">"Correlation"</span>),</span>
<span id="cb47-1133"><a href="#cb47-1133" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb47-1134"><a href="#cb47-1134" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-1135"><a href="#cb47-1135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb47-1136"><a href="#cb47-1136" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Value,</span>
<span id="cb47-1137"><a href="#cb47-1137" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> Metric <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"N Objects"</span>, <span class="st">"N Dims"</span>),</span>
<span id="cb47-1138"><a href="#cb47-1138" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">0</span></span>
<span id="cb47-1139"><a href="#cb47-1139" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-1140"><a href="#cb47-1140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb47-1141"><a href="#cb47-1141" aria-hidden="true" tabindex="-1"></a>    <span class="at">Metric =</span> <span class="st">"Measure"</span>,</span>
<span id="cb47-1142"><a href="#cb47-1142" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="st">"Value"</span></span>
<span id="cb47-1143"><a href="#cb47-1143" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-1144"><a href="#cb47-1144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb47-1145"><a href="#cb47-1145" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6ffe6"</span>),</span>
<span id="cb47-1146"><a href="#cb47-1146" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb47-1147"><a href="#cb47-1147" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Value,</span>
<span id="cb47-1148"><a href="#cb47-1148" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Metric <span class="sc">==</span> <span class="st">"Stress-1"</span> <span class="sc">&amp;</span> Value <span class="sc">&lt;</span> <span class="fl">0.1</span></span>
<span id="cb47-1149"><a href="#cb47-1149" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-1150"><a href="#cb47-1150" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-1151"><a href="#cb47-1151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb47-1152"><a href="#cb47-1152" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#e6f3ff"</span>),</span>
<span id="cb47-1153"><a href="#cb47-1153" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb47-1154"><a href="#cb47-1154" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Value,</span>
<span id="cb47-1155"><a href="#cb47-1155" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Metric <span class="sc">==</span> <span class="st">"Correlation"</span> <span class="sc">&amp;</span> Value <span class="sc">&gt;</span> <span class="fl">0.9</span></span>
<span id="cb47-1156"><a href="#cb47-1156" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-1157"><a href="#cb47-1157" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-1158"><a href="#cb47-1158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb47-1159"><a href="#cb47-1159" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Stress &lt; 0.1 indicates good fit"</span>,</span>
<span id="cb47-1160"><a href="#cb47-1160" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb47-1161"><a href="#cb47-1161" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Value,</span>
<span id="cb47-1162"><a href="#cb47-1162" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Metric <span class="sc">==</span> <span class="st">"Stress-1"</span></span>
<span id="cb47-1163"><a href="#cb47-1163" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-1164"><a href="#cb47-1164" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-1165"><a href="#cb47-1165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb47-1166"><a href="#cb47-1166" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Higher correlation indicates better preservation of distances"</span>,</span>
<span id="cb47-1167"><a href="#cb47-1167" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb47-1168"><a href="#cb47-1168" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Value,</span>
<span id="cb47-1169"><a href="#cb47-1169" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Metric <span class="sc">==</span> <span class="st">"Correlation"</span></span>
<span id="cb47-1170"><a href="#cb47-1170" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-1171"><a href="#cb47-1171" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-1172"><a href="#cb47-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1173"><a href="#cb47-1173" aria-hidden="true" tabindex="-1"></a><span class="co"># Shepard diagram</span></span>
<span id="cb47-1174"><a href="#cb47-1174" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_nmds, <span class="at">plot.type =</span> <span class="st">"Shepard"</span>, <span class="at">main =</span> <span class="st">"Shepard Diagram"</span>)</span>
<span id="cb47-1175"><a href="#cb47-1175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-1176"><a href="#cb47-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1177"><a href="#cb47-1177" aria-hidden="true" tabindex="-1"></a>**実務上のヒント**: 次元削減や潜在変数モデルは「可視化・表の整形」とセットで共有すると意思決定が速くなります。推定→可視化（散布図・ヒートマップ）→要約表（gt）→解釈メモ、の順でノート化しておくと再現性が高まります。また、**前処理（標準化・欠損処理・カテゴリ結合）**の妥当性が結論を大きく左右します。</span>
<span id="cb47-1178"><a href="#cb47-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1179"><a href="#cb47-1179" aria-hidden="true" tabindex="-1"></a><span class="fu"># 参考</span></span>
<span id="cb47-1180"><a href="#cb47-1180" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>カテゴリカルデータの相関（ポリコリック/ポリシリアル/テトラコリック など）</span>
<span id="cb47-1181"><a href="#cb47-1181" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>https://norimune.net/673</span>
<span id="cb47-1182"><a href="#cb47-1182" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Confirmatory Factor Analysis（入門）</span>
<span id="cb47-1183"><a href="#cb47-1183" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>https://bookdown.org/bean_jerry/using_r_for_social_work_research/confirmatory-factor-analysis.html</span>
<span id="cb47-1184"><a href="#cb47-1184" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>PCA 解説と実装（Qiita）</span>
<span id="cb47-1185"><a href="#cb47-1185" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>https://qiita.com/zumax/items/d92342c3da94020eedec</span>
<span id="cb47-1186"><a href="#cb47-1186" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>CA の実装ガイド</span>
<span id="cb47-1187"><a href="#cb47-1187" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/113-ca-correspondence-analysis-in-r-essentials/</span>
<span id="cb47-1188"><a href="#cb47-1188" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Factoshiny（FactoMineR の GUI）</span>
<span id="cb47-1189"><a href="#cb47-1189" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>http://factominer.free.fr/graphs/factoshiny.html</span>
<span id="cb47-1190"><a href="#cb47-1190" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>多次元尺度法の教材</span>
<span id="cb47-1191"><a href="#cb47-1191" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>https://pages.mtu.edu/~shanem/psy5220/daily/Day16/MDS.html#multi-dimensional-scaling</span>
<span id="cb47-1192"><a href="#cb47-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1193"><a href="#cb47-1193" aria-hidden="true" tabindex="-1"></a><span class="fu"># セッション情報</span></span>
<span id="cb47-1194"><a href="#cb47-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1197"><a href="#cb47-1197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-1198"><a href="#cb47-1198" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: session-info</span></span>
<span id="cb47-1199"><a href="#cb47-1199" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb47-1200"><a href="#cb47-1200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="コピー" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>